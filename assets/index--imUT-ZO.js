(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const H_=()=>{};var $h={};const Kf=function(n){const t=[];let e=0;for(let i=0;i<n.length;i++){let s=n.charCodeAt(i);s<128?t[e++]=s:s<2048?(t[e++]=s>>6|192,t[e++]=s&63|128):(s&64512)===55296&&i+1<n.length&&(n.charCodeAt(i+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++i)&1023),t[e++]=s>>18|240,t[e++]=s>>12&63|128,t[e++]=s>>6&63|128,t[e++]=s&63|128):(t[e++]=s>>12|224,t[e++]=s>>6&63|128,t[e++]=s&63|128)}return t},W_=function(n){const t=[];let e=0,i=0;for(;e<n.length;){const s=n[e++];if(s<128)t[i++]=String.fromCharCode(s);else if(s>191&&s<224){const r=n[e++];t[i++]=String.fromCharCode((s&31)<<6|r&63)}else if(s>239&&s<365){const r=n[e++],o=n[e++],a=n[e++],c=((s&7)<<18|(r&63)<<12|(o&63)<<6|a&63)-65536;t[i++]=String.fromCharCode(55296+(c>>10)),t[i++]=String.fromCharCode(56320+(c&1023))}else{const r=n[e++],o=n[e++];t[i++]=String.fromCharCode((s&15)<<12|(r&63)<<6|o&63)}}return t.join("")},Yf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,t){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const e=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let s=0;s<n.length;s+=3){const r=n[s],o=s+1<n.length,a=o?n[s+1]:0,c=s+2<n.length,h=c?n[s+2]:0,u=r>>2,d=(r&3)<<4|a>>4;let g=(a&15)<<2|h>>6,m=h&63;c||(m=64,o||(g=64)),i.push(e[u],e[d],e[g],e[m])}return i.join("")},encodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(n):this.encodeByteArray(Kf(n),t)},decodeString(n,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(n):W_(this.decodeStringToByteArray(n,t))},decodeStringToByteArray(n,t){this.init_();const e=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let s=0;s<n.length;){const r=e[n.charAt(s++)],a=s<n.length?e[n.charAt(s)]:0;++s;const h=s<n.length?e[n.charAt(s)]:64;++s;const d=s<n.length?e[n.charAt(s)]:64;if(++s,r==null||a==null||h==null||d==null)throw new $_;const g=r<<2|a>>4;if(i.push(g),h!==64){const m=a<<4&240|h>>2;if(i.push(m),d!==64){const y=h<<6&192|d;i.push(y)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class $_ extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const q_=function(n){const t=Kf(n);return Yf.encodeByteArray(t,!0)},$r=function(n){return q_(n).replace(/\./g,"")},Xf=function(n){try{return Yf.decodeString(n,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function G_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const K_=()=>G_().__FIREBASE_DEFAULTS__,Y_=()=>{if(typeof process>"u"||typeof $h>"u")return;const n=$h.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},X_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const t=n&&Xf(n[1]);return t&&JSON.parse(t)},vo=()=>{try{return H_()||K_()||Y_()||X_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Qf=n=>vo()?.emulatorHosts?.[n],Q_=n=>{const t=Qf(n);if(!t)return;const e=t.lastIndexOf(":");if(e<=0||e+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const i=parseInt(t.substring(e+1),10);return t[0]==="["?[t.substring(1,e-1),i]:[t.substring(0,e),i]},Jf=()=>vo()?.config,Zf=n=>vo()?.[`_${n}`];class J_{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}wrapCallback(t){return(e,i)=>{e?this.reject(e):this.resolve(i),typeof t=="function"&&(this.promise.catch(()=>{}),t.length===1?t(e):t(e,i))}}}function Di(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function tg(n){return(await fetch(n,{credentials:"include"})).ok}function Z_(n,t){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const e={alg:"none",type:"JWT"},i=t||"demo-project",s=n.iat||0,r=n.sub||n.user_id;if(!r)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o={iss:`https://securetoken.google.com/${i}`,aud:i,iat:s,exp:s+3600,auth_time:s,sub:r,user_id:r,firebase:{sign_in_provider:"custom",identities:{}},...n};return[$r(JSON.stringify(e)),$r(JSON.stringify(o)),""].join(".")}const _s={};function ty(){const n={prod:[],emulator:[]};for(const t of Object.keys(_s))_s[t]?n.emulator.push(t):n.prod.push(t);return n}function ey(n){let t=document.getElementById(n),e=!1;return t||(t=document.createElement("div"),t.setAttribute("id",n),e=!0),{created:e,element:t}}let qh=!1;function eg(n,t){if(typeof window>"u"||typeof document>"u"||!Di(window.location.host)||_s[n]===t||_s[n]||qh)return;_s[n]=t;function e(g){return`__firebase__banner__${g}`}const i="__firebase__banner",r=ty().prod.length>0;function o(){const g=document.getElementById(i);g&&g.remove()}function a(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function c(g,m){g.setAttribute("width","24"),g.setAttribute("id",m),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function h(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{qh=!0,o()},g}function u(g,m){g.setAttribute("id",m),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function d(){const g=ey(i),m=e("text"),y=document.getElementById(m)||document.createElement("span"),v=e("learnmore"),w=document.getElementById(v)||document.createElement("a"),S=e("preprendIcon"),R=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const D=g.element;a(D),u(w,v);const V=h();c(R,S),D.append(R,y,w,V),document.body.appendChild(D)}r?(y.innerText="Preview backend disconnected.",R.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(R.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,y.innerText="Preview backend running in this workspace."),y.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",d):d()}function Ht(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ny(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ht())}function iy(){const n=vo()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sy(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function ry(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function oy(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ay(){const n=Ht();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function cy(){return!iy()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ly(){try{return typeof indexedDB=="object"}catch{return!1}}function hy(){return new Promise((n,t)=>{try{let e=!0;const i="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(i);s.onsuccess=()=>{s.result.close(),e||self.indexedDB.deleteDatabase(i),n(!0)},s.onupgradeneeded=()=>{e=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(e){t(e)}})}const uy="FirebaseError";class Ue extends Error{constructor(t,e,i){super(e),this.code=t,this.customData=i,this.name=uy,Object.setPrototypeOf(this,Ue.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zs.prototype.create)}}class zs{constructor(t,e,i){this.service=t,this.serviceName=e,this.errors=i}create(t,...e){const i=e[0]||{},s=`${this.service}/${t}`,r=this.errors[t],o=r?dy(r,i):"Error",a=`${this.serviceName}: ${o} (${s}).`;return new Ue(s,a,i)}}function dy(n,t){return n.replace(fy,(e,i)=>{const s=t[i];return s!=null?String(s):`<${i}?>`})}const fy=/\{\$([^}]+)}/g;function gy(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}function Ve(n,t){if(n===t)return!0;const e=Object.keys(n),i=Object.keys(t);for(const s of e){if(!i.includes(s))return!1;const r=n[s],o=t[s];if(Gh(r)&&Gh(o)){if(!Ve(r,o))return!1}else if(r!==o)return!1}for(const s of i)if(!e.includes(s))return!1;return!0}function Gh(n){return n!==null&&typeof n=="object"}function js(n){const t=[];for(const[e,i]of Object.entries(n))Array.isArray(i)?i.forEach(s=>{t.push(encodeURIComponent(e)+"="+encodeURIComponent(s))}):t.push(encodeURIComponent(e)+"="+encodeURIComponent(i));return t.length?"&"+t.join("&"):""}function py(n,t){const e=new my(n,t);return e.subscribe.bind(e)}class my{constructor(t,e){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(()=>{t(this)}).catch(i=>{this.error(i)})}next(t){this.forEachObserver(e=>{e.next(t)})}error(t){this.forEachObserver(e=>{e.error(t)}),this.close(t)}complete(){this.forEachObserver(t=>{t.complete()}),this.close()}subscribe(t,e,i){let s;if(t===void 0&&e===void 0&&i===void 0)throw new Error("Missing Observer.");_y(t,["next","error","complete"])?s=t:s={next:t,error:e,complete:i},s.next===void 0&&(s.next=ya),s.error===void 0&&(s.error=ya),s.complete===void 0&&(s.complete=ya);const r=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),r}unsubscribeOne(t){this.observers===void 0||this.observers[t]===void 0||(delete this.observers[t],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(t){if(!this.finalized)for(let e=0;e<this.observers.length;e++)this.sendOne(e,t)}sendOne(t,e){this.task.then(()=>{if(this.observers!==void 0&&this.observers[t]!==void 0)try{e(this.observers[t])}catch(i){typeof console<"u"&&console.error&&console.error(i)}})}close(t){this.finalized||(this.finalized=!0,t!==void 0&&(this.finalError=t),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _y(n,t){if(typeof n!="object"||n===null)return!1;for(const e of t)if(e in n&&typeof n[e]=="function")return!0;return!1}function ya(){}function Mt(n){return n&&n._delegate?n._delegate:n}class Wn{constructor(t,e,i){this.name=t,this.instanceFactory=e,this.type=i,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(t){return this.instantiationMode=t,this}setMultipleInstances(t){return this.multipleInstances=t,this}setServiceProps(t){return this.serviceProps=t,this}setInstanceCreatedCallback(t){return this.onInstanceCreated=t,this}}const Nn="[DEFAULT]";class yy{constructor(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(t){const e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){const i=new J_;if(this.instancesDeferred.set(e,i),this.isInitialized(e)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:e});s&&i.resolve(s)}catch{}}return this.instancesDeferred.get(e).promise}getImmediate(t){const e=this.normalizeInstanceIdentifier(t?.identifier),i=t?.optional??!1;if(this.isInitialized(e)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:e})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(t){if(t.name!==this.name)throw Error(`Mismatching Component ${t.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=t,!!this.shouldAutoInitialize()){if(vy(t))try{this.getOrInitializeService({instanceIdentifier:Nn})}catch{}for(const[e,i]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(e);try{const r=this.getOrInitializeService({instanceIdentifier:s});i.resolve(r)}catch{}}}}clearInstance(t=Nn){this.instancesDeferred.delete(t),this.instancesOptions.delete(t),this.instances.delete(t)}async delete(){const t=Array.from(this.instances.values());await Promise.all([...t.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...t.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return this.component!=null}isInitialized(t=Nn){return this.instances.has(t)}getOptions(t=Nn){return this.instancesOptions.get(t)||{}}initialize(t={}){const{options:e={}}=t,i=this.normalizeInstanceIdentifier(t.instanceIdentifier);if(this.isInitialized(i))throw Error(`${this.name}(${i}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:i,options:e});for(const[r,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(r);i===a&&o.resolve(s)}return s}onInit(t,e){const i=this.normalizeInstanceIdentifier(e),s=this.onInitCallbacks.get(i)??new Set;s.add(t),this.onInitCallbacks.set(i,s);const r=this.instances.get(i);return r&&t(r,i),()=>{s.delete(t)}}invokeOnInitCallbacks(t,e){const i=this.onInitCallbacks.get(e);if(i)for(const s of i)try{s(t,e)}catch{}}getOrInitializeService({instanceIdentifier:t,options:e={}}){let i=this.instances.get(t);if(!i&&this.component&&(i=this.component.instanceFactory(this.container,{instanceIdentifier:by(t),options:e}),this.instances.set(t,i),this.instancesOptions.set(t,e),this.invokeOnInitCallbacks(i,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,i)}catch{}return i||null}normalizeInstanceIdentifier(t=Nn){return this.component?this.component.multipleInstances?t:Nn:t}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function by(n){return n===Nn?void 0:n}function vy(n){return n.instantiationMode==="EAGER"}class wy{constructor(t){this.name=t,this.providers=new Map}addComponent(t){const e=this.getProvider(t.name);if(e.isComponentSet())throw new Error(`Component ${t.name} has already been registered with ${this.name}`);e.setComponent(t)}addOrOverwriteComponent(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)}getProvider(t){if(this.providers.has(t))return this.providers.get(t);const e=new yy(t,this);return this.providers.set(t,e),e}getProviders(){return Array.from(this.providers.values())}}var X;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(X||(X={}));const Ty={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},Ey=X.INFO,Iy={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},Ay=(n,t,...e)=>{if(t<n.logLevel)return;const i=new Date().toISOString(),s=Iy[t];if(s)console[s](`[${i}]  ${n.name}:`,...e);else throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class kc{constructor(t){this.name=t,this._logLevel=Ey,this._logHandler=Ay,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(t){if(!(t in X))throw new TypeError(`Invalid value "${t}" assigned to \`logLevel\``);this._logLevel=t}setLogLevel(t){this._logLevel=typeof t=="string"?Ty[t]:t}get logHandler(){return this._logHandler}set logHandler(t){if(typeof t!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t}get userLogHandler(){return this._userLogHandler}set userLogHandler(t){this._userLogHandler=t}debug(...t){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...t),this._logHandler(this,X.DEBUG,...t)}log(...t){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...t),this._logHandler(this,X.VERBOSE,...t)}info(...t){this._userLogHandler&&this._userLogHandler(this,X.INFO,...t),this._logHandler(this,X.INFO,...t)}warn(...t){this._userLogHandler&&this._userLogHandler(this,X.WARN,...t),this._logHandler(this,X.WARN,...t)}error(...t){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...t),this._logHandler(this,X.ERROR,...t)}}const xy=(n,t)=>t.some(e=>n instanceof e);let Kh,Yh;function Sy(){return Kh||(Kh=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Py(){return Yh||(Yh=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ng=new WeakMap,Ga=new WeakMap,ig=new WeakMap,ba=new WeakMap,Dc=new WeakMap;function Ry(n){const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("success",r),n.removeEventListener("error",o)},r=()=>{e(an(n.result)),s()},o=()=>{i(n.error),s()};n.addEventListener("success",r),n.addEventListener("error",o)});return t.then(e=>{e instanceof IDBCursor&&ng.set(e,n)}).catch(()=>{}),Dc.set(t,n),t}function Cy(n){if(Ga.has(n))return;const t=new Promise((e,i)=>{const s=()=>{n.removeEventListener("complete",r),n.removeEventListener("error",o),n.removeEventListener("abort",o)},r=()=>{e(),s()},o=()=>{i(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",r),n.addEventListener("error",o),n.addEventListener("abort",o)});Ga.set(n,t)}let Ka={get(n,t,e){if(n instanceof IDBTransaction){if(t==="done")return Ga.get(n);if(t==="objectStoreNames")return n.objectStoreNames||ig.get(n);if(t==="store")return e.objectStoreNames[1]?void 0:e.objectStore(e.objectStoreNames[0])}return an(n[t])},set(n,t,e){return n[t]=e,!0},has(n,t){return n instanceof IDBTransaction&&(t==="done"||t==="store")?!0:t in n}};function ky(n){Ka=n(Ka)}function Dy(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(t,...e){const i=n.call(va(this),t,...e);return ig.set(i,t.sort?t.sort():[t]),an(i)}:Py().includes(n)?function(...t){return n.apply(va(this),t),an(ng.get(this))}:function(...t){return an(n.apply(va(this),t))}}function My(n){return typeof n=="function"?Dy(n):(n instanceof IDBTransaction&&Cy(n),xy(n,Sy())?new Proxy(n,Ka):n)}function an(n){if(n instanceof IDBRequest)return Ry(n);if(ba.has(n))return ba.get(n);const t=My(n);return t!==n&&(ba.set(n,t),Dc.set(t,n)),t}const va=n=>Dc.get(n);function Oy(n,t,{blocked:e,upgrade:i,blocking:s,terminated:r}={}){const o=indexedDB.open(n,t),a=an(o);return i&&o.addEventListener("upgradeneeded",c=>{i(an(o.result),c.oldVersion,c.newVersion,an(o.transaction),c)}),e&&o.addEventListener("blocked",c=>e(c.oldVersion,c.newVersion,c)),a.then(c=>{r&&c.addEventListener("close",()=>r()),s&&c.addEventListener("versionchange",h=>s(h.oldVersion,h.newVersion,h))}).catch(()=>{}),a}const Vy=["get","getKey","getAll","getAllKeys","count"],Ny=["put","add","delete","clear"],wa=new Map;function Xh(n,t){if(!(n instanceof IDBDatabase&&!(t in n)&&typeof t=="string"))return;if(wa.get(t))return wa.get(t);const e=t.replace(/FromIndex$/,""),i=t!==e,s=Ny.includes(e);if(!(e in(i?IDBIndex:IDBObjectStore).prototype)||!(s||Vy.includes(e)))return;const r=async function(o,...a){const c=this.transaction(o,s?"readwrite":"readonly");let h=c.store;return i&&(h=h.index(a.shift())),(await Promise.all([h[e](...a),s&&c.done]))[0]};return wa.set(t,r),r}ky(n=>({...n,get:(t,e,i)=>Xh(t,e)||n.get(t,e,i),has:(t,e)=>!!Xh(t,e)||n.has(t,e)}));class Ly{constructor(t){this.container=t}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(Fy(e)){const i=e.getImmediate();return`${i.library}/${i.version}`}else return null}).filter(e=>e).join(" ")}}function Fy(n){return n.getComponent()?.type==="VERSION"}const Ya="@firebase/app",Qh="0.14.6";const Ne=new kc("@firebase/app"),By="@firebase/app-compat",Uy="@firebase/analytics-compat",zy="@firebase/analytics",jy="@firebase/app-check-compat",Hy="@firebase/app-check",Wy="@firebase/auth",$y="@firebase/auth-compat",qy="@firebase/database",Gy="@firebase/data-connect",Ky="@firebase/database-compat",Yy="@firebase/functions",Xy="@firebase/functions-compat",Qy="@firebase/installations",Jy="@firebase/installations-compat",Zy="@firebase/messaging",tb="@firebase/messaging-compat",eb="@firebase/performance",nb="@firebase/performance-compat",ib="@firebase/remote-config",sb="@firebase/remote-config-compat",rb="@firebase/storage",ob="@firebase/storage-compat",ab="@firebase/firestore",cb="@firebase/ai",lb="@firebase/firestore-compat",hb="firebase",ub="12.6.0";const Xa="[DEFAULT]",db={[Ya]:"fire-core",[By]:"fire-core-compat",[zy]:"fire-analytics",[Uy]:"fire-analytics-compat",[Hy]:"fire-app-check",[jy]:"fire-app-check-compat",[Wy]:"fire-auth",[$y]:"fire-auth-compat",[qy]:"fire-rtdb",[Gy]:"fire-data-connect",[Ky]:"fire-rtdb-compat",[Yy]:"fire-fn",[Xy]:"fire-fn-compat",[Qy]:"fire-iid",[Jy]:"fire-iid-compat",[Zy]:"fire-fcm",[tb]:"fire-fcm-compat",[eb]:"fire-perf",[nb]:"fire-perf-compat",[ib]:"fire-rc",[sb]:"fire-rc-compat",[rb]:"fire-gcs",[ob]:"fire-gcs-compat",[ab]:"fire-fst",[lb]:"fire-fst-compat",[cb]:"fire-vertex","fire-js":"fire-js",[hb]:"fire-js-all"};const qr=new Map,fb=new Map,Qa=new Map;function Jh(n,t){try{n.container.addComponent(t)}catch(e){Ne.debug(`Component ${t.name} failed to register with FirebaseApp ${n.name}`,e)}}function bi(n){const t=n.name;if(Qa.has(t))return Ne.debug(`There were multiple attempts to register component ${t}.`),!1;Qa.set(t,n);for(const e of qr.values())Jh(e,n);for(const e of fb.values())Jh(e,n);return!0}function Mc(n,t){const e=n.container.getProvider("heartbeat").getImmediate({optional:!0});return e&&e.triggerHeartbeat(),n.container.getProvider(t)}function se(n){return n==null?!1:n.settings!==void 0}const gb={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},cn=new zs("app","Firebase",gb);class pb{constructor(t,e,i){this._isDeleted=!1,this._options={...t},this._config={...e},this._name=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled,this._container=i,this.container.addComponent(new Wn("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(t){this.checkDestroyed(),this._automaticDataCollectionEnabled=t}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(t){this._isDeleted=t}checkDestroyed(){if(this.isDeleted)throw cn.create("app-deleted",{appName:this._name})}}const Mi=ub;function Oc(n,t={}){let e=n;typeof t!="object"&&(t={name:t});const i={name:Xa,automaticDataCollectionEnabled:!0,...t},s=i.name;if(typeof s!="string"||!s)throw cn.create("bad-app-name",{appName:String(s)});if(e||(e=Jf()),!e)throw cn.create("no-options");const r=qr.get(s);if(r){if(Ve(e,r.options)&&Ve(i,r.config))return r;throw cn.create("duplicate-app",{appName:s})}const o=new wy(s);for(const c of Qa.values())o.addComponent(c);const a=new pb(e,i,o);return qr.set(s,a),a}function sg(n=Xa){const t=qr.get(n);if(!t&&n===Xa&&Jf())return Oc();if(!t)throw cn.create("no-app",{appName:n});return t}function ln(n,t,e){let i=db[n]??n;e&&(i+=`-${e}`);const s=i.match(/\s|\//),r=t.match(/\s|\//);if(s||r){const o=[`Unable to register library "${i}" with version "${t}":`];s&&o.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&r&&o.push("and"),r&&o.push(`version name "${t}" contains illegal characters (whitespace or "/")`),Ne.warn(o.join(" "));return}bi(new Wn(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}const mb="firebase-heartbeat-database",_b=1,Ss="firebase-heartbeat-store";let Ta=null;function rg(){return Ta||(Ta=Oy(mb,_b,{upgrade:(n,t)=>{switch(t){case 0:try{n.createObjectStore(Ss)}catch(e){console.warn(e)}}}}).catch(n=>{throw cn.create("idb-open",{originalErrorMessage:n.message})})),Ta}async function yb(n){try{const e=(await rg()).transaction(Ss),i=await e.objectStore(Ss).get(og(n));return await e.done,i}catch(t){if(t instanceof Ue)Ne.warn(t.message);else{const e=cn.create("idb-get",{originalErrorMessage:t?.message});Ne.warn(e.message)}}}async function Zh(n,t){try{const i=(await rg()).transaction(Ss,"readwrite");await i.objectStore(Ss).put(t,og(n)),await i.done}catch(e){if(e instanceof Ue)Ne.warn(e.message);else{const i=cn.create("idb-set",{originalErrorMessage:e?.message});Ne.warn(i.message)}}}function og(n){return`${n.name}!${n.options.appId}`}const bb=1024,vb=30;class wb{constructor(t){this.container=t,this._heartbeatsCache=null;const e=this.container.getProvider("app").getImmediate();this._storage=new Eb(e),this._heartbeatsCachePromise=this._storage.read().then(i=>(this._heartbeatsCache=i,i))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=tu();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(s=>s.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:e}),this._heartbeatsCache.heartbeats.length>vb){const s=Ib(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(t){Ne.warn(t)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=tu(),{heartbeatsToSend:e,unsentEntries:i}=Tb(this._heartbeatsCache.heartbeats),s=$r(JSON.stringify({version:2,heartbeats:e}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ne.warn(t),""}}}function tu(){return new Date().toISOString().substring(0,10)}function Tb(n,t=bb){const e=[];let i=n.slice();for(const s of n){const r=e.find(o=>o.agent===s.agent);if(r){if(r.dates.push(s.date),eu(e)>t){r.dates.pop();break}}else if(e.push({agent:s.agent,dates:[s.date]}),eu(e)>t){e.pop();break}i=i.slice(1)}return{heartbeatsToSend:e,unsentEntries:i}}class Eb{constructor(t){this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ly()?hy().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const e=await yb(this.app);return e?.heartbeats?e:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Zh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:t.heartbeats})}else return}async add(t){if(await this._canUseIndexedDBPromise){const i=await this.read();return Zh(this.app,{lastSentHeartbeatDate:t.lastSentHeartbeatDate??i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...t.heartbeats]})}else return}}function eu(n){return $r(JSON.stringify({version:2,heartbeats:n})).length}function Ib(n){if(n.length===0)return-1;let t=0,e=n[0].date;for(let i=1;i<n.length;i++)n[i].date<e&&(e=n[i].date,t=i);return t}function Ab(n){bi(new Wn("platform-logger",t=>new Ly(t),"PRIVATE")),bi(new Wn("heartbeat",t=>new wb(t),"PRIVATE")),ln(Ya,Qh,n),ln(Ya,Qh,"esm2020"),ln("fire-js","")}Ab("");var xb="firebase",Sb="12.6.0";ln(xb,Sb,"app");var nu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var hn,ag;(function(){var n;function t(E,b){function T(){}T.prototype=b.prototype,E.F=b.prototype,E.prototype=new T,E.prototype.constructor=E,E.D=function(x,A,P){for(var I=Array(arguments.length-2),st=2;st<arguments.length;st++)I[st-2]=arguments[st];return b.prototype[A].apply(x,I)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}t(i,e),i.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,b,T){T||(T=0);const x=Array(16);if(typeof b=="string")for(var A=0;A<16;++A)x[A]=b.charCodeAt(T++)|b.charCodeAt(T++)<<8|b.charCodeAt(T++)<<16|b.charCodeAt(T++)<<24;else for(A=0;A<16;++A)x[A]=b[T++]|b[T++]<<8|b[T++]<<16|b[T++]<<24;b=E.g[0],T=E.g[1],A=E.g[2];let P=E.g[3],I;I=b+(P^T&(A^P))+x[0]+3614090360&4294967295,b=T+(I<<7&4294967295|I>>>25),I=P+(A^b&(T^A))+x[1]+3905402710&4294967295,P=b+(I<<12&4294967295|I>>>20),I=A+(T^P&(b^T))+x[2]+606105819&4294967295,A=P+(I<<17&4294967295|I>>>15),I=T+(b^A&(P^b))+x[3]+3250441966&4294967295,T=A+(I<<22&4294967295|I>>>10),I=b+(P^T&(A^P))+x[4]+4118548399&4294967295,b=T+(I<<7&4294967295|I>>>25),I=P+(A^b&(T^A))+x[5]+1200080426&4294967295,P=b+(I<<12&4294967295|I>>>20),I=A+(T^P&(b^T))+x[6]+2821735955&4294967295,A=P+(I<<17&4294967295|I>>>15),I=T+(b^A&(P^b))+x[7]+4249261313&4294967295,T=A+(I<<22&4294967295|I>>>10),I=b+(P^T&(A^P))+x[8]+1770035416&4294967295,b=T+(I<<7&4294967295|I>>>25),I=P+(A^b&(T^A))+x[9]+2336552879&4294967295,P=b+(I<<12&4294967295|I>>>20),I=A+(T^P&(b^T))+x[10]+4294925233&4294967295,A=P+(I<<17&4294967295|I>>>15),I=T+(b^A&(P^b))+x[11]+2304563134&4294967295,T=A+(I<<22&4294967295|I>>>10),I=b+(P^T&(A^P))+x[12]+1804603682&4294967295,b=T+(I<<7&4294967295|I>>>25),I=P+(A^b&(T^A))+x[13]+4254626195&4294967295,P=b+(I<<12&4294967295|I>>>20),I=A+(T^P&(b^T))+x[14]+2792965006&4294967295,A=P+(I<<17&4294967295|I>>>15),I=T+(b^A&(P^b))+x[15]+1236535329&4294967295,T=A+(I<<22&4294967295|I>>>10),I=b+(A^P&(T^A))+x[1]+4129170786&4294967295,b=T+(I<<5&4294967295|I>>>27),I=P+(T^A&(b^T))+x[6]+3225465664&4294967295,P=b+(I<<9&4294967295|I>>>23),I=A+(b^T&(P^b))+x[11]+643717713&4294967295,A=P+(I<<14&4294967295|I>>>18),I=T+(P^b&(A^P))+x[0]+3921069994&4294967295,T=A+(I<<20&4294967295|I>>>12),I=b+(A^P&(T^A))+x[5]+3593408605&4294967295,b=T+(I<<5&4294967295|I>>>27),I=P+(T^A&(b^T))+x[10]+38016083&4294967295,P=b+(I<<9&4294967295|I>>>23),I=A+(b^T&(P^b))+x[15]+3634488961&4294967295,A=P+(I<<14&4294967295|I>>>18),I=T+(P^b&(A^P))+x[4]+3889429448&4294967295,T=A+(I<<20&4294967295|I>>>12),I=b+(A^P&(T^A))+x[9]+568446438&4294967295,b=T+(I<<5&4294967295|I>>>27),I=P+(T^A&(b^T))+x[14]+3275163606&4294967295,P=b+(I<<9&4294967295|I>>>23),I=A+(b^T&(P^b))+x[3]+4107603335&4294967295,A=P+(I<<14&4294967295|I>>>18),I=T+(P^b&(A^P))+x[8]+1163531501&4294967295,T=A+(I<<20&4294967295|I>>>12),I=b+(A^P&(T^A))+x[13]+2850285829&4294967295,b=T+(I<<5&4294967295|I>>>27),I=P+(T^A&(b^T))+x[2]+4243563512&4294967295,P=b+(I<<9&4294967295|I>>>23),I=A+(b^T&(P^b))+x[7]+1735328473&4294967295,A=P+(I<<14&4294967295|I>>>18),I=T+(P^b&(A^P))+x[12]+2368359562&4294967295,T=A+(I<<20&4294967295|I>>>12),I=b+(T^A^P)+x[5]+4294588738&4294967295,b=T+(I<<4&4294967295|I>>>28),I=P+(b^T^A)+x[8]+2272392833&4294967295,P=b+(I<<11&4294967295|I>>>21),I=A+(P^b^T)+x[11]+1839030562&4294967295,A=P+(I<<16&4294967295|I>>>16),I=T+(A^P^b)+x[14]+4259657740&4294967295,T=A+(I<<23&4294967295|I>>>9),I=b+(T^A^P)+x[1]+2763975236&4294967295,b=T+(I<<4&4294967295|I>>>28),I=P+(b^T^A)+x[4]+1272893353&4294967295,P=b+(I<<11&4294967295|I>>>21),I=A+(P^b^T)+x[7]+4139469664&4294967295,A=P+(I<<16&4294967295|I>>>16),I=T+(A^P^b)+x[10]+3200236656&4294967295,T=A+(I<<23&4294967295|I>>>9),I=b+(T^A^P)+x[13]+681279174&4294967295,b=T+(I<<4&4294967295|I>>>28),I=P+(b^T^A)+x[0]+3936430074&4294967295,P=b+(I<<11&4294967295|I>>>21),I=A+(P^b^T)+x[3]+3572445317&4294967295,A=P+(I<<16&4294967295|I>>>16),I=T+(A^P^b)+x[6]+76029189&4294967295,T=A+(I<<23&4294967295|I>>>9),I=b+(T^A^P)+x[9]+3654602809&4294967295,b=T+(I<<4&4294967295|I>>>28),I=P+(b^T^A)+x[12]+3873151461&4294967295,P=b+(I<<11&4294967295|I>>>21),I=A+(P^b^T)+x[15]+530742520&4294967295,A=P+(I<<16&4294967295|I>>>16),I=T+(A^P^b)+x[2]+3299628645&4294967295,T=A+(I<<23&4294967295|I>>>9),I=b+(A^(T|~P))+x[0]+4096336452&4294967295,b=T+(I<<6&4294967295|I>>>26),I=P+(T^(b|~A))+x[7]+1126891415&4294967295,P=b+(I<<10&4294967295|I>>>22),I=A+(b^(P|~T))+x[14]+2878612391&4294967295,A=P+(I<<15&4294967295|I>>>17),I=T+(P^(A|~b))+x[5]+4237533241&4294967295,T=A+(I<<21&4294967295|I>>>11),I=b+(A^(T|~P))+x[12]+1700485571&4294967295,b=T+(I<<6&4294967295|I>>>26),I=P+(T^(b|~A))+x[3]+2399980690&4294967295,P=b+(I<<10&4294967295|I>>>22),I=A+(b^(P|~T))+x[10]+4293915773&4294967295,A=P+(I<<15&4294967295|I>>>17),I=T+(P^(A|~b))+x[1]+2240044497&4294967295,T=A+(I<<21&4294967295|I>>>11),I=b+(A^(T|~P))+x[8]+1873313359&4294967295,b=T+(I<<6&4294967295|I>>>26),I=P+(T^(b|~A))+x[15]+4264355552&4294967295,P=b+(I<<10&4294967295|I>>>22),I=A+(b^(P|~T))+x[6]+2734768916&4294967295,A=P+(I<<15&4294967295|I>>>17),I=T+(P^(A|~b))+x[13]+1309151649&4294967295,T=A+(I<<21&4294967295|I>>>11),I=b+(A^(T|~P))+x[4]+4149444226&4294967295,b=T+(I<<6&4294967295|I>>>26),I=P+(T^(b|~A))+x[11]+3174756917&4294967295,P=b+(I<<10&4294967295|I>>>22),I=A+(b^(P|~T))+x[2]+718787259&4294967295,A=P+(I<<15&4294967295|I>>>17),I=T+(P^(A|~b))+x[9]+3951481745&4294967295,E.g[0]=E.g[0]+b&4294967295,E.g[1]=E.g[1]+(A+(I<<21&4294967295|I>>>11))&4294967295,E.g[2]=E.g[2]+A&4294967295,E.g[3]=E.g[3]+P&4294967295}i.prototype.v=function(E,b){b===void 0&&(b=E.length);const T=b-this.blockSize,x=this.C;let A=this.h,P=0;for(;P<b;){if(A==0)for(;P<=T;)s(this,E,P),P+=this.blockSize;if(typeof E=="string"){for(;P<b;)if(x[A++]=E.charCodeAt(P++),A==this.blockSize){s(this,x),A=0;break}}else for(;P<b;)if(x[A++]=E[P++],A==this.blockSize){s(this,x),A=0;break}}this.h=A,this.o+=b},i.prototype.A=function(){var E=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);E[0]=128;for(var b=1;b<E.length-8;++b)E[b]=0;b=this.o*8;for(var T=E.length-8;T<E.length;++T)E[T]=b&255,b/=256;for(this.v(E),E=Array(16),b=0,T=0;T<4;++T)for(let x=0;x<32;x+=8)E[b++]=this.g[T]>>>x&255;return E};function r(E,b){var T=a;return Object.prototype.hasOwnProperty.call(T,E)?T[E]:T[E]=b(E)}function o(E,b){this.h=b;const T=[];let x=!0;for(let A=E.length-1;A>=0;A--){const P=E[A]|0;x&&P==b||(T[A]=P,x=!1)}this.g=T}var a={};function c(E){return-128<=E&&E<128?r(E,function(b){return new o([b|0],b<0?-1:0)}):new o([E|0],E<0?-1:0)}function h(E){if(isNaN(E)||!isFinite(E))return d;if(E<0)return w(h(-E));const b=[];let T=1;for(let x=0;E>=T;x++)b[x]=E/T|0,T*=4294967296;return new o(b,0)}function u(E,b){if(E.length==0)throw Error("number format error: empty string");if(b=b||10,b<2||36<b)throw Error("radix out of range: "+b);if(E.charAt(0)=="-")return w(u(E.substring(1),b));if(E.indexOf("-")>=0)throw Error('number format error: interior "-" character');const T=h(Math.pow(b,8));let x=d;for(let P=0;P<E.length;P+=8){var A=Math.min(8,E.length-P);const I=parseInt(E.substring(P,P+A),b);A<8?(A=h(Math.pow(b,A)),x=x.j(A).add(h(I))):(x=x.j(T),x=x.add(h(I)))}return x}var d=c(0),g=c(1),m=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();let E=0,b=1;for(let T=0;T<this.g.length;T++){const x=this.i(T);E+=(x>=0?x:4294967296+x)*b,b*=4294967296}return E},n.toString=function(E){if(E=E||10,E<2||36<E)throw Error("radix out of range: "+E);if(y(this))return"0";if(v(this))return"-"+w(this).toString(E);const b=h(Math.pow(E,6));var T=this;let x="";for(;;){const A=V(T,b).g;T=S(T,A.j(b));let P=((T.g.length>0?T.g[0]:T.h)>>>0).toString(E);if(T=A,y(T))return P+x;for(;P.length<6;)P="0"+P;x=P+x}},n.i=function(E){return E<0?0:E<this.g.length?this.g[E]:this.h};function y(E){if(E.h!=0)return!1;for(let b=0;b<E.g.length;b++)if(E.g[b]!=0)return!1;return!0}function v(E){return E.h==-1}n.l=function(E){return E=S(this,E),v(E)?-1:y(E)?0:1};function w(E){const b=E.g.length,T=[];for(let x=0;x<b;x++)T[x]=~E.g[x];return new o(T,~E.h).add(g)}n.abs=function(){return v(this)?w(this):this},n.add=function(E){const b=Math.max(this.g.length,E.g.length),T=[];let x=0;for(let A=0;A<=b;A++){let P=x+(this.i(A)&65535)+(E.i(A)&65535),I=(P>>>16)+(this.i(A)>>>16)+(E.i(A)>>>16);x=I>>>16,P&=65535,I&=65535,T[A]=I<<16|P}return new o(T,T[T.length-1]&-2147483648?-1:0)};function S(E,b){return E.add(w(b))}n.j=function(E){if(y(this)||y(E))return d;if(v(this))return v(E)?w(this).j(w(E)):w(w(this).j(E));if(v(E))return w(this.j(w(E)));if(this.l(m)<0&&E.l(m)<0)return h(this.m()*E.m());const b=this.g.length+E.g.length,T=[];for(var x=0;x<2*b;x++)T[x]=0;for(x=0;x<this.g.length;x++)for(let A=0;A<E.g.length;A++){const P=this.i(x)>>>16,I=this.i(x)&65535,st=E.i(A)>>>16,Y=E.i(A)&65535;T[2*x+2*A]+=I*Y,R(T,2*x+2*A),T[2*x+2*A+1]+=P*Y,R(T,2*x+2*A+1),T[2*x+2*A+1]+=I*st,R(T,2*x+2*A+1),T[2*x+2*A+2]+=P*st,R(T,2*x+2*A+2)}for(E=0;E<b;E++)T[E]=T[2*E+1]<<16|T[2*E];for(E=b;E<2*b;E++)T[E]=0;return new o(T,0)};function R(E,b){for(;(E[b]&65535)!=E[b];)E[b+1]+=E[b]>>>16,E[b]&=65535,b++}function D(E,b){this.g=E,this.h=b}function V(E,b){if(y(b))throw Error("division by zero");if(y(E))return new D(d,d);if(v(E))return b=V(w(E),b),new D(w(b.g),w(b.h));if(v(b))return b=V(E,w(b)),new D(w(b.g),b.h);if(E.g.length>30){if(v(E)||v(b))throw Error("slowDivide_ only works with positive integers.");for(var T=g,x=b;x.l(E)<=0;)T=M(T),x=M(x);var A=L(T,1),P=L(x,1);for(x=L(x,2),T=L(T,2);!y(x);){var I=P.add(x);I.l(E)<=0&&(A=A.add(T),P=I),x=L(x,1),T=L(T,1)}return b=S(E,A.j(b)),new D(A,b)}for(A=d;E.l(b)>=0;){for(T=Math.max(1,Math.floor(E.m()/b.m())),x=Math.ceil(Math.log(T)/Math.LN2),x=x<=48?1:Math.pow(2,x-48),P=h(T),I=P.j(b);v(I)||I.l(E)>0;)T-=x,P=h(T),I=P.j(b);y(P)&&(P=g),A=A.add(P),E=S(E,I)}return new D(A,E)}n.B=function(E){return V(this,E).h},n.and=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)&E.i(x);return new o(T,this.h&E.h)},n.or=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)|E.i(x);return new o(T,this.h|E.h)},n.xor=function(E){const b=Math.max(this.g.length,E.g.length),T=[];for(let x=0;x<b;x++)T[x]=this.i(x)^E.i(x);return new o(T,this.h^E.h)};function M(E){const b=E.g.length+1,T=[];for(let x=0;x<b;x++)T[x]=E.i(x)<<1|E.i(x-1)>>>31;return new o(T,E.h)}function L(E,b){const T=b>>5;b%=32;const x=E.g.length-T,A=[];for(let P=0;P<x;P++)A[P]=b>0?E.i(P+T)>>>b|E.i(P+T+1)<<32-b:E.i(P+T);return new o(A,E.h)}i.prototype.digest=i.prototype.A,i.prototype.reset=i.prototype.u,i.prototype.update=i.prototype.v,ag=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=u,hn=o}).apply(typeof nu<"u"?nu:typeof self<"u"?self:typeof window<"u"?window:{});var fr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};var cg,hs,lg,Mr,Ja,hg,ug,dg;(function(){var n,t=Object.defineProperty;function e(l){l=[typeof globalThis=="object"&&globalThis,l,typeof window=="object"&&window,typeof self=="object"&&self,typeof fr=="object"&&fr];for(var f=0;f<l.length;++f){var p=l[f];if(p&&p.Math==Math)return p}throw Error("Cannot find global object")}var i=e(this);function s(l,f){if(f)t:{var p=i;l=l.split(".");for(var _=0;_<l.length-1;_++){var C=l[_];if(!(C in p))break t;p=p[C]}l=l[l.length-1],_=p[l],f=f(_),f!=_&&f!=null&&t(p,l,{configurable:!0,writable:!0,value:f})}}s("Symbol.dispose",function(l){return l||Symbol("Symbol.dispose")}),s("Array.prototype.values",function(l){return l||function(){return this[Symbol.iterator]()}}),s("Object.entries",function(l){return l||function(f){var p=[],_;for(_ in f)Object.prototype.hasOwnProperty.call(f,_)&&p.push([_,f[_]]);return p}});var r=r||{},o=this||self;function a(l){var f=typeof l;return f=="object"&&l!=null||f=="function"}function c(l,f,p){return l.call.apply(l.bind,arguments)}function h(l,f,p){return h=c,h.apply(null,arguments)}function u(l,f){var p=Array.prototype.slice.call(arguments,1);return function(){var _=p.slice();return _.push.apply(_,arguments),l.apply(this,_)}}function d(l,f){function p(){}p.prototype=f.prototype,l.Z=f.prototype,l.prototype=new p,l.prototype.constructor=l,l.Ob=function(_,C,k){for(var F=Array(arguments.length-2),G=2;G<arguments.length;G++)F[G-2]=arguments[G];return f.prototype[C].apply(_,F)}}var g=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?l=>l&&AsyncContext.Snapshot.wrap(l):l=>l;function m(l){const f=l.length;if(f>0){const p=Array(f);for(let _=0;_<f;_++)p[_]=l[_];return p}return[]}function y(l,f){for(let _=1;_<arguments.length;_++){const C=arguments[_];var p=typeof C;if(p=p!="object"?p:C?Array.isArray(C)?"array":p:"null",p=="array"||p=="object"&&typeof C.length=="number"){p=l.length||0;const k=C.length||0;l.length=p+k;for(let F=0;F<k;F++)l[p+F]=C[F]}else l.push(C)}}class v{constructor(f,p){this.i=f,this.j=p,this.h=0,this.g=null}get(){let f;return this.h>0?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function w(l){o.setTimeout(()=>{throw l},0)}function S(){var l=E;let f=null;return l.g&&(f=l.g,l.g=l.g.next,l.g||(l.h=null),f.next=null),f}class R{constructor(){this.h=this.g=null}add(f,p){const _=D.get();_.set(f,p),this.h?this.h.next=_:this.g=_,this.h=_}}var D=new v(()=>new V,l=>l.reset());class V{constructor(){this.next=this.g=this.h=null}set(f,p){this.h=f,this.g=p,this.next=null}reset(){this.next=this.g=this.h=null}}let M,L=!1,E=new R,b=()=>{const l=Promise.resolve(void 0);M=()=>{l.then(T)}};function T(){for(var l;l=S();){try{l.h.call(l.g)}catch(p){w(p)}var f=D;f.j(l),f.h<100&&(f.h++,l.next=f.g,f.g=l)}L=!1}function x(){this.u=this.u,this.C=this.C}x.prototype.u=!1,x.prototype.dispose=function(){this.u||(this.u=!0,this.N())},x.prototype[Symbol.dispose]=function(){this.dispose()},x.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function A(l,f){this.type=l,this.g=this.target=f,this.defaultPrevented=!1}A.prototype.h=function(){this.defaultPrevented=!0};var P=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var l=!1,f=Object.defineProperty({},"passive",{get:function(){l=!0}});try{const p=()=>{};o.addEventListener("test",p,f),o.removeEventListener("test",p,f)}catch{}return l})();function I(l){return/^[\s\xa0]*$/.test(l)}function st(l,f){A.call(this,l?l.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,l&&this.init(l,f)}d(st,A),st.prototype.init=function(l,f){const p=this.type=l.type,_=l.changedTouches&&l.changedTouches.length?l.changedTouches[0]:null;this.target=l.target||l.srcElement,this.g=f,f=l.relatedTarget,f||(p=="mouseover"?f=l.fromElement:p=="mouseout"&&(f=l.toElement)),this.relatedTarget=f,_?(this.clientX=_.clientX!==void 0?_.clientX:_.pageX,this.clientY=_.clientY!==void 0?_.clientY:_.pageY,this.screenX=_.screenX||0,this.screenY=_.screenY||0):(this.clientX=l.clientX!==void 0?l.clientX:l.pageX,this.clientY=l.clientY!==void 0?l.clientY:l.pageY,this.screenX=l.screenX||0,this.screenY=l.screenY||0),this.button=l.button,this.key=l.key||"",this.ctrlKey=l.ctrlKey,this.altKey=l.altKey,this.shiftKey=l.shiftKey,this.metaKey=l.metaKey,this.pointerId=l.pointerId||0,this.pointerType=l.pointerType,this.state=l.state,this.i=l,l.defaultPrevented&&st.Z.h.call(this)},st.prototype.h=function(){st.Z.h.call(this);const l=this.i;l.preventDefault?l.preventDefault():l.returnValue=!1};var Y="closure_listenable_"+(Math.random()*1e6|0),ot=0;function gt(l,f,p,_,C){this.listener=l,this.proxy=null,this.src=f,this.type=p,this.capture=!!_,this.ha=C,this.key=++ot,this.da=this.fa=!1}function Vt(l){l.da=!0,l.listener=null,l.proxy=null,l.src=null,l.ha=null}function yt(l,f,p){for(const _ in l)f.call(p,l[_],_,l)}function je(l,f){for(const p in l)f.call(void 0,l[p],p,l)}function xn(l){const f={};for(const p in l)f[p]=l[p];return f}const Ee="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function He(l,f){let p,_;for(let C=1;C<arguments.length;C++){_=arguments[C];for(p in _)l[p]=_[p];for(let k=0;k<Ee.length;k++)p=Ee[k],Object.prototype.hasOwnProperty.call(_,p)&&(l[p]=_[p])}}function te(l){this.src=l,this.g={},this.h=0}te.prototype.add=function(l,f,p,_,C){const k=l.toString();l=this.g[k],l||(l=this.g[k]=[],this.h++);const F=ie(l,f,_,C);return F>-1?(f=l[F],p||(f.fa=!1)):(f=new gt(f,this.src,k,!!_,C),f.fa=p,l.push(f)),f};function Ie(l,f){const p=f.type;if(p in l.g){var _=l.g[p],C=Array.prototype.indexOf.call(_,f,void 0),k;(k=C>=0)&&Array.prototype.splice.call(_,C,1),k&&(Vt(f),l.g[p].length==0&&(delete l.g[p],l.h--))}}function ie(l,f,p,_){for(let C=0;C<l.length;++C){const k=l[C];if(!k.da&&k.listener==f&&k.capture==!!p&&k.ha==_)return C}return-1}var Xo="closure_lm_"+(Math.random()*1e6|0),Qo={};function Gl(l,f,p,_,C){if(Array.isArray(f)){for(let k=0;k<f.length;k++)Gl(l,f[k],p,_,C);return null}return p=Xl(p),l&&l[Y]?l.J(f,p,a(_)?!!_.capture:!1,C):g_(l,f,p,!1,_,C)}function g_(l,f,p,_,C,k){if(!f)throw Error("Invalid event type");const F=a(C)?!!C.capture:!!C;let G=Zo(l);if(G||(l[Xo]=G=new te(l)),p=G.add(f,p,_,F,k),p.proxy)return p;if(_=p_(),p.proxy=_,_.src=l,_.listener=p,l.addEventListener)P||(C=F),C===void 0&&(C=!1),l.addEventListener(f.toString(),_,C);else if(l.attachEvent)l.attachEvent(Yl(f.toString()),_);else if(l.addListener&&l.removeListener)l.addListener(_);else throw Error("addEventListener and attachEvent are unavailable.");return p}function p_(){function l(p){return f.call(l.src,l.listener,p)}const f=m_;return l}function Kl(l,f,p,_,C){if(Array.isArray(f))for(var k=0;k<f.length;k++)Kl(l,f[k],p,_,C);else _=a(_)?!!_.capture:!!_,p=Xl(p),l&&l[Y]?(l=l.i,k=String(f).toString(),k in l.g&&(f=l.g[k],p=ie(f,p,_,C),p>-1&&(Vt(f[p]),Array.prototype.splice.call(f,p,1),f.length==0&&(delete l.g[k],l.h--)))):l&&(l=Zo(l))&&(f=l.g[f.toString()],l=-1,f&&(l=ie(f,p,_,C)),(p=l>-1?f[l]:null)&&Jo(p))}function Jo(l){if(typeof l!="number"&&l&&!l.da){var f=l.src;if(f&&f[Y])Ie(f.i,l);else{var p=l.type,_=l.proxy;f.removeEventListener?f.removeEventListener(p,_,l.capture):f.detachEvent?f.detachEvent(Yl(p),_):f.addListener&&f.removeListener&&f.removeListener(_),(p=Zo(f))?(Ie(p,l),p.h==0&&(p.src=null,f[Xo]=null)):Vt(l)}}}function Yl(l){return l in Qo?Qo[l]:Qo[l]="on"+l}function m_(l,f){if(l.da)l=!0;else{f=new st(f,this);const p=l.listener,_=l.ha||l.src;l.fa&&Jo(l),l=p.call(_,f)}return l}function Zo(l){return l=l[Xo],l instanceof te?l:null}var ta="__closure_events_fn_"+(Math.random()*1e9>>>0);function Xl(l){return typeof l=="function"?l:(l[ta]||(l[ta]=function(f){return l.handleEvent(f)}),l[ta])}function Nt(){x.call(this),this.i=new te(this),this.M=this,this.G=null}d(Nt,x),Nt.prototype[Y]=!0,Nt.prototype.removeEventListener=function(l,f,p,_){Kl(this,l,f,p,_)};function $t(l,f){var p,_=l.G;if(_)for(p=[];_;_=_.G)p.push(_);if(l=l.M,_=f.type||f,typeof f=="string")f=new A(f,l);else if(f instanceof A)f.target=f.target||l;else{var C=f;f=new A(_,l),He(f,C)}C=!0;let k,F;if(p)for(F=p.length-1;F>=0;F--)k=f.g=p[F],C=er(k,_,!0,f)&&C;if(k=f.g=l,C=er(k,_,!0,f)&&C,C=er(k,_,!1,f)&&C,p)for(F=0;F<p.length;F++)k=f.g=p[F],C=er(k,_,!1,f)&&C}Nt.prototype.N=function(){if(Nt.Z.N.call(this),this.i){var l=this.i;for(const f in l.g){const p=l.g[f];for(let _=0;_<p.length;_++)Vt(p[_]);delete l.g[f],l.h--}}this.G=null},Nt.prototype.J=function(l,f,p,_){return this.i.add(String(l),f,!1,p,_)},Nt.prototype.K=function(l,f,p,_){return this.i.add(String(l),f,!0,p,_)};function er(l,f,p,_){if(f=l.i.g[String(f)],!f)return!0;f=f.concat();let C=!0;for(let k=0;k<f.length;++k){const F=f[k];if(F&&!F.da&&F.capture==p){const G=F.listener,At=F.ha||F.src;F.fa&&Ie(l.i,F),C=G.call(At,_)!==!1&&C}}return C&&!_.defaultPrevented}function __(l,f){if(typeof l!="function")if(l&&typeof l.handleEvent=="function")l=h(l.handleEvent,l);else throw Error("Invalid listener argument");return Number(f)>2147483647?-1:o.setTimeout(l,f||0)}function Ql(l){l.g=__(()=>{l.g=null,l.i&&(l.i=!1,Ql(l))},l.l);const f=l.h;l.h=null,l.m.apply(null,f)}class y_ extends x{constructor(f,p){super(),this.m=f,this.l=p,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Ql(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ui(l){x.call(this),this.h=l,this.g={}}d(Ui,x);var Jl=[];function Zl(l){yt(l.g,function(f,p){this.g.hasOwnProperty(p)&&Jo(f)},l),l.g={}}Ui.prototype.N=function(){Ui.Z.N.call(this),Zl(this)},Ui.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ea=o.JSON.stringify,b_=o.JSON.parse,v_=class{stringify(l){return o.JSON.stringify(l,void 0)}parse(l){return o.JSON.parse(l,void 0)}};function th(){}function eh(){}var zi={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function na(){A.call(this,"d")}d(na,A);function ia(){A.call(this,"c")}d(ia,A);var Sn={},nh=null;function nr(){return nh=nh||new Nt}Sn.Ia="serverreachability";function ih(l){A.call(this,Sn.Ia,l)}d(ih,A);function ji(l){const f=nr();$t(f,new ih(f))}Sn.STAT_EVENT="statevent";function sh(l,f){A.call(this,Sn.STAT_EVENT,l),this.stat=f}d(sh,A);function qt(l){const f=nr();$t(f,new sh(f,l))}Sn.Ja="timingevent";function rh(l,f){A.call(this,Sn.Ja,l),this.size=f}d(rh,A);function Hi(l,f){if(typeof l!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){l()},f)}function Wi(){this.g=!0}Wi.prototype.ua=function(){this.g=!1};function w_(l,f,p,_,C,k){l.info(function(){if(l.g)if(k){var F="",G=k.split("&");for(let rt=0;rt<G.length;rt++){var At=G[rt].split("=");if(At.length>1){const Pt=At[0];At=At[1];const he=Pt.split("_");F=he.length>=2&&he[1]=="type"?F+(Pt+"="+At+"&"):F+(Pt+"=redacted&")}}}else F=null;else F=k;return"XMLHTTP REQ ("+_+") [attempt "+C+"]: "+f+`
`+p+`
`+F})}function T_(l,f,p,_,C,k,F){l.info(function(){return"XMLHTTP RESP ("+_+") [ attempt "+C+"]: "+f+`
`+p+`
`+k+" "+F})}function ni(l,f,p,_){l.info(function(){return"XMLHTTP TEXT ("+f+"): "+I_(l,p)+(_?" "+_:"")})}function E_(l,f){l.info(function(){return"TIMEOUT: "+f})}Wi.prototype.info=function(){};function I_(l,f){if(!l.g)return f;if(!f)return null;try{const k=JSON.parse(f);if(k){for(l=0;l<k.length;l++)if(Array.isArray(k[l])){var p=k[l];if(!(p.length<2)){var _=p[1];if(Array.isArray(_)&&!(_.length<1)){var C=_[0];if(C!="noop"&&C!="stop"&&C!="close")for(let F=1;F<_.length;F++)_[F]=""}}}}return ea(k)}catch{return f}}var ir={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},oh={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},ah;function sa(){}d(sa,th),sa.prototype.g=function(){return new XMLHttpRequest},ah=new sa;function $i(l){return encodeURIComponent(String(l))}function A_(l){var f=1;l=l.split(":");const p=[];for(;f>0&&l.length;)p.push(l.shift()),f--;return l.length&&p.push(l.join(":")),p}function We(l,f,p,_){this.j=l,this.i=f,this.l=p,this.S=_||1,this.V=new Ui(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new ch}function ch(){this.i=null,this.g="",this.h=!1}var lh={},ra={};function oa(l,f,p){l.M=1,l.A=rr(le(f)),l.u=p,l.R=!0,hh(l,null)}function hh(l,f){l.F=Date.now(),sr(l),l.B=le(l.A);var p=l.B,_=l.S;Array.isArray(_)||(_=[String(_)]),Eh(p.i,"t",_),l.C=0,p=l.j.L,l.h=new ch,l.g=zh(l.j,p?f:null,!l.u),l.P>0&&(l.O=new y_(h(l.Y,l,l.g),l.P)),f=l.V,p=l.g,_=l.ba;var C="readystatechange";Array.isArray(C)||(C&&(Jl[0]=C.toString()),C=Jl);for(let k=0;k<C.length;k++){const F=Gl(p,C[k],_||f.handleEvent,!1,f.h||f);if(!F)break;f.g[F.key]=F}f=l.J?xn(l.J):{},l.u?(l.v||(l.v="POST"),f["Content-Type"]="application/x-www-form-urlencoded",l.g.ea(l.B,l.v,l.u,f)):(l.v="GET",l.g.ea(l.B,l.v,null,f)),ji(),w_(l.i,l.v,l.B,l.l,l.S,l.u)}We.prototype.ba=function(l){l=l.target;const f=this.O;f&&Ge(l)==3?f.j():this.Y(l)},We.prototype.Y=function(l){try{if(l==this.g)t:{const G=Ge(this.g),At=this.g.ya(),rt=this.g.ca();if(!(G<3)&&(G!=3||this.g&&(this.h.h||this.g.la()||Ch(this.g)))){this.K||G!=4||At==7||(At==8||rt<=0?ji(3):ji(2)),aa(this);var f=this.g.ca();this.X=f;var p=x_(this);if(this.o=f==200,T_(this.i,this.v,this.B,this.l,this.S,G,f),this.o){if(this.U&&!this.L){e:{if(this.g){var _,C=this.g;if((_=C.g?C.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(_)){var k=_;break e}}k=null}if(l=k)ni(this.i,this.l,l,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,ca(this,l);else{this.o=!1,this.m=3,qt(12),Pn(this),qi(this);break t}}if(this.R){l=!0;let Pt;for(;!this.K&&this.C<p.length;)if(Pt=S_(this,p),Pt==ra){G==4&&(this.m=4,qt(14),l=!1),ni(this.i,this.l,null,"[Incomplete Response]");break}else if(Pt==lh){this.m=4,qt(15),ni(this.i,this.l,p,"[Invalid Chunk]"),l=!1;break}else ni(this.i,this.l,Pt,null),ca(this,Pt);if(uh(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),G!=4||p.length!=0||this.h.h||(this.m=1,qt(16),l=!1),this.o=this.o&&l,!l)ni(this.i,this.l,p,"[Invalid Chunked Response]"),Pn(this),qi(this);else if(p.length>0&&!this.W){this.W=!0;var F=this.j;F.g==this&&F.aa&&!F.P&&(F.j.info("Great, no buffering proxy detected. Bytes received: "+p.length),ma(F),F.P=!0,qt(11))}}else ni(this.i,this.l,p,null),ca(this,p);G==4&&Pn(this),this.o&&!this.K&&(G==4?Lh(this.j,this):(this.o=!1,sr(this)))}else z_(this.g),f==400&&p.indexOf("Unknown SID")>0?(this.m=3,qt(12)):(this.m=0,qt(13)),Pn(this),qi(this)}}}catch{}finally{}};function x_(l){if(!uh(l))return l.g.la();const f=Ch(l.g);if(f==="")return"";let p="";const _=f.length,C=Ge(l.g)==4;if(!l.h.i){if(typeof TextDecoder>"u")return Pn(l),qi(l),"";l.h.i=new o.TextDecoder}for(let k=0;k<_;k++)l.h.h=!0,p+=l.h.i.decode(f[k],{stream:!(C&&k==_-1)});return f.length=0,l.h.g+=p,l.C=0,l.h.g}function uh(l){return l.g?l.v=="GET"&&l.M!=2&&l.j.Aa:!1}function S_(l,f){var p=l.C,_=f.indexOf(`
`,p);return _==-1?ra:(p=Number(f.substring(p,_)),isNaN(p)?lh:(_+=1,_+p>f.length?ra:(f=f.slice(_,_+p),l.C=_+p,f)))}We.prototype.cancel=function(){this.K=!0,Pn(this)};function sr(l){l.T=Date.now()+l.H,dh(l,l.H)}function dh(l,f){if(l.D!=null)throw Error("WatchDog timer not null");l.D=Hi(h(l.aa,l),f)}function aa(l){l.D&&(o.clearTimeout(l.D),l.D=null)}We.prototype.aa=function(){this.D=null;const l=Date.now();l-this.T>=0?(E_(this.i,this.B),this.M!=2&&(ji(),qt(17)),Pn(this),this.m=2,qi(this)):dh(this,this.T-l)};function qi(l){l.j.I==0||l.K||Lh(l.j,l)}function Pn(l){aa(l);var f=l.O;f&&typeof f.dispose=="function"&&f.dispose(),l.O=null,Zl(l.V),l.g&&(f=l.g,l.g=null,f.abort(),f.dispose())}function ca(l,f){try{var p=l.j;if(p.I!=0&&(p.g==l||la(p.h,l))){if(!l.L&&la(p.h,l)&&p.I==3){try{var _=p.Ba.g.parse(f)}catch{_=null}if(Array.isArray(_)&&_.length==3){var C=_;if(C[0]==0){t:if(!p.v){if(p.g)if(p.g.F+3e3<l.F)hr(p),cr(p);else break t;pa(p),qt(18)}}else p.xa=C[1],0<p.xa-p.K&&C[2]<37500&&p.F&&p.A==0&&!p.C&&(p.C=Hi(h(p.Va,p),6e3));ph(p.h)<=1&&p.ta&&(p.ta=void 0)}else Cn(p,11)}else if((l.L||p.g==l)&&hr(p),!I(f))for(C=p.Ba.g.parse(f),f=0;f<C.length;f++){let rt=C[f];const Pt=rt[0];if(!(Pt<=p.K))if(p.K=Pt,rt=rt[1],p.I==2)if(rt[0]=="c"){p.M=rt[1],p.ba=rt[2];const he=rt[3];he!=null&&(p.ka=he,p.j.info("VER="+p.ka));const kn=rt[4];kn!=null&&(p.za=kn,p.j.info("SVER="+p.za));const Ke=rt[5];Ke!=null&&typeof Ke=="number"&&Ke>0&&(_=1.5*Ke,p.O=_,p.j.info("backChannelRequestTimeoutMs_="+_)),_=p;const Ye=l.g;if(Ye){const dr=Ye.g?Ye.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(dr){var k=_.h;k.g||dr.indexOf("spdy")==-1&&dr.indexOf("quic")==-1&&dr.indexOf("h2")==-1||(k.j=k.l,k.g=new Set,k.h&&(ha(k,k.h),k.h=null))}if(_.G){const _a=Ye.g?Ye.g.getResponseHeader("X-HTTP-Session-Id"):null;_a&&(_.wa=_a,lt(_.J,_.G,_a))}}p.I=3,p.l&&p.l.ra(),p.aa&&(p.T=Date.now()-l.F,p.j.info("Handshake RTT: "+p.T+"ms")),_=p;var F=l;if(_.na=Uh(_,_.L?_.ba:null,_.W),F.L){mh(_.h,F);var G=F,At=_.O;At&&(G.H=At),G.D&&(aa(G),sr(G)),_.g=F}else Vh(_);p.i.length>0&&lr(p)}else rt[0]!="stop"&&rt[0]!="close"||Cn(p,7);else p.I==3&&(rt[0]=="stop"||rt[0]=="close"?rt[0]=="stop"?Cn(p,7):ga(p):rt[0]!="noop"&&p.l&&p.l.qa(rt),p.A=0)}}ji(4)}catch{}}var P_=class{constructor(l,f){this.g=l,this.map=f}};function fh(l){this.l=l||10,o.PerformanceNavigationTiming?(l=o.performance.getEntriesByType("navigation"),l=l.length>0&&(l[0].nextHopProtocol=="hq"||l[0].nextHopProtocol=="h2")):l=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=l?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function gh(l){return l.h?!0:l.g?l.g.size>=l.j:!1}function ph(l){return l.h?1:l.g?l.g.size:0}function la(l,f){return l.h?l.h==f:l.g?l.g.has(f):!1}function ha(l,f){l.g?l.g.add(f):l.h=f}function mh(l,f){l.h&&l.h==f?l.h=null:l.g&&l.g.has(f)&&l.g.delete(f)}fh.prototype.cancel=function(){if(this.i=_h(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const l of this.g.values())l.cancel();this.g.clear()}};function _h(l){if(l.h!=null)return l.i.concat(l.h.G);if(l.g!=null&&l.g.size!==0){let f=l.i;for(const p of l.g.values())f=f.concat(p.G);return f}return m(l.i)}var yh=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function R_(l,f){if(l){l=l.split("&");for(let p=0;p<l.length;p++){const _=l[p].indexOf("=");let C,k=null;_>=0?(C=l[p].substring(0,_),k=l[p].substring(_+1)):C=l[p],f(C,k?decodeURIComponent(k.replace(/\+/g," ")):"")}}}function $e(l){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let f;l instanceof $e?(this.l=l.l,Gi(this,l.j),this.o=l.o,this.g=l.g,Ki(this,l.u),this.h=l.h,ua(this,Ih(l.i)),this.m=l.m):l&&(f=String(l).match(yh))?(this.l=!1,Gi(this,f[1]||"",!0),this.o=Yi(f[2]||""),this.g=Yi(f[3]||"",!0),Ki(this,f[4]),this.h=Yi(f[5]||"",!0),ua(this,f[6]||"",!0),this.m=Yi(f[7]||"")):(this.l=!1,this.i=new Qi(null,this.l))}$e.prototype.toString=function(){const l=[];var f=this.j;f&&l.push(Xi(f,bh,!0),":");var p=this.g;return(p||f=="file")&&(l.push("//"),(f=this.o)&&l.push(Xi(f,bh,!0),"@"),l.push($i(p).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),p=this.u,p!=null&&l.push(":",String(p))),(p=this.h)&&(this.g&&p.charAt(0)!="/"&&l.push("/"),l.push(Xi(p,p.charAt(0)=="/"?D_:k_,!0))),(p=this.i.toString())&&l.push("?",p),(p=this.m)&&l.push("#",Xi(p,O_)),l.join("")},$e.prototype.resolve=function(l){const f=le(this);let p=!!l.j;p?Gi(f,l.j):p=!!l.o,p?f.o=l.o:p=!!l.g,p?f.g=l.g:p=l.u!=null;var _=l.h;if(p)Ki(f,l.u);else if(p=!!l.h){if(_.charAt(0)!="/")if(this.g&&!this.h)_="/"+_;else{var C=f.h.lastIndexOf("/");C!=-1&&(_=f.h.slice(0,C+1)+_)}if(C=_,C==".."||C==".")_="";else if(C.indexOf("./")!=-1||C.indexOf("/.")!=-1){_=C.lastIndexOf("/",0)==0,C=C.split("/");const k=[];for(let F=0;F<C.length;){const G=C[F++];G=="."?_&&F==C.length&&k.push(""):G==".."?((k.length>1||k.length==1&&k[0]!="")&&k.pop(),_&&F==C.length&&k.push("")):(k.push(G),_=!0)}_=k.join("/")}else _=C}return p?f.h=_:p=l.i.toString()!=="",p?ua(f,Ih(l.i)):p=!!l.m,p&&(f.m=l.m),f};function le(l){return new $e(l)}function Gi(l,f,p){l.j=p?Yi(f,!0):f,l.j&&(l.j=l.j.replace(/:$/,""))}function Ki(l,f){if(f){if(f=Number(f),isNaN(f)||f<0)throw Error("Bad port number "+f);l.u=f}else l.u=null}function ua(l,f,p){f instanceof Qi?(l.i=f,V_(l.i,l.l)):(p||(f=Xi(f,M_)),l.i=new Qi(f,l.l))}function lt(l,f,p){l.i.set(f,p)}function rr(l){return lt(l,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),l}function Yi(l,f){return l?f?decodeURI(l.replace(/%25/g,"%2525")):decodeURIComponent(l):""}function Xi(l,f,p){return typeof l=="string"?(l=encodeURI(l).replace(f,C_),p&&(l=l.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),l):null}function C_(l){return l=l.charCodeAt(0),"%"+(l>>4&15).toString(16)+(l&15).toString(16)}var bh=/[#\/\?@]/g,k_=/[#\?:]/g,D_=/[#\?]/g,M_=/[#\?@]/g,O_=/#/g;function Qi(l,f){this.h=this.g=null,this.i=l||null,this.j=!!f}function Rn(l){l.g||(l.g=new Map,l.h=0,l.i&&R_(l.i,function(f,p){l.add(decodeURIComponent(f.replace(/\+/g," ")),p)}))}n=Qi.prototype,n.add=function(l,f){Rn(this),this.i=null,l=ii(this,l);let p=this.g.get(l);return p||this.g.set(l,p=[]),p.push(f),this.h+=1,this};function vh(l,f){Rn(l),f=ii(l,f),l.g.has(f)&&(l.i=null,l.h-=l.g.get(f).length,l.g.delete(f))}function wh(l,f){return Rn(l),f=ii(l,f),l.g.has(f)}n.forEach=function(l,f){Rn(this),this.g.forEach(function(p,_){p.forEach(function(C){l.call(f,C,_,this)},this)},this)};function Th(l,f){Rn(l);let p=[];if(typeof f=="string")wh(l,f)&&(p=p.concat(l.g.get(ii(l,f))));else for(l=Array.from(l.g.values()),f=0;f<l.length;f++)p=p.concat(l[f]);return p}n.set=function(l,f){return Rn(this),this.i=null,l=ii(this,l),wh(this,l)&&(this.h-=this.g.get(l).length),this.g.set(l,[f]),this.h+=1,this},n.get=function(l,f){return l?(l=Th(this,l),l.length>0?String(l[0]):f):f};function Eh(l,f,p){vh(l,f),p.length>0&&(l.i=null,l.g.set(ii(l,f),m(p)),l.h+=p.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const l=[],f=Array.from(this.g.keys());for(let _=0;_<f.length;_++){var p=f[_];const C=$i(p);p=Th(this,p);for(let k=0;k<p.length;k++){let F=C;p[k]!==""&&(F+="="+$i(p[k])),l.push(F)}}return this.i=l.join("&")};function Ih(l){const f=new Qi;return f.i=l.i,l.g&&(f.g=new Map(l.g),f.h=l.h),f}function ii(l,f){return f=String(f),l.j&&(f=f.toLowerCase()),f}function V_(l,f){f&&!l.j&&(Rn(l),l.i=null,l.g.forEach(function(p,_){const C=_.toLowerCase();_!=C&&(vh(this,_),Eh(this,C,p))},l)),l.j=f}function N_(l,f){const p=new Wi;if(o.Image){const _=new Image;_.onload=u(qe,p,"TestLoadImage: loaded",!0,f,_),_.onerror=u(qe,p,"TestLoadImage: error",!1,f,_),_.onabort=u(qe,p,"TestLoadImage: abort",!1,f,_),_.ontimeout=u(qe,p,"TestLoadImage: timeout",!1,f,_),o.setTimeout(function(){_.ontimeout&&_.ontimeout()},1e4),_.src=l}else f(!1)}function L_(l,f){const p=new Wi,_=new AbortController,C=setTimeout(()=>{_.abort(),qe(p,"TestPingServer: timeout",!1,f)},1e4);fetch(l,{signal:_.signal}).then(k=>{clearTimeout(C),k.ok?qe(p,"TestPingServer: ok",!0,f):qe(p,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(C),qe(p,"TestPingServer: error",!1,f)})}function qe(l,f,p,_,C){try{C&&(C.onload=null,C.onerror=null,C.onabort=null,C.ontimeout=null),_(p)}catch{}}function F_(){this.g=new v_}function da(l){this.i=l.Sb||null,this.h=l.ab||!1}d(da,th),da.prototype.g=function(){return new or(this.i,this.h)};function or(l,f){Nt.call(this),this.H=l,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}d(or,Nt),n=or.prototype,n.open=function(l,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=l,this.D=f,this.readyState=1,Zi(this)},n.send=function(l){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const f={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};l&&(f.body=l),(this.H||o).fetch(new Request(this.D,f)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Ji(this)),this.readyState=0},n.Pa=function(l){if(this.g&&(this.l=l,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=l.headers,this.readyState=2,Zi(this)),this.g&&(this.readyState=3,Zi(this),this.g)))if(this.responseType==="arraybuffer")l.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in l){if(this.j=l.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Ah(this)}else l.text().then(this.Oa.bind(this),this.ga.bind(this))};function Ah(l){l.j.read().then(l.Ma.bind(l)).catch(l.ga.bind(l))}n.Ma=function(l){if(this.g){if(this.o&&l.value)this.response.push(l.value);else if(!this.o){var f=l.value?l.value:new Uint8Array(0);(f=this.B.decode(f,{stream:!l.done}))&&(this.response=this.responseText+=f)}l.done?Ji(this):Zi(this),this.readyState==3&&Ah(this)}},n.Oa=function(l){this.g&&(this.response=this.responseText=l,Ji(this))},n.Na=function(l){this.g&&(this.response=l,Ji(this))},n.ga=function(){this.g&&Ji(this)};function Ji(l){l.readyState=4,l.l=null,l.j=null,l.B=null,Zi(l)}n.setRequestHeader=function(l,f){this.A.append(l,f)},n.getResponseHeader=function(l){return this.h&&this.h.get(l.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const l=[],f=this.h.entries();for(var p=f.next();!p.done;)p=p.value,l.push(p[0]+": "+p[1]),p=f.next();return l.join(`\r
`)};function Zi(l){l.onreadystatechange&&l.onreadystatechange.call(l)}Object.defineProperty(or.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(l){this.m=l?"include":"same-origin"}});function xh(l){let f="";return yt(l,function(p,_){f+=_,f+=":",f+=p,f+=`\r
`}),f}function fa(l,f,p){t:{for(_ in p){var _=!1;break t}_=!0}_||(p=xh(p),typeof l=="string"?p!=null&&$i(p):lt(l,f,p))}function mt(l){Nt.call(this),this.headers=new Map,this.L=l||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}d(mt,Nt);var B_=/^https?$/i,U_=["POST","PUT"];n=mt.prototype,n.Fa=function(l){this.H=l},n.ea=function(l,f,p,_){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+l);f=f?f.toUpperCase():"GET",this.D=l,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():ah.g(),this.g.onreadystatechange=g(h(this.Ca,this));try{this.B=!0,this.g.open(f,String(l),!0),this.B=!1}catch(k){Sh(this,k);return}if(l=p||"",p=new Map(this.headers),_)if(Object.getPrototypeOf(_)===Object.prototype)for(var C in _)p.set(C,_[C]);else if(typeof _.keys=="function"&&typeof _.get=="function")for(const k of _.keys())p.set(k,_.get(k));else throw Error("Unknown input type for opt_headers: "+String(_));_=Array.from(p.keys()).find(k=>k.toLowerCase()=="content-type"),C=o.FormData&&l instanceof o.FormData,!(Array.prototype.indexOf.call(U_,f,void 0)>=0)||_||C||p.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[k,F]of p)this.g.setRequestHeader(k,F);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(l),this.v=!1}catch(k){Sh(this,k)}};function Sh(l,f){l.h=!1,l.g&&(l.j=!0,l.g.abort(),l.j=!1),l.l=f,l.o=5,Ph(l),ar(l)}function Ph(l){l.A||(l.A=!0,$t(l,"complete"),$t(l,"error"))}n.abort=function(l){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=l||7,$t(this,"complete"),$t(this,"abort"),ar(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ar(this,!0)),mt.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?Rh(this):this.Xa())},n.Xa=function(){Rh(this)};function Rh(l){if(l.h&&typeof r<"u"){if(l.v&&Ge(l)==4)setTimeout(l.Ca.bind(l),0);else if($t(l,"readystatechange"),Ge(l)==4){l.h=!1;try{const k=l.ca();t:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var p;if(!(p=f)){var _;if(_=k===0){let F=String(l.D).match(yh)[1]||null;!F&&o.self&&o.self.location&&(F=o.self.location.protocol.slice(0,-1)),_=!B_.test(F?F.toLowerCase():"")}p=_}if(p)$t(l,"complete"),$t(l,"success");else{l.o=6;try{var C=Ge(l)>2?l.g.statusText:""}catch{C=""}l.l=C+" ["+l.ca()+"]",Ph(l)}}finally{ar(l)}}}}function ar(l,f){if(l.g){l.m&&(clearTimeout(l.m),l.m=null);const p=l.g;l.g=null,f||$t(l,"ready");try{p.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function Ge(l){return l.g?l.g.readyState:0}n.ca=function(){try{return Ge(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(l){if(this.g){var f=this.g.responseText;return l&&f.indexOf(l)==0&&(f=f.substring(l.length)),b_(f)}};function Ch(l){try{if(!l.g)return null;if("response"in l.g)return l.g.response;switch(l.F){case"":case"text":return l.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in l.g)return l.g.mozResponseArrayBuffer}return null}catch{return null}}function z_(l){const f={};l=(l.g&&Ge(l)>=2&&l.g.getAllResponseHeaders()||"").split(`\r
`);for(let _=0;_<l.length;_++){if(I(l[_]))continue;var p=A_(l[_]);const C=p[0];if(p=p[1],typeof p!="string")continue;p=p.trim();const k=f[C]||[];f[C]=k,k.push(p)}je(f,function(_){return _.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ts(l,f,p){return p&&p.internalChannelParams&&p.internalChannelParams[l]||f}function kh(l){this.za=0,this.i=[],this.j=new Wi,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ts("failFast",!1,l),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ts("baseRetryDelayMs",5e3,l),this.Za=ts("retryDelaySeedMs",1e4,l),this.Ta=ts("forwardChannelMaxRetries",2,l),this.va=ts("forwardChannelRequestTimeoutMs",2e4,l),this.ma=l&&l.xmlHttpFactory||void 0,this.Ua=l&&l.Rb||void 0,this.Aa=l&&l.useFetchStreams||!1,this.O=void 0,this.L=l&&l.supportsCrossDomainXhr||!1,this.M="",this.h=new fh(l&&l.concurrentRequestLimit),this.Ba=new F_,this.S=l&&l.fastHandshake||!1,this.R=l&&l.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=l&&l.Pb||!1,l&&l.ua&&this.j.ua(),l&&l.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&l&&l.detectBufferingProxy||!1,this.ia=void 0,l&&l.longPollingTimeout&&l.longPollingTimeout>0&&(this.ia=l.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=kh.prototype,n.ka=8,n.I=1,n.connect=function(l,f,p,_){qt(0),this.W=l,this.H=f||{},p&&_!==void 0&&(this.H.OSID=p,this.H.OAID=_),this.F=this.X,this.J=Uh(this,null,this.W),lr(this)};function ga(l){if(Dh(l),l.I==3){var f=l.V++,p=le(l.J);if(lt(p,"SID",l.M),lt(p,"RID",f),lt(p,"TYPE","terminate"),es(l,p),f=new We(l,l.j,f),f.M=2,f.A=rr(le(p)),p=!1,o.navigator&&o.navigator.sendBeacon)try{p=o.navigator.sendBeacon(f.A.toString(),"")}catch{}!p&&o.Image&&(new Image().src=f.A,p=!0),p||(f.g=zh(f.j,null),f.g.ea(f.A)),f.F=Date.now(),sr(f)}Bh(l)}function cr(l){l.g&&(ma(l),l.g.cancel(),l.g=null)}function Dh(l){cr(l),l.v&&(o.clearTimeout(l.v),l.v=null),hr(l),l.h.cancel(),l.m&&(typeof l.m=="number"&&o.clearTimeout(l.m),l.m=null)}function lr(l){if(!gh(l.h)&&!l.m){l.m=!0;var f=l.Ea;M||b(),L||(M(),L=!0),E.add(f,l),l.D=0}}function j_(l,f){return ph(l.h)>=l.h.j-(l.m?1:0)?!1:l.m?(l.i=f.G.concat(l.i),!0):l.I==1||l.I==2||l.D>=(l.Sa?0:l.Ta)?!1:(l.m=Hi(h(l.Ea,l,f),Fh(l,l.D)),l.D++,!0)}n.Ea=function(l){if(this.m)if(this.m=null,this.I==1){if(!l){this.V=Math.floor(Math.random()*1e5),l=this.V++;const C=new We(this,this.j,l);let k=this.o;if(this.U&&(k?(k=xn(k),He(k,this.U)):k=this.U),this.u!==null||this.R||(C.J=k,k=null),this.S)t:{for(var f=0,p=0;p<this.i.length;p++){e:{var _=this.i[p];if("__data__"in _.map&&(_=_.map.__data__,typeof _=="string")){_=_.length;break e}_=void 0}if(_===void 0)break;if(f+=_,f>4096){f=p;break t}if(f===4096||p===this.i.length-1){f=p+1;break t}}f=1e3}else f=1e3;f=Oh(this,C,f),p=le(this.J),lt(p,"RID",l),lt(p,"CVER",22),this.G&&lt(p,"X-HTTP-Session-Id",this.G),es(this,p),k&&(this.R?f="headers="+$i(xh(k))+"&"+f:this.u&&fa(p,this.u,k)),ha(this.h,C),this.Ra&&lt(p,"TYPE","init"),this.S?(lt(p,"$req",f),lt(p,"SID","null"),C.U=!0,oa(C,p,null)):oa(C,p,f),this.I=2}}else this.I==3&&(l?Mh(this,l):this.i.length==0||gh(this.h)||Mh(this))};function Mh(l,f){var p;f?p=f.l:p=l.V++;const _=le(l.J);lt(_,"SID",l.M),lt(_,"RID",p),lt(_,"AID",l.K),es(l,_),l.u&&l.o&&fa(_,l.u,l.o),p=new We(l,l.j,p,l.D+1),l.u===null&&(p.J=l.o),f&&(l.i=f.G.concat(l.i)),f=Oh(l,p,1e3),p.H=Math.round(l.va*.5)+Math.round(l.va*.5*Math.random()),ha(l.h,p),oa(p,_,f)}function es(l,f){l.H&&yt(l.H,function(p,_){lt(f,_,p)}),l.l&&yt({},function(p,_){lt(f,_,p)})}function Oh(l,f,p){p=Math.min(l.i.length,p);const _=l.l?h(l.l.Ka,l.l,l):null;t:{var C=l.i;let G=-1;for(;;){const At=["count="+p];G==-1?p>0?(G=C[0].g,At.push("ofs="+G)):G=0:At.push("ofs="+G);let rt=!0;for(let Pt=0;Pt<p;Pt++){var k=C[Pt].g;const he=C[Pt].map;if(k-=G,k<0)G=Math.max(0,C[Pt].g-100),rt=!1;else try{k="req"+k+"_"||"";try{var F=he instanceof Map?he:Object.entries(he);for(const[kn,Ke]of F){let Ye=Ke;a(Ke)&&(Ye=ea(Ke)),At.push(k+kn+"="+encodeURIComponent(Ye))}}catch(kn){throw At.push(k+"type="+encodeURIComponent("_badmap")),kn}}catch{_&&_(he)}}if(rt){F=At.join("&");break t}}F=void 0}return l=l.i.splice(0,p),f.G=l,F}function Vh(l){if(!l.g&&!l.v){l.Y=1;var f=l.Da;M||b(),L||(M(),L=!0),E.add(f,l),l.A=0}}function pa(l){return l.g||l.v||l.A>=3?!1:(l.Y++,l.v=Hi(h(l.Da,l),Fh(l,l.A)),l.A++,!0)}n.Da=function(){if(this.v=null,Nh(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var l=4*this.T;this.j.info("BP detection timer enabled: "+l),this.B=Hi(h(this.Wa,this),l)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,qt(10),cr(this),Nh(this))};function ma(l){l.B!=null&&(o.clearTimeout(l.B),l.B=null)}function Nh(l){l.g=new We(l,l.j,"rpc",l.Y),l.u===null&&(l.g.J=l.o),l.g.P=0;var f=le(l.na);lt(f,"RID","rpc"),lt(f,"SID",l.M),lt(f,"AID",l.K),lt(f,"CI",l.F?"0":"1"),!l.F&&l.ia&&lt(f,"TO",l.ia),lt(f,"TYPE","xmlhttp"),es(l,f),l.u&&l.o&&fa(f,l.u,l.o),l.O&&(l.g.H=l.O);var p=l.g;l=l.ba,p.M=1,p.A=rr(le(f)),p.u=null,p.R=!0,hh(p,l)}n.Va=function(){this.C!=null&&(this.C=null,cr(this),pa(this),qt(19))};function hr(l){l.C!=null&&(o.clearTimeout(l.C),l.C=null)}function Lh(l,f){var p=null;if(l.g==f){hr(l),ma(l),l.g=null;var _=2}else if(la(l.h,f))p=f.G,mh(l.h,f),_=1;else return;if(l.I!=0){if(f.o)if(_==1){p=f.u?f.u.length:0,f=Date.now()-f.F;var C=l.D;_=nr(),$t(_,new rh(_,p)),lr(l)}else Vh(l);else if(C=f.m,C==3||C==0&&f.X>0||!(_==1&&j_(l,f)||_==2&&pa(l)))switch(p&&p.length>0&&(f=l.h,f.i=f.i.concat(p)),C){case 1:Cn(l,5);break;case 4:Cn(l,10);break;case 3:Cn(l,6);break;default:Cn(l,2)}}}function Fh(l,f){let p=l.Qa+Math.floor(Math.random()*l.Za);return l.isActive()||(p*=2),p*f}function Cn(l,f){if(l.j.info("Error code "+f),f==2){var p=h(l.bb,l),_=l.Ua;const C=!_;_=new $e(_||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Gi(_,"https"),rr(_),C?N_(_.toString(),p):L_(_.toString(),p)}else qt(2);l.I=0,l.l&&l.l.pa(f),Bh(l),Dh(l)}n.bb=function(l){l?(this.j.info("Successfully pinged google.com"),qt(2)):(this.j.info("Failed to ping google.com"),qt(1))};function Bh(l){if(l.I=0,l.ja=[],l.l){const f=_h(l.h);(f.length!=0||l.i.length!=0)&&(y(l.ja,f),y(l.ja,l.i),l.h.i.length=0,m(l.i),l.i.length=0),l.l.oa()}}function Uh(l,f,p){var _=p instanceof $e?le(p):new $e(p);if(_.g!="")f&&(_.g=f+"."+_.g),Ki(_,_.u);else{var C=o.location;_=C.protocol,f=f?f+"."+C.hostname:C.hostname,C=+C.port;const k=new $e(null);_&&Gi(k,_),f&&(k.g=f),C&&Ki(k,C),p&&(k.h=p),_=k}return p=l.G,f=l.wa,p&&f&&lt(_,p,f),lt(_,"VER",l.ka),es(l,_),_}function zh(l,f,p){if(f&&!l.L)throw Error("Can't create secondary domain capable XhrIo object.");return f=l.Aa&&!l.ma?new mt(new da({ab:p})):new mt(l.ma),f.Fa(l.L),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function jh(){}n=jh.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function ur(){}ur.prototype.g=function(l,f){return new Qt(l,f)};function Qt(l,f){Nt.call(this),this.g=new kh(f),this.l=l,this.h=f&&f.messageUrlParams||null,l=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(l?l["X-Client-Protocol"]="webchannel":l={"X-Client-Protocol":"webchannel"}),this.g.o=l,l=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(l?l["X-WebChannel-Content-Type"]=f.messageContentType:l={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.sa&&(l?l["X-WebChannel-Client-Profile"]=f.sa:l={"X-WebChannel-Client-Profile":f.sa}),this.g.U=l,(l=f&&f.Qb)&&!I(l)&&(this.g.u=l),this.A=f&&f.supportsCrossDomainXhr||!1,this.v=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!I(f)&&(this.g.G=f,l=this.h,l!==null&&f in l&&(l=this.h,f in l&&delete l[f])),this.j=new si(this)}d(Qt,Nt),Qt.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},Qt.prototype.close=function(){ga(this.g)},Qt.prototype.o=function(l){var f=this.g;if(typeof l=="string"){var p={};p.__data__=l,l=p}else this.v&&(p={},p.__data__=ea(l),l=p);f.i.push(new P_(f.Ya++,l)),f.I==3&&lr(f)},Qt.prototype.N=function(){this.g.l=null,delete this.j,ga(this.g),delete this.g,Qt.Z.N.call(this)};function Hh(l){na.call(this),l.__headers__&&(this.headers=l.__headers__,this.statusCode=l.__status__,delete l.__headers__,delete l.__status__);var f=l.__sm__;if(f){t:{for(const p in f){l=p;break t}l=void 0}(this.i=l)&&(l=this.i,f=f!==null&&l in f?f[l]:void 0),this.data=f}else this.data=l}d(Hh,na);function Wh(){ia.call(this),this.status=1}d(Wh,ia);function si(l){this.g=l}d(si,jh),si.prototype.ra=function(){$t(this.g,"a")},si.prototype.qa=function(l){$t(this.g,new Hh(l))},si.prototype.pa=function(l){$t(this.g,new Wh)},si.prototype.oa=function(){$t(this.g,"b")},ur.prototype.createWebChannel=ur.prototype.g,Qt.prototype.send=Qt.prototype.o,Qt.prototype.open=Qt.prototype.m,Qt.prototype.close=Qt.prototype.close,dg=function(){return new ur},ug=function(){return nr()},hg=Sn,Ja={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},ir.NO_ERROR=0,ir.TIMEOUT=8,ir.HTTP_ERROR=6,Mr=ir,oh.COMPLETE="complete",lg=oh,eh.EventType=zi,zi.OPEN="a",zi.CLOSE="b",zi.ERROR="c",zi.MESSAGE="d",Nt.prototype.listen=Nt.prototype.J,hs=eh,mt.prototype.listenOnce=mt.prototype.K,mt.prototype.getLastError=mt.prototype.Ha,mt.prototype.getLastErrorCode=mt.prototype.ya,mt.prototype.getStatus=mt.prototype.ca,mt.prototype.getResponseJson=mt.prototype.La,mt.prototype.getResponseText=mt.prototype.la,mt.prototype.send=mt.prototype.ea,mt.prototype.setWithCredentials=mt.prototype.Fa,cg=mt}).apply(typeof fr<"u"?fr:typeof self<"u"?self:typeof window<"u"?window:{});const iu="@firebase/firestore",su="4.9.2";class Bt{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}}Bt.UNAUTHENTICATED=new Bt(null),Bt.GOOGLE_CREDENTIALS=new Bt("google-credentials-uid"),Bt.FIRST_PARTY=new Bt("first-party-uid"),Bt.MOCK_USER=new Bt("mock-user");let Oi="12.3.0";const $n=new kc("@firebase/firestore");function ci(){return $n.logLevel}function U(n,...t){if($n.logLevel<=X.DEBUG){const e=t.map(Vc);$n.debug(`Firestore (${Oi}): ${n}`,...e)}}function Le(n,...t){if($n.logLevel<=X.ERROR){const e=t.map(Vc);$n.error(`Firestore (${Oi}): ${n}`,...e)}}function vi(n,...t){if($n.logLevel<=X.WARN){const e=t.map(Vc);$n.warn(`Firestore (${Oi}): ${n}`,...e)}}function Vc(n){if(typeof n=="string")return n;try{return(function(e){return JSON.stringify(e)})(n)}catch{return n}}function j(n,t,e){let i="Unexpected state";typeof t=="string"?i=t:e=t,fg(n,i,e)}function fg(n,t,e){let i=`FIRESTORE (${Oi}) INTERNAL ASSERTION FAILED: ${t} (ID: ${n.toString(16)})`;if(e!==void 0)try{i+=" CONTEXT: "+JSON.stringify(e)}catch{i+=" CONTEXT: "+e}throw Le(i),new Error(i)}function nt(n,t,e,i){let s="Unexpected state";typeof e=="string"?s=e:i=e,n||fg(t,s,i)}function q(n,t){return n}const O={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class B extends Ue{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class un{constructor(){this.promise=new Promise(((t,e)=>{this.resolve=t,this.reject=e}))}}class gg{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}}class Pb{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable((()=>e(Bt.UNAUTHENTICATED)))}shutdown(){}}class Rb{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable((()=>e(this.token.user)))}shutdown(){this.changeListener=null}}class Cb{constructor(t){this.t=t,this.currentUser=Bt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){nt(this.o===void 0,42304);let i=this.i;const s=c=>this.i!==i?(i=this.i,e(c)):Promise.resolve();let r=new un;this.o=()=>{this.i++,this.currentUser=this.u(),r.resolve(),r=new un,t.enqueueRetryable((()=>s(this.currentUser)))};const o=()=>{const c=r;t.enqueueRetryable((async()=>{await c.promise,await s(this.currentUser)}))},a=c=>{U("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((c=>a(c))),setTimeout((()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?a(c):(U("FirebaseAuthCredentialsProvider","Auth not yet detected"),r.resolve(),r=new un)}}),0),o()}getToken(){const t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then((i=>this.i!==t?(U("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(nt(typeof i.accessToken=="string",31837,{l:i}),new gg(i.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const t=this.auth&&this.auth.getUid();return nt(t===null||typeof t=="string",2055,{h:t}),new Bt(t)}}class kb{constructor(t,e,i){this.P=t,this.T=e,this.I=i,this.type="FirstParty",this.user=Bt.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const t=this.R();return t&&this.A.set("Authorization",t),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Db{constructor(t,e,i){this.P=t,this.T=e,this.I=i}getToken(){return Promise.resolve(new kb(this.P,this.T,this.I))}start(t,e){t.enqueueRetryable((()=>e(Bt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class ru{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Mb{constructor(t,e){this.V=e,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,se(t)&&t.settings.appCheckToken&&(this.p=t.settings.appCheckToken)}start(t,e){nt(this.o===void 0,3512);const i=r=>{r.error!=null&&U("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${r.error.message}`);const o=r.token!==this.m;return this.m=r.token,U("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(r.token):Promise.resolve()};this.o=r=>{t.enqueueRetryable((()=>i(r)))};const s=r=>{U("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=r,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((r=>s(r))),setTimeout((()=>{if(!this.appCheck){const r=this.V.getImmediate({optional:!0});r?s(r):U("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new ru(this.p));const t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((e=>e?(nt(typeof e.token=="string",44558,{tokenResult:e}),this.m=e.token,new ru(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function Ob(n){const t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}class Nc{static newId(){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=62*Math.floor(4.129032258064516);let i="";for(;i.length<20;){const s=Ob(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<e&&(i+=t.charAt(s[r]%62))}return i}}function Q(n,t){return n<t?-1:n>t?1:0}function Za(n,t){const e=Math.min(n.length,t.length);for(let i=0;i<e;i++){const s=n.charAt(i),r=t.charAt(i);if(s!==r)return Ea(s)===Ea(r)?Q(s,r):Ea(s)?1:-1}return Q(n.length,t.length)}const Vb=55296,Nb=57343;function Ea(n){const t=n.charCodeAt(0);return t>=Vb&&t<=Nb}function wi(n,t,e){return n.length===t.length&&n.every(((i,s)=>e(i,t[s])))}const ou="__name__";class fe{constructor(t,e,i){e===void 0?e=0:e>t.length&&j(637,{offset:e,range:t.length}),i===void 0?i=t.length-e:i>t.length-e&&j(1746,{length:i,range:t.length-e}),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return fe.comparator(this,t)===0}child(t){const e=this.segments.slice(this.offset,this.limit());return t instanceof fe?t.forEach((i=>{e.push(i)})):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){const i=Math.min(t.length,e.length);for(let s=0;s<i;s++){const r=fe.compareSegments(t.get(s),e.get(s));if(r!==0)return r}return Q(t.length,e.length)}static compareSegments(t,e){const i=fe.isNumericId(t),s=fe.isNumericId(e);return i&&!s?-1:!i&&s?1:i&&s?fe.extractNumericId(t).compare(fe.extractNumericId(e)):Za(t,e)}static isNumericId(t){return t.startsWith("__id")&&t.endsWith("__")}static extractNumericId(t){return hn.fromString(t.substring(4,t.length-2))}}class ct extends fe{construct(t,e,i){return new ct(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){const e=[];for(const i of t){if(i.indexOf("//")>=0)throw new B(O.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((s=>s.length>0)))}return new ct(e)}static emptyPath(){return new ct([])}}const Lb=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends fe{construct(t,e,i){return new Dt(t,e,i)}static isValidIdentifier(t){return Lb.test(t)}canonicalString(){return this.toArray().map((t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(t)||(t="`"+t+"`"),t))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ou}static keyField(){return new Dt([ou])}static fromServerFormat(t){const e=[];let i="",s=0;const r=()=>{if(i.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""};let o=!1;for(;s<t.length;){const a=t[s];if(a==="\\"){if(s+1===t.length)throw new B(O.INVALID_ARGUMENT,"Path has trailing escape character: "+t);const c=t[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new B(O.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,s+=2}else a==="`"?(o=!o,s++):a!=="."||o?(i+=a,s++):(r(),s++)}if(r(),o)throw new B(O.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new Dt(e)}static emptyPath(){return new Dt([])}}class z{constructor(t){this.path=t}static fromPath(t){return new z(ct.fromString(t))}static fromName(t){return new z(ct.fromString(t).popFirst(5))}static empty(){return new z(ct.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&ct.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return ct.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new z(new ct(t.slice()))}}function pg(n,t,e){if(!e)throw new B(O.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function Fb(n,t,e,i){if(t===!0&&i===!0)throw new B(O.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function au(n){if(!z.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function cu(n){if(z.isDocumentKey(n))throw new B(O.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function mg(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function wo(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const t=(function(i){return i.constructor?i.constructor.name:null})(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":j(12329,{type:typeof n})}function qn(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new B(O.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const e=wo(n);throw new B(O.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function Et(n,t){const e={typeString:n};return t&&(e.value=t),e}function Hs(n,t){if(!mg(n))throw new B(O.INVALID_ARGUMENT,"JSON must be an object");let e;for(const i in t)if(t[i]){const s=t[i].typeString,r="value"in t[i]?{value:t[i].value}:void 0;if(!(i in n)){e=`JSON missing required field: '${i}'`;break}const o=n[i];if(s&&typeof o!==s){e=`JSON field '${i}' must be a ${s}.`;break}if(r!==void 0&&o!==r.value){e=`Expected '${i}' field to equal '${r.value}'`;break}}if(e)throw new B(O.INVALID_ARGUMENT,e);return!0}const lu=-62135596800,hu=1e6;class ht{static now(){return ht.fromMillis(Date.now())}static fromDate(t){return ht.fromMillis(t.getTime())}static fromMillis(t){const e=Math.floor(t/1e3),i=Math.floor((t-1e3*e)*hu);return new ht(e,i)}constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new B(O.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<lu)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new B(O.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/hu}_compareTo(t){return this.seconds===t.seconds?Q(this.nanoseconds,t.nanoseconds):Q(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ht._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(t){if(Hs(t,ht._jsonSchema))return new ht(t.seconds,t.nanoseconds)}valueOf(){const t=this.seconds-lu;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ht._jsonSchemaVersion="firestore/timestamp/1.0",ht._jsonSchema={type:Et("string",ht._jsonSchemaVersion),seconds:Et("number"),nanoseconds:Et("number")};class W{static fromTimestamp(t){return new W(t)}static min(){return new W(new ht(0,0))}static max(){return new W(new ht(253402300799,999999999))}constructor(t){this.timestamp=t}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Ps=-1;function Bb(n,t){const e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,s=W.fromTimestamp(i===1e9?new ht(e+1,0):new ht(e,i));return new gn(s,z.empty(),t)}function Ub(n){return new gn(n.readTime,n.key,Ps)}class gn{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new gn(W.min(),z.empty(),Ps)}static max(){return new gn(W.max(),z.empty(),Ps)}}function zb(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=z.comparator(n.documentKey,t.documentKey),e!==0?e:Q(n.largestBatchId,t.largestBatchId))}const jb="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Hb{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((t=>t()))}}async function Vi(n){if(n.code!==O.FAILED_PRECONDITION||n.message!==jb)throw n;U("LocalStore","Unexpectedly lost primary lease")}class N{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&j(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new N(((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(t,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(e,r).next(i,s)}}))}toPromise(){return new Promise(((t,e)=>{this.next(t,e)}))}wrapUserFunction(t){try{const e=t();return e instanceof N?e:N.resolve(e)}catch(e){return N.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction((()=>t(e))):N.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction((()=>t(e))):N.reject(e)}static resolve(t){return new N(((e,i)=>{e(t)}))}static reject(t){return new N(((e,i)=>{i(t)}))}static waitFor(t){return new N(((e,i)=>{let s=0,r=0,o=!1;t.forEach((a=>{++s,a.next((()=>{++r,o&&r===s&&e()}),(c=>i(c)))})),o=!0,r===s&&e()}))}static or(t){let e=N.resolve(!1);for(const i of t)e=e.next((s=>s?N.resolve(s):i()));return e}static forEach(t,e){const i=[];return t.forEach(((s,r)=>{i.push(e.call(this,s,r))})),this.waitFor(i)}static mapArray(t,e){return new N(((i,s)=>{const r=t.length,o=new Array(r);let a=0;for(let c=0;c<r;c++){const h=c;e(t[h]).next((u=>{o[h]=u,++a,a===r&&i(o)}),(u=>s(u)))}}))}static doWhile(t,e){return new N(((i,s)=>{const r=()=>{t()===!0?e().next((()=>{r()}),s):i()};r()}))}}function Wb(n){const t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}function Ni(n){return n.name==="IndexedDbTransactionError"}class To{constructor(t,e){this.previousValue=t,e&&(e.sequenceNumberHandler=i=>this.ae(i),this.ue=i=>e.writeSequenceNumber(i))}ae(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.ue&&this.ue(t),t}}To.ce=-1;const Lc=-1;function Eo(n){return n==null}function Gr(n){return n===0&&1/n==-1/0}function $b(n){return typeof n=="number"&&Number.isInteger(n)&&!Gr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}const _g="";function qb(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=uu(t)),t=Gb(n.get(e),t);return uu(t)}function Gb(n,t){let e=t;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":e+="";break;case _g:e+="";break;default:e+=r}}return e}function uu(n){return n+_g+""}function du(n){let t=0;for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function Tn(n,t){for(const e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function yg(n){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}class pt{constructor(t,e){this.comparator=t,this.root=e||kt.EMPTY}insert(t,e){return new pt(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,kt.BLACK,null,null))}remove(t){return new pt(this.comparator,this.root.remove(t,this.comparator).copy(null,null,kt.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){const i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(t,i.key);if(s===0)return e+i.left.size;s<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal(((e,i)=>(t(e,i),!1)))}toString(){const t=[];return this.inorderTraversal(((e,i)=>(t.push(`${e}:${i}`),!1))),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new gr(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new gr(this.root,t,this.comparator,!1)}getReverseIterator(){return new gr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new gr(this.root,t,this.comparator,!0)}}class gr{constructor(t,e,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!t.isEmpty();)if(r=e?i(t.key,e):1,e&&s&&(r*=-1),r<0)t=this.isReverse?t.left:t.right;else{if(r===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop();const e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}}class kt{constructor(t,e,i,s,r){this.key=t,this.value=e,this.color=i??kt.RED,this.left=s??kt.EMPTY,this.right=r??kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,s,r){return new kt(t??this.key,e??this.value,i??this.color,s??this.left,r??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let s=this;const r=i(t,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(t,e,i),null):r===0?s.copy(null,e,null,null,null):s.copy(null,null,null,null,s.right.insert(t,e,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return kt.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,s=this;if(e(t,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(t,e),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),e(t,s.key)===0){if(s.right.isEmpty())return kt.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(t,e))}return s.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){const t=this.copy(null,null,kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){const t=this.copy(null,null,kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){const t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){const t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw j(43730,{key:this.key,value:this.value});if(this.right.isRed())throw j(14113,{key:this.key,value:this.value});const t=this.left.check();if(t!==this.right.check())throw j(27949);return t+(this.isRed()?0:1)}}kt.EMPTY=null,kt.RED=!0,kt.BLACK=!1;kt.EMPTY=new class{constructor(){this.size=0}get key(){throw j(57766)}get value(){throw j(16141)}get color(){throw j(16727)}get left(){throw j(29726)}get right(){throw j(36894)}copy(t,e,i,s,r){return this}insert(t,e,i){return new kt(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class St{constructor(t){this.comparator=t,this.data=new pt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal(((e,i)=>(t(e),!1)))}forEachInRange(t,e){const i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,t[1])>=0)return;e(s.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){const e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new fu(this.data.getIterator())}getIteratorFrom(t){return new fu(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach((i=>{e=e.add(i)})),e}isEqual(t){if(!(t instanceof St)||this.size!==t.size)return!1;const e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(this.comparator(s,r)!==0)return!1}return!0}toArray(){const t=[];return this.forEach((e=>{t.push(e)})),t}toString(){const t=[];return this.forEach((e=>t.push(e))),"SortedSet("+t.toString()+")"}copy(t){const e=new St(this.comparator);return e.data=t,e}}class fu{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Zt{constructor(t){this.fields=t,t.sort(Dt.comparator)}static empty(){return new Zt([])}unionWith(t){let e=new St(Dt.comparator);for(const i of this.fields)e=e.add(i);for(const i of t)e=e.add(i);return new Zt(e.toArray())}covers(t){for(const e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return wi(this.fields,t.fields,((e,i)=>e.isEqual(i)))}}class bg extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ot{constructor(t){this.binaryString=t}static fromBase64String(t){const e=(function(s){try{return atob(s)}catch(r){throw typeof DOMException<"u"&&r instanceof DOMException?new bg("Invalid base64 string: "+r):r}})(t);return new Ot(e)}static fromUint8Array(t){const e=(function(s){let r="";for(let o=0;o<s.length;++o)r+=String.fromCharCode(s[o]);return r})(t);return new Ot(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(e){return btoa(e)})(this.binaryString)}toUint8Array(){return(function(e){const i=new Uint8Array(e.length);for(let s=0;s<e.length;s++)i[s]=e.charCodeAt(s);return i})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return Q(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}}Ot.EMPTY_BYTE_STRING=new Ot("");const Kb=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(n){if(nt(!!n,39018),typeof n=="string"){let t=0;const e=Kb.exec(n);if(nt(!!e,46558,{timestamp:n}),e[1]){let s=e[1];s=(s+"000000000").substr(0,9),t=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:bt(n.seconds),nanos:bt(n.nanos)}}function bt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function mn(n){return typeof n=="string"?Ot.fromBase64String(n):Ot.fromUint8Array(n)}const vg="server_timestamp",wg="__type__",Tg="__previous_value__",Eg="__local_write_time__";function Fc(n){return(n?.mapValue?.fields||{})[wg]?.stringValue===vg}function Io(n){const t=n.mapValue.fields[Tg];return Fc(t)?Io(t):t}function Rs(n){const t=pn(n.mapValue.fields[Eg].timestampValue);return new ht(t.seconds,t.nanos)}class Yb{constructor(t,e,i,s,r,o,a,c,h,u){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=h,this.isUsingEmulator=u}}const Kr="(default)";class Cs{constructor(t,e){this.projectId=t,this.database=e||Kr}static empty(){return new Cs("","")}get isDefaultDatabase(){return this.database===Kr}isEqual(t){return t instanceof Cs&&t.projectId===this.projectId&&t.database===this.database}}const Ig="__type__",Xb="__max__",pr={mapValue:{}},Ag="__vector__",Yr="value";function _n(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Fc(n)?4:Jb(n)?9007199254740991:Qb(n)?10:11:j(28295,{value:n})}function we(n,t){if(n===t)return!0;const e=_n(n);if(e!==_n(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Rs(n).isEqual(Rs(t));case 3:return(function(s,r){if(typeof s.timestampValue=="string"&&typeof r.timestampValue=="string"&&s.timestampValue.length===r.timestampValue.length)return s.timestampValue===r.timestampValue;const o=pn(s.timestampValue),a=pn(r.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos})(n,t);case 5:return n.stringValue===t.stringValue;case 6:return(function(s,r){return mn(s.bytesValue).isEqual(mn(r.bytesValue))})(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return(function(s,r){return bt(s.geoPointValue.latitude)===bt(r.geoPointValue.latitude)&&bt(s.geoPointValue.longitude)===bt(r.geoPointValue.longitude)})(n,t);case 2:return(function(s,r){if("integerValue"in s&&"integerValue"in r)return bt(s.integerValue)===bt(r.integerValue);if("doubleValue"in s&&"doubleValue"in r){const o=bt(s.doubleValue),a=bt(r.doubleValue);return o===a?Gr(o)===Gr(a):isNaN(o)&&isNaN(a)}return!1})(n,t);case 9:return wi(n.arrayValue.values||[],t.arrayValue.values||[],we);case 10:case 11:return(function(s,r){const o=s.mapValue.fields||{},a=r.mapValue.fields||{};if(du(o)!==du(a))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!we(o[c],a[c])))return!1;return!0})(n,t);default:return j(52216,{left:n})}}function ks(n,t){return(n.values||[]).find((e=>we(e,t)))!==void 0}function Ti(n,t){if(n===t)return 0;const e=_n(n),i=_n(t);if(e!==i)return Q(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return Q(n.booleanValue,t.booleanValue);case 2:return(function(r,o){const a=bt(r.integerValue||r.doubleValue),c=bt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1})(n,t);case 3:return gu(n.timestampValue,t.timestampValue);case 4:return gu(Rs(n),Rs(t));case 5:return Za(n.stringValue,t.stringValue);case 6:return(function(r,o){const a=mn(r),c=mn(o);return a.compareTo(c)})(n.bytesValue,t.bytesValue);case 7:return(function(r,o){const a=r.split("/"),c=o.split("/");for(let h=0;h<a.length&&h<c.length;h++){const u=Q(a[h],c[h]);if(u!==0)return u}return Q(a.length,c.length)})(n.referenceValue,t.referenceValue);case 8:return(function(r,o){const a=Q(bt(r.latitude),bt(o.latitude));return a!==0?a:Q(bt(r.longitude),bt(o.longitude))})(n.geoPointValue,t.geoPointValue);case 9:return pu(n.arrayValue,t.arrayValue);case 10:return(function(r,o){const a=r.fields||{},c=o.fields||{},h=a[Yr]?.arrayValue,u=c[Yr]?.arrayValue,d=Q(h?.values?.length||0,u?.values?.length||0);return d!==0?d:pu(h,u)})(n.mapValue,t.mapValue);case 11:return(function(r,o){if(r===pr.mapValue&&o===pr.mapValue)return 0;if(r===pr.mapValue)return 1;if(o===pr.mapValue)return-1;const a=r.fields||{},c=Object.keys(a),h=o.fields||{},u=Object.keys(h);c.sort(),u.sort();for(let d=0;d<c.length&&d<u.length;++d){const g=Za(c[d],u[d]);if(g!==0)return g;const m=Ti(a[c[d]],h[u[d]]);if(m!==0)return m}return Q(c.length,u.length)})(n.mapValue,t.mapValue);default:throw j(23264,{he:e})}}function gu(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return Q(n,t);const e=pn(n),i=pn(t),s=Q(e.seconds,i.seconds);return s!==0?s:Q(e.nanos,i.nanos)}function pu(n,t){const e=n.values||[],i=t.values||[];for(let s=0;s<e.length&&s<i.length;++s){const r=Ti(e[s],i[s]);if(r)return r}return Q(e.length,i.length)}function Ei(n){return tc(n)}function tc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(e){const i=pn(e);return`time(${i.seconds},${i.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(e){return mn(e).toBase64()})(n.bytesValue):"referenceValue"in n?(function(e){return z.fromName(e).toString()})(n.referenceValue):"geoPointValue"in n?(function(e){return`geo(${e.latitude},${e.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(e){let i="[",s=!0;for(const r of e.values||[])s?s=!1:i+=",",i+=tc(r);return i+"]"})(n.arrayValue):"mapValue"in n?(function(e){const i=Object.keys(e.fields||{}).sort();let s="{",r=!0;for(const o of i)r?r=!1:s+=",",s+=`${o}:${tc(e.fields[o])}`;return s+"}"})(n.mapValue):j(61005,{value:n})}function Or(n){switch(_n(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Io(n);return t?16+Or(t):16;case 5:return 2*n.stringValue.length;case 6:return mn(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(i){return(i.values||[]).reduce(((s,r)=>s+Or(r)),0)})(n.arrayValue);case 10:case 11:return(function(i){let s=0;return Tn(i.fields,((r,o)=>{s+=r.length+Or(o)})),s})(n.mapValue);default:throw j(13486,{value:n})}}function mu(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function ec(n){return!!n&&"integerValue"in n}function Bc(n){return!!n&&"arrayValue"in n}function _u(n){return!!n&&"nullValue"in n}function yu(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Vr(n){return!!n&&"mapValue"in n}function Qb(n){return(n?.mapValue?.fields||{})[Ig]?.stringValue===Ag}function ys(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){const t={mapValue:{fields:{}}};return Tn(n.mapValue.fields,((e,i)=>t.mapValue.fields[e]=ys(i))),t}if(n.arrayValue){const t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ys(n.arrayValue.values[e]);return t}return{...n}}function Jb(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===Xb}class Yt{constructor(t){this.value=t}static empty(){return new Yt({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Vr(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ys(e)}setAll(t){let e=Dt.emptyPath(),i={},s=[];t.forEach(((o,a)=>{if(!e.isImmediateParentOf(a)){const c=this.getFieldsMap(e);this.applyChanges(c,i,s),i={},s=[],e=a.popLast()}o?i[a.lastSegment()]=ys(o):s.push(a.lastSegment())}));const r=this.getFieldsMap(e);this.applyChanges(r,i,s)}delete(t){const e=this.field(t.popLast());Vr(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return we(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let s=e.mapValue.fields[t.get(i)];Vr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=s),e=s}return e.mapValue.fields}applyChanges(t,e,i){Tn(e,((s,r)=>t[s]=r));for(const s of i)delete t[s]}clone(){return new Yt(ys(this.value))}}function xg(n){const t=[];return Tn(n.fields,((e,i)=>{const s=new Dt([e]);if(Vr(i)){const r=xg(i.mapValue).fields;if(r.length===0)t.push(s);else for(const o of r)t.push(s.child(o))}else t.push(s)})),new Zt(t)}class zt{constructor(t,e,i,s,r,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=s,this.createTime=r,this.data=o,this.documentState=a}static newInvalidDocument(t){return new zt(t,0,W.min(),W.min(),W.min(),Yt.empty(),0)}static newFoundDocument(t,e,i,s){return new zt(t,1,e,W.min(),i,s,0)}static newNoDocument(t,e){return new zt(t,2,e,W.min(),W.min(),Yt.empty(),0)}static newUnknownDocument(t,e){return new zt(t,3,e,W.min(),W.min(),Yt.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(W.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Yt.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Yt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=W.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof zt&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new zt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Xr{constructor(t,e){this.position=t,this.inclusive=e}}function bu(n,t,e){let i=0;for(let s=0;s<n.position.length;s++){const r=t[s],o=n.position[s];if(r.field.isKeyField()?i=z.comparator(z.fromName(o.referenceValue),e.key):i=Ti(o,e.data.field(r.field)),r.dir==="desc"&&(i*=-1),i!==0)break}return i}function vu(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!we(n.position[e],t.position[e]))return!1;return!0}class Ds{constructor(t,e="asc"){this.field=t,this.dir=e}}function Zb(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}class Sg{}class Tt extends Sg{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new ev(t,e,i):e==="array-contains"?new sv(t,i):e==="in"?new rv(t,i):e==="not-in"?new ov(t,i):e==="array-contains-any"?new av(t,i):new Tt(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new nv(t,i):new iv(t,i)}matches(t){const e=t.data.field(this.field);return this.op==="!="?e!==null&&e.nullValue===void 0&&this.matchesComparison(Ti(e,this.value)):e!==null&&_n(this.value)===_n(e)&&this.matchesComparison(Ti(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return j(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ce extends Sg{constructor(t,e){super(),this.filters=t,this.op=e,this.Pe=null}static create(t,e){return new ce(t,e)}matches(t){return Pg(this)?this.filters.find((e=>!e.matches(t)))===void 0:this.filters.find((e=>e.matches(t)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((t,e)=>t.concat(e.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function Pg(n){return n.op==="and"}function Rg(n){return tv(n)&&Pg(n)}function tv(n){for(const t of n.filters)if(t instanceof ce)return!1;return!0}function nc(n){if(n instanceof Tt)return n.field.canonicalString()+n.op.toString()+Ei(n.value);if(Rg(n))return n.filters.map((t=>nc(t))).join(",");{const t=n.filters.map((e=>nc(e))).join(",");return`${n.op}(${t})`}}function Cg(n,t){return n instanceof Tt?(function(i,s){return s instanceof Tt&&i.op===s.op&&i.field.isEqual(s.field)&&we(i.value,s.value)})(n,t):n instanceof ce?(function(i,s){return s instanceof ce&&i.op===s.op&&i.filters.length===s.filters.length?i.filters.reduce(((r,o,a)=>r&&Cg(o,s.filters[a])),!0):!1})(n,t):void j(19439)}function kg(n){return n instanceof Tt?(function(e){return`${e.field.canonicalString()} ${e.op} ${Ei(e.value)}`})(n):n instanceof ce?(function(e){return e.op.toString()+" {"+e.getFilters().map(kg).join(" ,")+"}"})(n):"Filter"}class ev extends Tt{constructor(t,e,i){super(t,e,i),this.key=z.fromName(i.referenceValue)}matches(t){const e=z.comparator(t.key,this.key);return this.matchesComparison(e)}}class nv extends Tt{constructor(t,e){super(t,"in",e),this.keys=Dg("in",e)}matches(t){return this.keys.some((e=>e.isEqual(t.key)))}}class iv extends Tt{constructor(t,e){super(t,"not-in",e),this.keys=Dg("not-in",e)}matches(t){return!this.keys.some((e=>e.isEqual(t.key)))}}function Dg(n,t){return(t.arrayValue?.values||[]).map((e=>z.fromName(e.referenceValue)))}class sv extends Tt{constructor(t,e){super(t,"array-contains",e)}matches(t){const e=t.data.field(this.field);return Bc(e)&&ks(e.arrayValue,this.value)}}class rv extends Tt{constructor(t,e){super(t,"in",e)}matches(t){const e=t.data.field(this.field);return e!==null&&ks(this.value.arrayValue,e)}}class ov extends Tt{constructor(t,e){super(t,"not-in",e)}matches(t){if(ks(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const e=t.data.field(this.field);return e!==null&&e.nullValue===void 0&&!ks(this.value.arrayValue,e)}}class av extends Tt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){const e=t.data.field(this.field);return!(!Bc(e)||!e.arrayValue.values)&&e.arrayValue.values.some((i=>ks(this.value.arrayValue,i)))}}class cv{constructor(t,e=null,i=[],s=[],r=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=a,this.Te=null}}function wu(n,t=null,e=[],i=[],s=null,r=null,o=null){return new cv(n,t,e,i,s,r,o)}function Uc(n){const t=q(n);if(t.Te===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((i=>nc(i))).join(","),e+="|ob:",e+=t.orderBy.map((i=>(function(r){return r.field.canonicalString()+r.dir})(i))).join(","),Eo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((i=>Ei(i))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((i=>Ei(i))).join(",")),t.Te=e}return t.Te}function zc(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!Zb(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Cg(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!vu(n.startAt,t.startAt)&&vu(n.endAt,t.endAt)}function ic(n){return z.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}class Li{constructor(t,e=null,i=[],s=[],r=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=a,this.endAt=c,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function lv(n,t,e,i,s,r,o,a){return new Li(n,t,e,i,s,r,o,a)}function Mg(n){return new Li(n)}function Tu(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Og(n){return n.collectionGroup!==null}function bs(n){const t=q(n);if(t.Ie===null){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new St(Dt.comparator);return o.filters.forEach((c=>{c.getFlattenedFilters().forEach((h=>{h.isInequality()&&(a=a.add(h.field))}))})),a})(t).forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Ds(r,i))})),e.has(Dt.keyField().canonicalString())||t.Ie.push(new Ds(Dt.keyField(),i))}return t.Ie}function ge(n){const t=q(n);return t.Ee||(t.Ee=hv(t,bs(n))),t.Ee}function hv(n,t){if(n.limitType==="F")return wu(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map((s=>{const r=s.dir==="desc"?"asc":"desc";return new Ds(s.field,r)}));const e=n.endAt?new Xr(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Xr(n.startAt.position,n.startAt.inclusive):null;return wu(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function sc(n,t){const e=n.filters.concat([t]);return new Li(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function rc(n,t,e){return new Li(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function Ao(n,t){return zc(ge(n),ge(t))&&n.limitType===t.limitType}function Vg(n){return`${Uc(ge(n))}|lt:${n.limitType}`}function li(n){return`Query(target=${(function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map((s=>kg(s))).join(", ")}]`),Eo(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map((s=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(s))).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map((s=>Ei(s))).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map((s=>Ei(s))).join(",")),`Target(${i})`})(ge(n))}; limitType=${n.limitType})`}function xo(n,t){return t.isFoundDocument()&&(function(i,s){const r=s.key.path;return i.collectionGroup!==null?s.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(r):z.isDocumentKey(i.path)?i.path.isEqual(r):i.path.isImmediateParentOf(r)})(n,t)&&(function(i,s){for(const r of bs(i))if(!r.field.isKeyField()&&s.data.field(r.field)===null)return!1;return!0})(n,t)&&(function(i,s){for(const r of i.filters)if(!r.matches(s))return!1;return!0})(n,t)&&(function(i,s){return!(i.startAt&&!(function(o,a,c){const h=bu(o,a,c);return o.inclusive?h<=0:h<0})(i.startAt,bs(i),s)||i.endAt&&!(function(o,a,c){const h=bu(o,a,c);return o.inclusive?h>=0:h>0})(i.endAt,bs(i),s))})(n,t)}function uv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Ng(n){return(t,e)=>{let i=!1;for(const s of bs(n)){const r=dv(s,t,e);if(r!==0)return r;i=i||s.field.isKeyField()}return 0}}function dv(n,t,e){const i=n.field.isKeyField()?z.comparator(t.key,e.key):(function(r,o,a){const c=o.data.field(r),h=a.data.field(r);return c!==null&&h!==null?Ti(c,h):j(42886)})(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return j(19790,{direction:n.dir})}}class Qn{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(const[s,r]of i)if(this.equalsFn(s,t))return r}}has(t){return this.get(t)!==void 0}set(t,e){const i=this.mapKeyFn(t),s=this.inner[i];if(s===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],t))return void(s[r]=[t,e]);s.push([t,e]),this.innerSize++}delete(t){const e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],t))return i.length===1?delete this.inner[e]:i.splice(s,1),this.innerSize--,!0;return!1}forEach(t){Tn(this.inner,((e,i)=>{for(const[s,r]of i)t(s,r)}))}isEmpty(){return yg(this.inner)}size(){return this.innerSize}}const fv=new pt(z.comparator);function Fe(){return fv}const Lg=new pt(z.comparator);function us(...n){let t=Lg;for(const e of n)t=t.insert(e.key,e);return t}function Fg(n){let t=Lg;return n.forEach(((e,i)=>t=t.insert(e,i.overlayedDocument))),t}function Bn(){return vs()}function Bg(){return vs()}function vs(){return new Qn((n=>n.toString()),((n,t)=>n.isEqual(t)))}const gv=new pt(z.comparator),pv=new St(z.comparator);function J(...n){let t=pv;for(const e of n)t=t.add(e);return t}const mv=new St(Q);function _v(){return mv}function jc(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gr(t)?"-0":t}}function Ug(n){return{integerValue:""+n}}function yv(n,t){return $b(t)?Ug(t):jc(n,t)}class So{constructor(){this._=void 0}}function bv(n,t,e){return n instanceof Qr?(function(s,r){const o={fields:{[wg]:{stringValue:vg},[Eg]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return r&&Fc(r)&&(r=Io(r)),r&&(o.fields[Tg]=r),{mapValue:o}})(e,t):n instanceof Ii?jg(n,t):n instanceof Ai?Hg(n,t):(function(s,r){const o=zg(s,r),a=Eu(o)+Eu(s.Ae);return ec(o)&&ec(s.Ae)?Ug(a):jc(s.serializer,a)})(n,t)}function vv(n,t,e){return n instanceof Ii?jg(n,t):n instanceof Ai?Hg(n,t):e}function zg(n,t){return n instanceof Jr?(function(i){return ec(i)||(function(r){return!!r&&"doubleValue"in r})(i)})(t)?t:{integerValue:0}:null}class Qr extends So{}class Ii extends So{constructor(t){super(),this.elements=t}}function jg(n,t){const e=Wg(t);for(const i of n.elements)e.some((s=>we(s,i)))||e.push(i);return{arrayValue:{values:e}}}class Ai extends So{constructor(t){super(),this.elements=t}}function Hg(n,t){let e=Wg(t);for(const i of n.elements)e=e.filter((s=>!we(s,i)));return{arrayValue:{values:e}}}class Jr extends So{constructor(t,e){super(),this.serializer=t,this.Ae=e}}function Eu(n){return bt(n.integerValue||n.doubleValue)}function Wg(n){return Bc(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class $g{constructor(t,e){this.field=t,this.transform=e}}function wv(n,t){return n.field.isEqual(t.field)&&(function(i,s){return i instanceof Ii&&s instanceof Ii||i instanceof Ai&&s instanceof Ai?wi(i.elements,s.elements,we):i instanceof Jr&&s instanceof Jr?we(i.Ae,s.Ae):i instanceof Qr&&s instanceof Qr})(n.transform,t.transform)}class Tv{constructor(t,e){this.version=t,this.transformResults=e}}class pe{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new pe}static exists(t){return new pe(void 0,t)}static updateTime(t){return new pe(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}}function Nr(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}class Po{}function qg(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new Kg(n.key,pe.none()):new Ws(n.key,n.data,pe.none());{const e=n.data,i=Yt.empty();let s=new St(Dt.comparator);for(let r of t.fields)if(!s.has(r)){let o=e.field(r);o===null&&r.length>1&&(r=r.popLast(),o=e.field(r)),o===null?i.delete(r):i.set(r,o),s=s.add(r)}return new En(n.key,i,new Zt(s.toArray()),pe.none())}}function Ev(n,t,e){n instanceof Ws?(function(s,r,o){const a=s.value.clone(),c=Au(s.fieldTransforms,r,o.transformResults);a.setAll(c),r.convertToFoundDocument(o.version,a).setHasCommittedMutations()})(n,t,e):n instanceof En?(function(s,r,o){if(!Nr(s.precondition,r))return void r.convertToUnknownDocument(o.version);const a=Au(s.fieldTransforms,r,o.transformResults),c=r.data;c.setAll(Gg(s)),c.setAll(a),r.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,t,e):(function(s,r,o){r.convertToNoDocument(o.version).setHasCommittedMutations()})(0,t,e)}function ws(n,t,e,i){return n instanceof Ws?(function(r,o,a,c){if(!Nr(r.precondition,o))return a;const h=r.value.clone(),u=xu(r.fieldTransforms,c,o);return h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,t,e,i):n instanceof En?(function(r,o,a,c){if(!Nr(r.precondition,o))return a;const h=xu(r.fieldTransforms,c,o),u=o.data;return u.setAll(Gg(r)),u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),a===null?null:a.unionWith(r.fieldMask.fields).unionWith(r.fieldTransforms.map((d=>d.field)))})(n,t,e,i):(function(r,o,a){return Nr(r.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a})(n,t,e)}function Iv(n,t){let e=null;for(const i of n.fieldTransforms){const s=t.data.field(i.field),r=zg(i.transform,s||null);r!=null&&(e===null&&(e=Yt.empty()),e.set(i.field,r))}return e||null}function Iu(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!(function(i,s){return i===void 0&&s===void 0||!(!i||!s)&&wi(i,s,((r,o)=>wv(r,o)))})(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}class Ws extends Po{constructor(t,e,i,s=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class En extends Po{constructor(t,e,i,s,r=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}getFieldMask(){return this.fieldMask}}function Gg(n){const t=new Map;return n.fieldMask.fields.forEach((e=>{if(!e.isEmpty()){const i=n.data.field(e);t.set(e,i)}})),t}function Au(n,t,e){const i=new Map;nt(n.length===e.length,32656,{Re:e.length,Ve:n.length});for(let s=0;s<e.length;s++){const r=n[s],o=r.transform,a=t.data.field(r.field);i.set(r.field,vv(o,a,e[s]))}return i}function xu(n,t,e){const i=new Map;for(const s of n){const r=s.transform,o=e.data.field(s.field);i.set(s.field,bv(r,o,t))}return i}class Kg extends Po{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Av extends Po{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xv{constructor(t,e,i,s){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(t,e){const i=e.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(t.key)&&Ev(r,t,i[s])}}applyToLocalView(t,e){for(const i of this.baseMutations)i.key.isEqual(t.key)&&(e=ws(i,t,e,this.localWriteTime));for(const i of this.mutations)i.key.isEqual(t.key)&&(e=ws(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){const i=Bg();return this.mutations.forEach((s=>{const r=t.get(s.key),o=r.overlayedDocument;let a=this.applyToLocalView(o,r.mutatedFields);a=e.has(s.key)?null:a;const c=qg(o,a);c!==null&&i.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(W.min())})),i}keys(){return this.mutations.reduce(((t,e)=>t.add(e.key)),J())}isEqual(t){return this.batchId===t.batchId&&wi(this.mutations,t.mutations,((e,i)=>Iu(e,i)))&&wi(this.baseMutations,t.baseMutations,((e,i)=>Iu(e,i)))}}class Hc{constructor(t,e,i,s){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=s}static from(t,e,i){nt(t.mutations.length===i.length,58842,{me:t.mutations.length,fe:i.length});let s=(function(){return gv})();const r=t.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new Hc(t,e,i,s)}}class Sv{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}class Pv{constructor(t,e){this.count=t,this.unchangedNames=e}}var wt,tt;function Rv(n){switch(n){case O.OK:return j(64938);case O.CANCELLED:case O.UNKNOWN:case O.DEADLINE_EXCEEDED:case O.RESOURCE_EXHAUSTED:case O.INTERNAL:case O.UNAVAILABLE:case O.UNAUTHENTICATED:return!1;case O.INVALID_ARGUMENT:case O.NOT_FOUND:case O.ALREADY_EXISTS:case O.PERMISSION_DENIED:case O.FAILED_PRECONDITION:case O.ABORTED:case O.OUT_OF_RANGE:case O.UNIMPLEMENTED:case O.DATA_LOSS:return!0;default:return j(15467,{code:n})}}function Yg(n){if(n===void 0)return Le("GRPC error has no .code"),O.UNKNOWN;switch(n){case wt.OK:return O.OK;case wt.CANCELLED:return O.CANCELLED;case wt.UNKNOWN:return O.UNKNOWN;case wt.DEADLINE_EXCEEDED:return O.DEADLINE_EXCEEDED;case wt.RESOURCE_EXHAUSTED:return O.RESOURCE_EXHAUSTED;case wt.INTERNAL:return O.INTERNAL;case wt.UNAVAILABLE:return O.UNAVAILABLE;case wt.UNAUTHENTICATED:return O.UNAUTHENTICATED;case wt.INVALID_ARGUMENT:return O.INVALID_ARGUMENT;case wt.NOT_FOUND:return O.NOT_FOUND;case wt.ALREADY_EXISTS:return O.ALREADY_EXISTS;case wt.PERMISSION_DENIED:return O.PERMISSION_DENIED;case wt.FAILED_PRECONDITION:return O.FAILED_PRECONDITION;case wt.ABORTED:return O.ABORTED;case wt.OUT_OF_RANGE:return O.OUT_OF_RANGE;case wt.UNIMPLEMENTED:return O.UNIMPLEMENTED;case wt.DATA_LOSS:return O.DATA_LOSS;default:return j(39323,{code:n})}}(tt=wt||(wt={}))[tt.OK=0]="OK",tt[tt.CANCELLED=1]="CANCELLED",tt[tt.UNKNOWN=2]="UNKNOWN",tt[tt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",tt[tt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",tt[tt.NOT_FOUND=5]="NOT_FOUND",tt[tt.ALREADY_EXISTS=6]="ALREADY_EXISTS",tt[tt.PERMISSION_DENIED=7]="PERMISSION_DENIED",tt[tt.UNAUTHENTICATED=16]="UNAUTHENTICATED",tt[tt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",tt[tt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",tt[tt.ABORTED=10]="ABORTED",tt[tt.OUT_OF_RANGE=11]="OUT_OF_RANGE",tt[tt.UNIMPLEMENTED=12]="UNIMPLEMENTED",tt[tt.INTERNAL=13]="INTERNAL",tt[tt.UNAVAILABLE=14]="UNAVAILABLE",tt[tt.DATA_LOSS=15]="DATA_LOSS";function Cv(){return new TextEncoder}const kv=new hn([4294967295,4294967295],0);function Su(n){const t=Cv().encode(n),e=new ag;return e.update(t),new Uint8Array(e.digest())}function Pu(n){const t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),r=t.getUint32(12,!0);return[new hn([e,i],0),new hn([s,r],0)]}class Wc{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new ds(`Invalid padding: ${e}`);if(i<0)throw new ds(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new ds(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new ds(`Invalid padding when bitmap length is 0: ${e}`);this.ge=8*t.length-e,this.pe=hn.fromNumber(this.ge)}ye(t,e,i){let s=t.add(e.multiply(hn.fromNumber(i)));return s.compare(kv)===1&&(s=new hn([s.getBits(0),s.getBits(1)],0)),s.modulo(this.pe).toNumber()}we(t){return!!(this.bitmap[Math.floor(t/8)]&1<<t%8)}mightContain(t){if(this.ge===0)return!1;const e=Su(t),[i,s]=Pu(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);if(!this.we(o))return!1}return!0}static create(t,e,i){const s=t%8==0?0:8-t%8,r=new Uint8Array(Math.ceil(t/8)),o=new Wc(r,s,e);return i.forEach((a=>o.insert(a))),o}insert(t){if(this.ge===0)return;const e=Su(t),[i,s]=Pu(e);for(let r=0;r<this.hashCount;r++){const o=this.ye(i,s,r);this.Se(o)}}Se(t){const e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}}class ds extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Ro{constructor(t,e,i,s,r){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(t,e,i){const s=new Map;return s.set(t,$s.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new Ro(W.min(),s,new pt(Q),Fe(),J())}}class $s{constructor(t,e,i,s,r){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new $s(i,e,J(),J(),J())}}class Lr{constructor(t,e,i,s){this.be=t,this.removedTargetIds=e,this.key=i,this.De=s}}class Xg{constructor(t,e){this.targetId=t,this.Ce=e}}class Qg{constructor(t,e,i=Ot.EMPTY_BYTE_STRING,s=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=s}}class Ru{constructor(){this.ve=0,this.Fe=Cu(),this.Me=Ot.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(t){t.approximateByteSize()>0&&(this.Oe=!0,this.Me=t)}ke(){let t=J(),e=J(),i=J();return this.Fe.forEach(((s,r)=>{switch(r){case 0:t=t.add(s);break;case 2:e=e.add(s);break;case 1:i=i.add(s);break;default:j(38017,{changeType:r})}})),new $s(this.Me,this.xe,t,e,i)}qe(){this.Oe=!1,this.Fe=Cu()}Qe(t,e){this.Oe=!0,this.Fe=this.Fe.insert(t,e)}$e(t){this.Oe=!0,this.Fe=this.Fe.remove(t)}Ue(){this.ve+=1}Ke(){this.ve-=1,nt(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Dv{constructor(t){this.Ge=t,this.ze=new Map,this.je=Fe(),this.Je=mr(),this.He=mr(),this.Ye=new pt(Q)}Ze(t){for(const e of t.be)t.De&&t.De.isFoundDocument()?this.Xe(e,t.De):this.et(e,t.key,t.De);for(const e of t.removedTargetIds)this.et(e,t.key,t.De)}tt(t){this.forEachTarget(t,(e=>{const i=this.nt(e);switch(t.state){case 0:this.rt(e)&&i.Le(t.resumeToken);break;case 1:i.Ke(),i.Ne||i.qe(),i.Le(t.resumeToken);break;case 2:i.Ke(),i.Ne||this.removeTarget(e);break;case 3:this.rt(e)&&(i.We(),i.Le(t.resumeToken));break;case 4:this.rt(e)&&(this.it(e),i.Le(t.resumeToken));break;default:j(56790,{state:t.state})}}))}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.ze.forEach(((i,s)=>{this.rt(s)&&e(s)}))}st(t){const e=t.targetId,i=t.Ce.count,s=this.ot(e);if(s){const r=s.target;if(ic(r))if(i===0){const o=new z(r.path);this.et(e,o,zt.newNoDocument(o,W.min()))}else nt(i===1,20013,{expectedCount:i});else{const o=this._t(e);if(o!==i){const a=this.ut(t),c=a?this.ct(a,t,o):1;if(c!==0){this.it(e);const h=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(e,h)}}}}}ut(t){const e=t.Ce.unchangedNames;if(!e||!e.bits)return null;const{bits:{bitmap:i="",padding:s=0},hashCount:r=0}=e;let o,a;try{o=mn(i).toUint8Array()}catch(c){if(c instanceof bg)return vi("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Wc(o,s,r)}catch(c){return vi(c instanceof ds?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.ge===0?null:a}ct(t,e,i){return e.Ce.count===i-this.Pt(t,e.targetId)?0:2}Pt(t,e){const i=this.Ge.getRemoteKeysForTarget(e);let s=0;return i.forEach((r=>{const o=this.Ge.ht(),a=`projects/${o.projectId}/databases/${o.database}/documents/${r.path.canonicalString()}`;t.mightContain(a)||(this.et(e,r,null),s++)})),s}Tt(t){const e=new Map;this.ze.forEach(((r,o)=>{const a=this.ot(o);if(a){if(r.current&&ic(a.target)){const c=new z(a.target.path);this.It(c).has(o)||this.Et(o,c)||this.et(o,c,zt.newNoDocument(c,t))}r.Be&&(e.set(o,r.ke()),r.qe())}}));let i=J();this.He.forEach(((r,o)=>{let a=!0;o.forEachWhile((c=>{const h=this.ot(c);return!h||h.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)})),a&&(i=i.add(r))})),this.je.forEach(((r,o)=>o.setReadTime(t)));const s=new Ro(t,e,this.Ye,this.je,i);return this.je=Fe(),this.Je=mr(),this.He=mr(),this.Ye=new pt(Q),s}Xe(t,e){if(!this.rt(t))return;const i=this.Et(t,e.key)?2:0;this.nt(t).Qe(e.key,i),this.je=this.je.insert(e.key,e),this.Je=this.Je.insert(e.key,this.It(e.key).add(t)),this.He=this.He.insert(e.key,this.dt(e.key).add(t))}et(t,e,i){if(!this.rt(t))return;const s=this.nt(t);this.Et(t,e)?s.Qe(e,1):s.$e(e),this.He=this.He.insert(e,this.dt(e).delete(t)),this.He=this.He.insert(e,this.dt(e).add(t)),i&&(this.je=this.je.insert(e,i))}removeTarget(t){this.ze.delete(t)}_t(t){const e=this.nt(t).ke();return this.Ge.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}Ue(t){this.nt(t).Ue()}nt(t){let e=this.ze.get(t);return e||(e=new Ru,this.ze.set(t,e)),e}dt(t){let e=this.He.get(t);return e||(e=new St(Q),this.He=this.He.insert(t,e)),e}It(t){let e=this.Je.get(t);return e||(e=new St(Q),this.Je=this.Je.insert(t,e)),e}rt(t){const e=this.ot(t)!==null;return e||U("WatchChangeAggregator","Detected inactive target",t),e}ot(t){const e=this.ze.get(t);return e&&e.Ne?null:this.Ge.At(t)}it(t){this.ze.set(t,new Ru),this.Ge.getRemoteKeysForTarget(t).forEach((e=>{this.et(t,e,null)}))}Et(t,e){return this.Ge.getRemoteKeysForTarget(t).has(e)}}function mr(){return new pt(z.comparator)}function Cu(){return new pt(z.comparator)}const Mv={asc:"ASCENDING",desc:"DESCENDING"},Ov={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Vv={and:"AND",or:"OR"};class Nv{constructor(t,e){this.databaseId=t,this.useProto3Json=e}}function oc(n,t){return n.useProto3Json||Eo(t)?t:{value:t}}function Zr(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Jg(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function Lv(n,t){return Zr(n,t.toTimestamp())}function me(n){return nt(!!n,49232),W.fromTimestamp((function(e){const i=pn(e);return new ht(i.seconds,i.nanos)})(n))}function $c(n,t){return ac(n,t).canonicalString()}function ac(n,t){const e=(function(s){return new ct(["projects",s.projectId,"databases",s.database])})(n).child("documents");return t===void 0?e:e.child(t)}function Zg(n){const t=ct.fromString(n);return nt(sp(t),10190,{key:t.toString()}),t}function cc(n,t){return $c(n.databaseId,t.path)}function Ia(n,t){const e=Zg(t);if(e.get(1)!==n.databaseId.projectId)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new B(O.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new z(ep(e))}function tp(n,t){return $c(n.databaseId,t)}function Fv(n){const t=Zg(n);return t.length===4?ct.emptyPath():ep(t)}function lc(n){return new ct(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ep(n){return nt(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function ku(n,t,e){return{name:cc(n,t),fields:e.value.mapValue.fields}}function Bv(n,t){let e;if("targetChange"in t){t.targetChange;const i=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:j(39313,{state:h})})(t.targetChange.targetChangeType||"NO_CHANGE"),s=t.targetChange.targetIds||[],r=(function(h,u){return h.useProto3Json?(nt(u===void 0||typeof u=="string",58123),Ot.fromBase64String(u||"")):(nt(u===void 0||u instanceof Buffer||u instanceof Uint8Array,16193),Ot.fromUint8Array(u||new Uint8Array))})(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&(function(h){const u=h.code===void 0?O.UNKNOWN:Yg(h.code);return new B(u,h.message||"")})(o);e=new Qg(i,s,r,a||null)}else if("documentChange"in t){t.documentChange;const i=t.documentChange;i.document,i.document.name,i.document.updateTime;const s=Ia(n,i.document.name),r=me(i.document.updateTime),o=i.document.createTime?me(i.document.createTime):W.min(),a=new Yt({mapValue:{fields:i.document.fields}}),c=zt.newFoundDocument(s,r,o,a),h=i.targetIds||[],u=i.removedTargetIds||[];e=new Lr(h,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const i=t.documentDelete;i.document;const s=Ia(n,i.document),r=i.readTime?me(i.readTime):W.min(),o=zt.newNoDocument(s,r),a=i.removedTargetIds||[];e=new Lr([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const i=t.documentRemove;i.document;const s=Ia(n,i.document),r=i.removedTargetIds||[];e=new Lr([],r,s,null)}else{if(!("filter"in t))return j(11601,{Rt:t});{t.filter;const i=t.filter;i.targetId;const{count:s=0,unchangedNames:r}=i,o=new Pv(s,r),a=i.targetId;e=new Xg(a,o)}}return e}function Uv(n,t){let e;if(t instanceof Ws)e={update:ku(n,t.key,t.value)};else if(t instanceof Kg)e={delete:cc(n,t.key)};else if(t instanceof En)e={update:ku(n,t.key,t.data),updateMask:Yv(t.fieldMask)};else{if(!(t instanceof Av))return j(16599,{Vt:t.type});e={verify:cc(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map((i=>(function(r,o){const a=o.transform;if(a instanceof Qr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ii)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Jr)return{fieldPath:o.field.canonicalString(),increment:a.Ae};throw j(20930,{transform:o.transform})})(0,i)))),t.precondition.isNone||(e.currentDocument=(function(s,r){return r.updateTime!==void 0?{updateTime:Lv(s,r.updateTime)}:r.exists!==void 0?{exists:r.exists}:j(27497)})(n,t.precondition)),e}function zv(n,t){return n&&n.length>0?(nt(t!==void 0,14353),n.map((e=>(function(s,r){let o=s.updateTime?me(s.updateTime):me(r);return o.isEqual(W.min())&&(o=me(r)),new Tv(o,s.transformResults||[])})(e,t)))):[]}function jv(n,t){return{documents:[tp(n,t.path)]}}function Hv(n,t){const e={structuredQuery:{}},i=t.path;let s;t.collectionGroup!==null?(s=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=tp(n,s);const r=(function(h){if(h.length!==0)return ip(ce.create(h,"and"))})(t.filters);r&&(e.structuredQuery.where=r);const o=(function(h){if(h.length!==0)return h.map((u=>(function(g){return{field:hi(g.field),direction:qv(g.dir)}})(u)))})(t.orderBy);o&&(e.structuredQuery.orderBy=o);const a=oc(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(t.startAt)),t.endAt&&(e.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(t.endAt)),{ft:e,parent:s}}function Wv(n){let t=Fv(n.parent);const e=n.structuredQuery,i=e.from?e.from.length:0;let s=null;if(i>0){nt(i===1,65062);const u=e.from[0];u.allDescendants?s=u.collectionId:t=t.child(u.collectionId)}let r=[];e.where&&(r=(function(d){const g=np(d);return g instanceof ce&&Rg(g)?g.getFilters():[g]})(e.where));let o=[];e.orderBy&&(o=(function(d){return d.map((g=>(function(y){return new Ds(ui(y.field),(function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(y.direction))})(g)))})(e.orderBy));let a=null;e.limit&&(a=(function(d){let g;return g=typeof d=="object"?d.value:d,Eo(g)?null:g})(e.limit));let c=null;e.startAt&&(c=(function(d){const g=!!d.before,m=d.values||[];return new Xr(m,g)})(e.startAt));let h=null;return e.endAt&&(h=(function(d){const g=!d.before,m=d.values||[];return new Xr(m,g)})(e.endAt)),lv(t,s,o,r,a,"F",c,h)}function $v(n,t){const e=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j(28987,{purpose:s})}})(t.purpose);return e==null?null:{"goog-listen-tags":e}}function np(n){return n.unaryFilter!==void 0?(function(e){switch(e.unaryFilter.op){case"IS_NAN":const i=ui(e.unaryFilter.field);return Tt.create(i,"==",{doubleValue:NaN});case"IS_NULL":const s=ui(e.unaryFilter.field);return Tt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ui(e.unaryFilter.field);return Tt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ui(e.unaryFilter.field);return Tt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return j(61313);default:return j(60726)}})(n):n.fieldFilter!==void 0?(function(e){return Tt.create(ui(e.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return j(58110);default:return j(50506)}})(e.fieldFilter.op),e.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(e){return ce.create(e.compositeFilter.filters.map((i=>np(i))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return j(1026)}})(e.compositeFilter.op))})(n):j(30097,{filter:n})}function qv(n){return Mv[n]}function Gv(n){return Ov[n]}function Kv(n){return Vv[n]}function hi(n){return{fieldPath:n.canonicalString()}}function ui(n){return Dt.fromServerFormat(n.fieldPath)}function ip(n){return n instanceof Tt?(function(e){if(e.op==="=="){if(yu(e.value))return{unaryFilter:{field:hi(e.field),op:"IS_NAN"}};if(_u(e.value))return{unaryFilter:{field:hi(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(yu(e.value))return{unaryFilter:{field:hi(e.field),op:"IS_NOT_NAN"}};if(_u(e.value))return{unaryFilter:{field:hi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:hi(e.field),op:Gv(e.op),value:e.value}}})(n):n instanceof ce?(function(e){const i=e.getFilters().map((s=>ip(s)));return i.length===1?i[0]:{compositeFilter:{op:Kv(e.op),filters:i}}})(n):j(54877,{filter:n})}function Yv(n){const t=[];return n.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function sp(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}class en{constructor(t,e,i,s,r=W.min(),o=W.min(),a=Ot.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new en(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new en(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new en(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new en(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}}class Xv{constructor(t){this.yt=t}}function Qv(n){const t=Wv({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?rc(t,t.limit,"L"):t}class Jv{constructor(){this.Cn=new Zv}addToCollectionParentIndex(t,e){return this.Cn.add(e),N.resolve()}getCollectionParents(t,e){return N.resolve(this.Cn.getEntries(e))}addFieldIndex(t,e){return N.resolve()}deleteFieldIndex(t,e){return N.resolve()}deleteAllFieldIndexes(t){return N.resolve()}createTargetIndexes(t,e){return N.resolve()}getDocumentsMatchingTarget(t,e){return N.resolve(null)}getIndexType(t,e){return N.resolve(0)}getFieldIndexes(t,e){return N.resolve([])}getNextCollectionGroupToUpdate(t){return N.resolve(null)}getMinOffset(t,e){return N.resolve(gn.min())}getMinOffsetFromCollectionGroup(t,e){return N.resolve(gn.min())}updateCollectionGroup(t,e,i){return N.resolve()}updateIndexEntries(t,e){return N.resolve()}}class Zv{constructor(){this.index={}}add(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e]||new St(ct.comparator),r=!s.has(i);return this.index[e]=s.add(i),r}has(t){const e=t.lastSegment(),i=t.popLast(),s=this.index[e];return s&&s.has(i)}getEntries(t){return(this.index[t]||new St(ct.comparator)).toArray()}}const Du={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},rp=41943040;class Kt{static withCacheSize(t){return new Kt(t,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}}Kt.DEFAULT_COLLECTION_PERCENTILE=10,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kt.DEFAULT=new Kt(rp,Kt.DEFAULT_COLLECTION_PERCENTILE,Kt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kt.DISABLED=new Kt(-1,0,0);class xi{constructor(t){this.ar=t}next(){return this.ar+=2,this.ar}static ur(){return new xi(0)}static cr(){return new xi(-1)}}const Mu="LruGarbageCollector",tw=1048576;function Ou([n,t],[e,i]){const s=Q(n,e);return s===0?Q(t,i):s}class ew{constructor(t){this.Ir=t,this.buffer=new St(Ou),this.Er=0}dr(){return++this.Er}Ar(t){const e=[t,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(e);else{const i=this.buffer.last();Ou(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}}class nw{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(t){U(Mu,`Garbage collection scheduled in ${t}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ni(e)?U(Mu,"Ignoring IndexedDB error during garbage collection: ",e):await Vi(e)}await this.Vr(3e5)}))}}class iw{constructor(t,e){this.mr=t,this.params=e}calculateTargetCount(t,e){return this.mr.gr(t).next((i=>Math.floor(e/100*i)))}nthSequenceNumber(t,e){if(e===0)return N.resolve(To.ce);const i=new ew(e);return this.mr.forEachTarget(t,(s=>i.Ar(s.sequenceNumber))).next((()=>this.mr.pr(t,(s=>i.Ar(s))))).next((()=>i.maxValue))}removeTargets(t,e,i){return this.mr.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.mr.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(Du)):this.getCacheSize(t).next((i=>i<this.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Du):this.yr(t,e)))}getCacheSize(t){return this.mr.getCacheSize(t)}yr(t,e){let i,s,r,o,a,c,h;const u=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next((d=>(d>this.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),s=this.params.maximumSequenceNumbersToCollect):s=d,o=Date.now(),this.nthSequenceNumber(t,s)))).next((d=>(i=d,a=Date.now(),this.removeTargets(t,i,e)))).next((d=>(r=d,c=Date.now(),this.removeOrphanedDocuments(t,i)))).next((d=>(h=Date.now(),ci()<=X.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-u}ms
	Determined least recently used ${s} in `+(a-o)+`ms
	Removed ${r} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(h-c)+`ms
Total Duration: ${h-u}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:d}))))}}function sw(n,t){return new iw(n,t)}class rw{constructor(){this.changes=new Qn((t=>t.toString()),((t,e)=>t.isEqual(e))),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,zt.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();const i=this.changes.get(e);return i!==void 0?N.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}}class ow{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}}class aw{constructor(t,e,i,s){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=s}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next((s=>(i=s,this.remoteDocumentCache.getEntry(t,e)))).next((s=>(i!==null&&ws(i.mutation,s,Zt.empty(),ht.now()),s)))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.getLocalViewOfDocuments(t,i,J()).next((()=>i))))}getLocalViewOfDocuments(t,e,i=J()){const s=Bn();return this.populateOverlays(t,s,e).next((()=>this.computeViews(t,e,s,i).next((r=>{let o=us();return r.forEach(((a,c)=>{o=o.insert(a,c.overlayedDocument)})),o}))))}getOverlayedDocuments(t,e){const i=Bn();return this.populateOverlays(t,i,e).next((()=>this.computeViews(t,e,i,J())))}populateOverlays(t,e,i){const s=[];return i.forEach((r=>{e.has(r)||s.push(r)})),this.documentOverlayCache.getOverlays(t,s).next((r=>{r.forEach(((o,a)=>{e.set(o,a)}))}))}computeViews(t,e,i,s){let r=Fe();const o=vs(),a=(function(){return vs()})();return e.forEach(((c,h)=>{const u=i.get(h.key);s.has(h.key)&&(u===void 0||u.mutation instanceof En)?r=r.insert(h.key,h):u!==void 0?(o.set(h.key,u.mutation.getFieldMask()),ws(u.mutation,h,u.mutation.getFieldMask(),ht.now())):o.set(h.key,Zt.empty())})),this.recalculateAndSaveOverlays(t,r).next((c=>(c.forEach(((h,u)=>o.set(h,u))),e.forEach(((h,u)=>a.set(h,new ow(u,o.get(h)??null)))),a)))}recalculateAndSaveOverlays(t,e){const i=vs();let s=new pt(((o,a)=>o-a)),r=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next((o=>{for(const a of o)a.keys().forEach((c=>{const h=e.get(c);if(h===null)return;let u=i.get(c)||Zt.empty();u=a.applyToLocalView(h,u),i.set(c,u);const d=(s.get(a.batchId)||J()).add(c);s=s.insert(a.batchId,d)}))})).next((()=>{const o=[],a=s.getReverseIterator();for(;a.hasNext();){const c=a.getNext(),h=c.key,u=c.value,d=Bg();u.forEach((g=>{if(!r.has(g)){const m=qg(e.get(g),i.get(g));m!==null&&d.set(g,m),r=r.add(g)}})),o.push(this.documentOverlayCache.saveOverlays(t,h,d))}return N.waitFor(o)})).next((()=>i))}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next((i=>this.recalculateAndSaveOverlays(t,i)))}getDocumentsMatchingQuery(t,e,i,s){return(function(o){return z.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):Og(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,s):this.getDocumentsMatchingCollectionQuery(t,e,i,s)}getNextDocuments(t,e,i,s){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,s).next((r=>{const o=s-r.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,s-r.size):N.resolve(Bn());let a=Ps,c=r;return o.next((h=>N.forEach(h,((u,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),r.get(u)?N.resolve():this.remoteDocumentCache.getEntry(t,u).next((g=>{c=c.insert(u,g)}))))).next((()=>this.populateOverlays(t,h,r))).next((()=>this.computeViews(t,c,h,J()))).next((u=>({batchId:a,changes:Fg(u)})))))}))}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new z(e)).next((i=>{let s=us();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s}))}getDocumentsMatchingCollectionGroupQuery(t,e,i,s){const r=e.collectionGroup;let o=us();return this.indexManager.getCollectionParents(t,r).next((a=>N.forEach(a,(c=>{const h=(function(d,g){return new Li(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)})(e,c.child(r));return this.getDocumentsMatchingCollectionQuery(t,h,i,s).next((u=>{u.forEach(((d,g)=>{o=o.insert(d,g)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(t,e,i,s){let r;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next((o=>(r=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,r,s)))).next((o=>{r.forEach(((c,h)=>{const u=h.getKey();o.get(u)===null&&(o=o.insert(u,zt.newInvalidDocument(u)))}));let a=us();return o.forEach(((c,h)=>{const u=r.get(c);u!==void 0&&ws(u.mutation,h,Zt.empty(),ht.now()),xo(e,h)&&(a=a.insert(c,h))})),a}))}}class cw{constructor(t){this.serializer=t,this.Lr=new Map,this.kr=new Map}getBundleMetadata(t,e){return N.resolve(this.Lr.get(e))}saveBundleMetadata(t,e){return this.Lr.set(e.id,(function(s){return{id:s.id,version:s.version,createTime:me(s.createTime)}})(e)),N.resolve()}getNamedQuery(t,e){return N.resolve(this.kr.get(e))}saveNamedQuery(t,e){return this.kr.set(e.name,(function(s){return{name:s.name,query:Qv(s.bundledQuery),readTime:me(s.readTime)}})(e)),N.resolve()}}class lw{constructor(){this.overlays=new pt(z.comparator),this.qr=new Map}getOverlay(t,e){return N.resolve(this.overlays.get(e))}getOverlays(t,e){const i=Bn();return N.forEach(e,(s=>this.getOverlay(t,s).next((r=>{r!==null&&i.set(s,r)})))).next((()=>i))}saveOverlays(t,e,i){return i.forEach(((s,r)=>{this.St(t,e,r)})),N.resolve()}removeOverlaysForBatchId(t,e,i){const s=this.qr.get(i);return s!==void 0&&(s.forEach((r=>this.overlays=this.overlays.remove(r))),this.qr.delete(i)),N.resolve()}getOverlaysForCollection(t,e,i){const s=Bn(),r=e.length+1,o=new z(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const c=a.getNext().value,h=c.getKey();if(!e.isPrefixOf(h.path))break;h.path.length===r&&c.largestBatchId>i&&s.set(c.getKey(),c)}return N.resolve(s)}getOverlaysForCollectionGroup(t,e,i,s){let r=new pt(((h,u)=>h-u));const o=this.overlays.getIterator();for(;o.hasNext();){const h=o.getNext().value;if(h.getKey().getCollectionGroup()===e&&h.largestBatchId>i){let u=r.get(h.largestBatchId);u===null&&(u=Bn(),r=r.insert(h.largestBatchId,u)),u.set(h.getKey(),h)}}const a=Bn(),c=r.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach(((h,u)=>a.set(h,u))),!(a.size()>=s)););return N.resolve(a)}St(t,e,i){const s=this.overlays.get(i.key);if(s!==null){const o=this.qr.get(s.largestBatchId).delete(i.key);this.qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new Sv(e,i));let r=this.qr.get(e);r===void 0&&(r=J(),this.qr.set(e,r)),this.qr.set(e,r.add(i.key))}}class hw{constructor(){this.sessionToken=Ot.EMPTY_BYTE_STRING}getSessionToken(t){return N.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,N.resolve()}}class qc{constructor(){this.Qr=new St(Rt.$r),this.Ur=new St(Rt.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(t,e){const i=new Rt(t,e);this.Qr=this.Qr.add(i),this.Ur=this.Ur.add(i)}Wr(t,e){t.forEach((i=>this.addReference(i,e)))}removeReference(t,e){this.Gr(new Rt(t,e))}zr(t,e){t.forEach((i=>this.removeReference(i,e)))}jr(t){const e=new z(new ct([])),i=new Rt(e,t),s=new Rt(e,t+1),r=[];return this.Ur.forEachInRange([i,s],(o=>{this.Gr(o),r.push(o.key)})),r}Jr(){this.Qr.forEach((t=>this.Gr(t)))}Gr(t){this.Qr=this.Qr.delete(t),this.Ur=this.Ur.delete(t)}Hr(t){const e=new z(new ct([])),i=new Rt(e,t),s=new Rt(e,t+1);let r=J();return this.Ur.forEachInRange([i,s],(o=>{r=r.add(o.key)})),r}containsKey(t){const e=new Rt(t,0),i=this.Qr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}}class Rt{constructor(t,e){this.key=t,this.Yr=e}static $r(t,e){return z.comparator(t.key,e.key)||Q(t.Yr,e.Yr)}static Kr(t,e){return Q(t.Yr,e.Yr)||z.comparator(t.key,e.key)}}class uw{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.tr=1,this.Zr=new St(Rt.$r)}checkEmpty(t){return N.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,s){const r=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xv(r,e,i,s);this.mutationQueue.push(o);for(const a of s)this.Zr=this.Zr.add(new Rt(a.key,r)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return N.resolve(o)}lookupMutationBatch(t,e){return N.resolve(this.Xr(e))}getNextMutationBatchAfterBatchId(t,e){const i=e+1,s=this.ei(i),r=s<0?0:s;return N.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(this.mutationQueue.length===0?Lc:this.tr-1)}getAllMutationBatches(t){return N.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){const i=new Rt(e,0),s=new Rt(e,Number.POSITIVE_INFINITY),r=[];return this.Zr.forEachInRange([i,s],(o=>{const a=this.Xr(o.Yr);r.push(a)})),N.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new St(Q);return e.forEach((s=>{const r=new Rt(s,0),o=new Rt(s,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([r,o],(a=>{i=i.add(a.Yr)}))})),N.resolve(this.ti(i))}getAllMutationBatchesAffectingQuery(t,e){const i=e.path,s=i.length+1;let r=i;z.isDocumentKey(r)||(r=r.child(""));const o=new Rt(new z(r),0);let a=new St(Q);return this.Zr.forEachWhile((c=>{const h=c.key.path;return!!i.isPrefixOf(h)&&(h.length===s&&(a=a.add(c.Yr)),!0)}),o),N.resolve(this.ti(a))}ti(t){const e=[];return t.forEach((i=>{const s=this.Xr(i);s!==null&&e.push(s)})),e}removeMutationBatch(t,e){nt(this.ni(e.batchId,"removed")===0,55003),this.mutationQueue.shift();let i=this.Zr;return N.forEach(e.mutations,(s=>{const r=new Rt(s.key,e.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(t,s.key)})).next((()=>{this.Zr=i}))}ir(t){}containsKey(t,e){const i=new Rt(e,0),s=this.Zr.firstAfterOrEqual(i);return N.resolve(e.isEqual(s&&s.key))}performConsistencyCheck(t){return this.mutationQueue.length,N.resolve()}ni(t,e){return this.ei(t)}ei(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Xr(t){const e=this.ei(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}}class dw{constructor(t){this.ri=t,this.docs=(function(){return new pt(z.comparator)})(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){const i=e.key,s=this.docs.get(i),r=s?s.size:0,o=this.ri(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o}),this.size+=o-r,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){const e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){const i=this.docs.get(e);return N.resolve(i?i.document.mutableCopy():zt.newInvalidDocument(e))}getEntries(t,e){let i=Fe();return e.forEach((s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.mutableCopy():zt.newInvalidDocument(s))})),N.resolve(i)}getDocumentsMatchingQuery(t,e,i,s){let r=Fe();const o=e.path,a=new z(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){const{key:h,value:{document:u}}=c.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||zb(Ub(u),i)<=0||(s.has(u.key)||xo(e,u))&&(r=r.insert(u.key,u.mutableCopy()))}return N.resolve(r)}getAllFromCollectionGroup(t,e,i,s){j(9500)}ii(t,e){return N.forEach(this.docs,(i=>e(i)))}newChangeBuffer(t){return new fw(this)}getSize(t){return N.resolve(this.size)}}class fw extends rw{constructor(t){super(),this.Nr=t}applyChanges(t){const e=[];return this.changes.forEach(((i,s)=>{s.isValidDocument()?e.push(this.Nr.addEntry(t,s)):this.Nr.removeEntry(i)})),N.waitFor(e)}getFromCache(t,e){return this.Nr.getEntry(t,e)}getAllFromCache(t,e){return this.Nr.getEntries(t,e)}}class gw{constructor(t){this.persistence=t,this.si=new Qn((e=>Uc(e)),zc),this.lastRemoteSnapshotVersion=W.min(),this.highestTargetId=0,this.oi=0,this._i=new qc,this.targetCount=0,this.ai=xi.ur()}forEachTarget(t,e){return this.si.forEach(((i,s)=>e(s))),N.resolve()}getLastRemoteSnapshotVersion(t){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return N.resolve(this.oi)}allocateTargetId(t){return this.highestTargetId=this.ai.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.oi&&(this.oi=e),N.resolve()}Pr(t){this.si.set(t.target,t);const e=t.targetId;e>this.highestTargetId&&(this.ai=new xi(e),this.highestTargetId=e),t.sequenceNumber>this.oi&&(this.oi=t.sequenceNumber)}addTargetData(t,e){return this.Pr(e),this.targetCount+=1,N.resolve()}updateTargetData(t,e){return this.Pr(e),N.resolve()}removeTargetData(t,e){return this.si.delete(e.target),this._i.jr(e.targetId),this.targetCount-=1,N.resolve()}removeTargets(t,e,i){let s=0;const r=[];return this.si.forEach(((o,a)=>{a.sequenceNumber<=e&&i.get(a.targetId)===null&&(this.si.delete(o),r.push(this.removeMatchingKeysForTargetId(t,a.targetId)),s++)})),N.waitFor(r).next((()=>s))}getTargetCount(t){return N.resolve(this.targetCount)}getTargetData(t,e){const i=this.si.get(e)||null;return N.resolve(i)}addMatchingKeys(t,e,i){return this._i.Wr(e,i),N.resolve()}removeMatchingKeys(t,e,i){this._i.zr(e,i);const s=this.persistence.referenceDelegate,r=[];return s&&e.forEach((o=>{r.push(s.markPotentiallyOrphaned(t,o))})),N.waitFor(r)}removeMatchingKeysForTargetId(t,e){return this._i.jr(e),N.resolve()}getMatchingKeysForTargetId(t,e){const i=this._i.Hr(e);return N.resolve(i)}containsKey(t,e){return N.resolve(this._i.containsKey(e))}}class op{constructor(t,e){this.ui={},this.overlays={},this.ci=new To(0),this.li=!1,this.li=!0,this.hi=new hw,this.referenceDelegate=t(this),this.Pi=new gw(this),this.indexManager=new Jv,this.remoteDocumentCache=(function(s){return new dw(s)})((i=>this.referenceDelegate.Ti(i))),this.serializer=new Xv(e),this.Ii=new cw(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new lw,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.ui[t.toKey()];return i||(i=new uw(e,this.referenceDelegate),this.ui[t.toKey()]=i),i}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(t,e,i){U("MemoryPersistence","Starting transaction:",t);const s=new pw(this.ci.next());return this.referenceDelegate.Ei(),i(s).next((r=>this.referenceDelegate.di(s).next((()=>r)))).toPromise().then((r=>(s.raiseOnCommittedEvent(),r)))}Ai(t,e){return N.or(Object.values(this.ui).map((i=>()=>i.containsKey(t,e))))}}class pw extends Hb{constructor(t){super(),this.currentSequenceNumber=t}}class Gc{constructor(t){this.persistence=t,this.Ri=new qc,this.Vi=null}static mi(t){return new Gc(t)}get fi(){if(this.Vi)return this.Vi;throw j(60996)}addReference(t,e,i){return this.Ri.addReference(i,e),this.fi.delete(i.toString()),N.resolve()}removeReference(t,e,i){return this.Ri.removeReference(i,e),this.fi.add(i.toString()),N.resolve()}markPotentiallyOrphaned(t,e){return this.fi.add(e.toString()),N.resolve()}removeTarget(t,e){this.Ri.jr(e.targetId).forEach((s=>this.fi.add(s.toString())));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next((s=>{s.forEach((r=>this.fi.add(r.toString())))})).next((()=>i.removeTargetData(t,e)))}Ei(){this.Vi=new Set}di(t){const e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.fi,(i=>{const s=z.fromPath(i);return this.gi(t,s).next((r=>{r||e.removeEntry(s,W.min())}))})).next((()=>(this.Vi=null,e.apply(t))))}updateLimboDocument(t,e){return this.gi(t,e).next((i=>{i?this.fi.delete(e.toString()):this.fi.add(e.toString())}))}Ti(t){return 0}gi(t,e){return N.or([()=>N.resolve(this.Ri.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Ai(t,e)])}}class to{constructor(t,e){this.persistence=t,this.pi=new Qn((i=>qb(i.path)),((i,s)=>i.isEqual(s))),this.garbageCollector=sw(this,e)}static mi(t,e){return new to(t,e)}Ei(){}di(t){return N.resolve()}forEachTarget(t,e){return this.persistence.getTargetCache().forEachTarget(t,e)}gr(t){const e=this.wr(t);return this.persistence.getTargetCache().getTargetCount(t).next((i=>e.next((s=>i+s))))}wr(t){let e=0;return this.pr(t,(i=>{e++})).next((()=>e))}pr(t,e){return N.forEach(this.pi,((i,s)=>this.br(t,i,s).next((r=>r?N.resolve():e(s)))))}removeTargets(t,e,i){return this.persistence.getTargetCache().removeTargets(t,e,i)}removeOrphanedDocuments(t,e){let i=0;const s=this.persistence.getRemoteDocumentCache(),r=s.newChangeBuffer();return s.ii(t,(o=>this.br(t,o,e).next((a=>{a||(i++,r.removeEntry(o,W.min()))})))).next((()=>r.apply(t))).next((()=>i))}markPotentiallyOrphaned(t,e){return this.pi.set(e,t.currentSequenceNumber),N.resolve()}removeTarget(t,e){const i=e.withSequenceNumber(t.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(t,i)}addReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),N.resolve()}removeReference(t,e,i){return this.pi.set(i,t.currentSequenceNumber),N.resolve()}updateLimboDocument(t,e){return this.pi.set(e,t.currentSequenceNumber),N.resolve()}Ti(t){let e=t.key.toString().length;return t.isFoundDocument()&&(e+=Or(t.data.value)),e}br(t,e,i){return N.or([()=>this.persistence.Ai(t,e),()=>this.persistence.getTargetCache().containsKey(t,e),()=>{const s=this.pi.get(e);return N.resolve(s!==void 0&&s>i)}])}getCacheSize(t){return this.persistence.getRemoteDocumentCache().getSize(t)}}class Kc{constructor(t,e,i,s){this.targetId=t,this.fromCache=e,this.Es=i,this.ds=s}static As(t,e){let i=J(),s=J();for(const r of e.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new Kc(t,e.fromCache,i,s)}}class mw{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}}class _w{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return cy()?8:Wb(Ht())>0?6:4})()}initialize(t,e){this.ps=t,this.indexManager=e,this.Rs=!0}getDocumentsMatchingQuery(t,e,i,s){const r={result:null};return this.ys(t,e).next((o=>{r.result=o})).next((()=>{if(!r.result)return this.ws(t,e,s,i).next((o=>{r.result=o}))})).next((()=>{if(r.result)return;const o=new mw;return this.Ss(t,e,o).next((a=>{if(r.result=a,this.Vs)return this.bs(t,e,o,a.size)}))})).next((()=>r.result))}bs(t,e,i,s){return i.documentReadCount<this.fs?(ci()<=X.DEBUG&&U("QueryEngine","SDK will not create cache indexes for query:",li(e),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),N.resolve()):(ci()<=X.DEBUG&&U("QueryEngine","Query:",li(e),"scans",i.documentReadCount,"local documents and returns",s,"documents as results."),i.documentReadCount>this.gs*s?(ci()<=X.DEBUG&&U("QueryEngine","The SDK decides to create cache indexes for query:",li(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,ge(e))):N.resolve())}ys(t,e){if(Tu(e))return N.resolve(null);let i=ge(e);return this.indexManager.getIndexType(t,i).next((s=>s===0?null:(e.limit!==null&&s===1&&(e=rc(e,null,"F"),i=ge(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next((r=>{const o=J(...r);return this.ps.getDocuments(t,o).next((a=>this.indexManager.getMinOffset(t,i).next((c=>{const h=this.Ds(e,a);return this.Cs(e,h,o,c.readTime)?this.ys(t,rc(e,null,"F")):this.vs(t,h,e,c)}))))})))))}ws(t,e,i,s){return Tu(e)||s.isEqual(W.min())?N.resolve(null):this.ps.getDocuments(t,i).next((r=>{const o=this.Ds(e,r);return this.Cs(e,o,i,s)?N.resolve(null):(ci()<=X.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),li(e)),this.vs(t,o,e,Bb(s,Ps)).next((a=>a)))}))}Ds(t,e){let i=new St(Ng(t));return e.forEach(((s,r)=>{xo(t,r)&&(i=i.add(r))})),i}Cs(t,e,i,s){if(t.limit===null)return!1;if(i.size!==e.size)return!0;const r=t.limitType==="F"?e.last():e.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Ss(t,e,i){return ci()<=X.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",li(e)),this.ps.getDocumentsMatchingQuery(t,e,gn.min(),i)}vs(t,e,i,s){return this.ps.getDocumentsMatchingQuery(t,i,s).next((r=>(e.forEach((o=>{r=r.insert(o.key,o)})),r)))}}const Yc="LocalStore",yw=3e8;class bw{constructor(t,e,i,s){this.persistence=t,this.Fs=e,this.serializer=s,this.Ms=new pt(Q),this.xs=new Qn((r=>Uc(r)),zc),this.Os=new Map,this.Ns=t.getRemoteDocumentCache(),this.Pi=t.getTargetCache(),this.Ii=t.getBundleCache(),this.Bs(i)}Bs(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new aw(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(e=>t.collect(e,this.Ms)))}}function vw(n,t,e,i){return new bw(n,t,e,i)}async function ap(n,t){const e=q(n);return await e.persistence.runTransaction("Handle user change","readonly",(i=>{let s;return e.mutationQueue.getAllMutationBatches(i).next((r=>(s=r,e.Bs(t),e.mutationQueue.getAllMutationBatches(i)))).next((r=>{const o=[],a=[];let c=J();for(const h of s){o.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}for(const h of r){a.push(h.batchId);for(const u of h.mutations)c=c.add(u.key)}return e.localDocuments.getDocuments(i,c).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:a})))}))}))}function ww(n,t){const e=q(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",(i=>{const s=t.batch.keys(),r=e.Ns.newChangeBuffer({trackRemovals:!0});return(function(a,c,h,u){const d=h.batch,g=d.keys();let m=N.resolve();return g.forEach((y=>{m=m.next((()=>u.getEntry(c,y))).next((v=>{const w=h.docVersions.get(y);nt(w!==null,48541),v.version.compareTo(w)<0&&(d.applyToRemoteDocument(v,h),v.isValidDocument()&&(v.setReadTime(h.commitVersion),u.addEntry(v)))}))})),m.next((()=>a.mutationQueue.removeMutationBatch(c,d)))})(e,i,t,r).next((()=>r.apply(i))).next((()=>e.mutationQueue.performConsistencyCheck(i))).next((()=>e.documentOverlayCache.removeOverlaysForBatchId(i,s,t.batch.batchId))).next((()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,(function(a){let c=J();for(let h=0;h<a.mutationResults.length;++h)a.mutationResults[h].transformResults.length>0&&(c=c.add(a.batch.mutations[h].key));return c})(t)))).next((()=>e.localDocuments.getDocuments(i,s)))}))}function cp(n){const t=q(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function Tw(n,t){const e=q(n),i=t.snapshotVersion;let s=e.Ms;return e.persistence.runTransaction("Apply remote event","readwrite-primary",(r=>{const o=e.Ns.newChangeBuffer({trackRemovals:!0});s=e.Ms;const a=[];t.targetChanges.forEach(((u,d)=>{const g=s.get(d);if(!g)return;a.push(e.Pi.removeMatchingKeys(r,u.removedDocuments,d).next((()=>e.Pi.addMatchingKeys(r,u.addedDocuments,d))));let m=g.withSequenceNumber(r.currentSequenceNumber);t.targetMismatches.get(d)!==null?m=m.withResumeToken(Ot.EMPTY_BYTE_STRING,W.min()).withLastLimboFreeSnapshotVersion(W.min()):u.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(u.resumeToken,i)),s=s.insert(d,m),(function(v,w,S){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=yw?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0})(g,m,u)&&a.push(e.Pi.updateTargetData(r,m))}));let c=Fe(),h=J();if(t.documentUpdates.forEach((u=>{t.resolvedLimboDocuments.has(u)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(r,u))})),a.push(Ew(r,o,t.documentUpdates).next((u=>{c=u.ks,h=u.qs}))),!i.isEqual(W.min())){const u=e.Pi.getLastRemoteSnapshotVersion(r).next((d=>e.Pi.setTargetsMetadata(r,r.currentSequenceNumber,i)));a.push(u)}return N.waitFor(a).next((()=>o.apply(r))).next((()=>e.localDocuments.getLocalViewOfDocuments(r,c,h))).next((()=>c))})).then((r=>(e.Ms=s,r)))}function Ew(n,t,e){let i=J(),s=J();return e.forEach((r=>i=i.add(r))),t.getEntries(n,i).next((r=>{let o=Fe();return e.forEach(((a,c)=>{const h=r.get(a);c.isFoundDocument()!==h.isFoundDocument()&&(s=s.add(a)),c.isNoDocument()&&c.version.isEqual(W.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!h.isValidDocument()||c.version.compareTo(h.version)>0||c.version.compareTo(h.version)===0&&h.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):U(Yc,"Ignoring outdated watch update for ",a,". Current version:",h.version," Watch version:",c.version)})),{ks:o,qs:s}}))}function Iw(n,t){const e=q(n);return e.persistence.runTransaction("Get next mutation batch","readonly",(i=>(t===void 0&&(t=Lc),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t))))}function Aw(n,t){const e=q(n);return e.persistence.runTransaction("Allocate target","readwrite",(i=>{let s;return e.Pi.getTargetData(i,t).next((r=>r?(s=r,N.resolve(s)):e.Pi.allocateTargetId(i).next((o=>(s=new en(t,o,"TargetPurposeListen",i.currentSequenceNumber),e.Pi.addTargetData(i,s).next((()=>s)))))))})).then((i=>{const s=e.Ms.get(i.targetId);return(s===null||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(e.Ms=e.Ms.insert(i.targetId,i),e.xs.set(t,i.targetId)),i}))}async function hc(n,t,e){const i=q(n),s=i.Ms.get(t),r=e?"readwrite":"readwrite-primary";try{e||await i.persistence.runTransaction("Release target",r,(o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Ni(o))throw o;U(Yc,`Failed to update sequence numbers for target ${t}: ${o}`)}i.Ms=i.Ms.remove(t),i.xs.delete(s.target)}function Vu(n,t,e){const i=q(n);let s=W.min(),r=J();return i.persistence.runTransaction("Execute query","readwrite",(o=>(function(c,h,u){const d=q(c),g=d.xs.get(u);return g!==void 0?N.resolve(d.Ms.get(g)):d.Pi.getTargetData(h,u)})(i,o,ge(t)).next((a=>{if(a)return s=a.lastLimboFreeSnapshotVersion,i.Pi.getMatchingKeysForTargetId(o,a.targetId).next((c=>{r=c}))})).next((()=>i.Fs.getDocumentsMatchingQuery(o,t,e?s:W.min(),e?r:J()))).next((a=>(xw(i,uv(t),a),{documents:a,Qs:r})))))}function xw(n,t,e){let i=n.Os.get(t)||W.min();e.forEach(((s,r)=>{r.readTime.compareTo(i)>0&&(i=r.readTime)})),n.Os.set(t,i)}class Nu{constructor(){this.activeTargetIds=_v()}zs(t){this.activeTargetIds=this.activeTargetIds.add(t)}js(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Gs(){const t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}}class Sw{constructor(){this.Mo=new Nu,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.Mo.zs(t),this.xo[t]||"not-current"}updateQueryState(t,e,i){this.xo[t]=e}removeLocalQueryTarget(t){this.Mo.js(t)}isLocalQueryTarget(t){return this.Mo.activeTargetIds.has(t)}clearQueryState(t){delete this.xo[t]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(t){return this.Mo.activeTargetIds.has(t)}start(){return this.Mo=new Nu,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}}class Pw{Oo(t){}shutdown(){}}const Lu="ConnectivityMonitor";class Fu{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(t){this.qo.push(t)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){U(Lu,"Network connectivity changed: AVAILABLE");for(const t of this.qo)t(0)}ko(){U(Lu,"Network connectivity changed: UNAVAILABLE");for(const t of this.qo)t(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}let _r=null;function uc(){return _r===null?_r=(function(){return 268435456+Math.round(2147483648*Math.random())})():_r++,"0x"+_r.toString(16)}const Aa="RestConnection",Rw={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Cw{get $o(){return!1}constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const e=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Uo=e+"://"+t.host,this.Ko=`projects/${i}/databases/${s}`,this.Wo=this.databaseId.database===Kr?`project_id=${i}`:`project_id=${i}&database_id=${s}`}Go(t,e,i,s,r){const o=uc(),a=this.zo(t,e.toUriEncodedString());U(Aa,`Sending RPC '${t}' ${o}:`,a,i);const c={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(c,s,r);const{host:h}=new URL(a),u=Di(h);return this.Jo(t,a,c,i,u).then((d=>(U(Aa,`Received RPC '${t}' ${o}: `,d),d)),(d=>{throw vi(Aa,`RPC '${t}' ${o} failed with error: `,d,"url: ",a,"request:",i),d}))}Ho(t,e,i,s,r,o){return this.Go(t,e,i,s,r)}jo(t,e,i){t["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Oi})(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),e&&e.headers.forEach(((s,r)=>t[r]=s)),i&&i.headers.forEach(((s,r)=>t[r]=s))}zo(t,e){const i=Rw[t];return`${this.Uo}/v1/${e}:${i}`}terminate(){}}class kw{constructor(t){this.Yo=t.Yo,this.Zo=t.Zo}Xo(t){this.e_=t}t_(t){this.n_=t}r_(t){this.i_=t}onMessage(t){this.s_=t}close(){this.Zo()}send(t){this.Yo(t)}o_(){this.e_()}__(){this.n_()}a_(t){this.i_(t)}u_(t){this.s_(t)}}const Lt="WebChannelConnection";class Dw extends Cw{constructor(t){super(t),this.c_=[],this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}Jo(t,e,i,s,r){const o=uc();return new Promise(((a,c)=>{const h=new cg;h.setWithCredentials(!0),h.listenOnce(lg.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Mr.NO_ERROR:const d=h.getResponseJson();U(Lt,`XHR for RPC '${t}' ${o} received:`,JSON.stringify(d)),a(d);break;case Mr.TIMEOUT:U(Lt,`RPC '${t}' ${o} timed out`),c(new B(O.DEADLINE_EXCEEDED,"Request time out"));break;case Mr.HTTP_ERROR:const g=h.getStatus();if(U(Lt,`RPC '${t}' ${o} failed with status:`,g,"response text:",h.getResponseText()),g>0){let m=h.getResponseJson();Array.isArray(m)&&(m=m[0]);const y=m?.error;if(y&&y.status&&y.message){const v=(function(S){const R=S.toLowerCase().replace(/_/g,"-");return Object.values(O).indexOf(R)>=0?R:O.UNKNOWN})(y.status);c(new B(v,y.message))}else c(new B(O.UNKNOWN,"Server responded with status "+h.getStatus()))}else c(new B(O.UNAVAILABLE,"Connection failed."));break;default:j(9055,{l_:t,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{U(Lt,`RPC '${t}' ${o} completed.`)}}));const u=JSON.stringify(s);U(Lt,`RPC '${t}' ${o} sending request:`,s),h.send(e,"POST",u,i,15)}))}T_(t,e,i){const s=uc(),r=[this.Uo,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=dg(),a=ug(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(c.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(c.useFetchStreams=!0),this.jo(c.initMessageHeaders,e,i),c.encodeInitMessageHeaders=!0;const u=r.join("");U(Lt,`Creating RPC '${t}' stream ${s}: ${u}`,c);const d=o.createWebChannel(u,c);this.I_(d);let g=!1,m=!1;const y=new kw({Yo:w=>{m?U(Lt,`Not sending because RPC '${t}' stream ${s} is closed:`,w):(g||(U(Lt,`Opening RPC '${t}' stream ${s} transport.`),d.open(),g=!0),U(Lt,`RPC '${t}' stream ${s} sending:`,w),d.send(w))},Zo:()=>d.close()}),v=(w,S,R)=>{w.listen(S,(D=>{try{R(D)}catch(V){setTimeout((()=>{throw V}),0)}}))};return v(d,hs.EventType.OPEN,(()=>{m||(U(Lt,`RPC '${t}' stream ${s} transport opened.`),y.o_())})),v(d,hs.EventType.CLOSE,(()=>{m||(m=!0,U(Lt,`RPC '${t}' stream ${s} transport closed`),y.a_(),this.E_(d))})),v(d,hs.EventType.ERROR,(w=>{m||(m=!0,vi(Lt,`RPC '${t}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),y.a_(new B(O.UNAVAILABLE,"The operation could not be completed")))})),v(d,hs.EventType.MESSAGE,(w=>{if(!m){const S=w.data[0];nt(!!S,16349);const R=S,D=R?.error||R[0]?.error;if(D){U(Lt,`RPC '${t}' stream ${s} received error:`,D);const V=D.status;let M=(function(b){const T=wt[b];if(T!==void 0)return Yg(T)})(V),L=D.message;M===void 0&&(M=O.INTERNAL,L="Unknown error status: "+V+" with message "+D.message),m=!0,y.a_(new B(M,L)),d.close()}else U(Lt,`RPC '${t}' stream ${s} received:`,S),y.u_(S)}})),v(a,hg.STAT_EVENT,(w=>{w.stat===Ja.PROXY?U(Lt,`RPC '${t}' stream ${s} detected buffering proxy`):w.stat===Ja.NOPROXY&&U(Lt,`RPC '${t}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{y.__()}),0),y}terminate(){this.c_.forEach((t=>t.close())),this.c_=[]}I_(t){this.c_.push(t)}E_(t){this.c_=this.c_.filter((e=>e===t))}}function xa(){return typeof document<"u"?document:null}function Co(n){return new Nv(n,!0)}class lp{constructor(t,e,i=1e3,s=1.5,r=6e4){this.Mi=t,this.timerId=e,this.d_=i,this.A_=s,this.R_=r,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(t){this.cancel();const e=Math.floor(this.V_+this.y_()),i=Math.max(0,Date.now()-this.f_),s=Math.max(0,e-i);s>0&&U("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.V_} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,s,(()=>(this.f_=Date.now(),t()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Bu="PersistentStream";class hp{constructor(t,e,i,s,r,o,a,c){this.Mi=t,this.S_=i,this.b_=s,this.connection=r,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new lp(t,e)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(t){this.Q_(),this.stream.send(t)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(t,e){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,t!==4?this.M_.reset():e&&e.code===O.RESOURCE_EXHAUSTED?(Le(e.toString()),Le("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):e&&e.code===O.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=t,await this.listener.r_(e)}K_(){}auth(){this.state=1;const t=this.W_(this.D_),e=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([i,s])=>{this.D_===e&&this.G_(i,s)}),(i=>{t((()=>{const s=new B(O.UNKNOWN,"Fetching auth token failed: "+i.message);return this.z_(s)}))}))}G_(t,e){const i=this.W_(this.D_);this.stream=this.j_(t,e),this.stream.Xo((()=>{i((()=>this.listener.Xo()))})),this.stream.t_((()=>{i((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((s=>{i((()=>this.z_(s)))})),this.stream.onMessage((s=>{i((()=>++this.F_==1?this.J_(s):this.onNext(s)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(t){return U(Bu,`close with error: ${t}`),this.stream=null,this.close(4,t)}W_(t){return e=>{this.Mi.enqueueAndForget((()=>this.D_===t?e():(U(Bu,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Mw extends hp{constructor(t,e,i,s,r,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}j_(t,e){return this.connection.T_("Listen",t,e)}J_(t){return this.onNext(t)}onNext(t){this.M_.reset();const e=Bv(this.serializer,t),i=(function(r){if(!("targetChange"in r))return W.min();const o=r.targetChange;return o.targetIds&&o.targetIds.length?W.min():o.readTime?me(o.readTime):W.min()})(t);return this.listener.H_(e,i)}Y_(t){const e={};e.database=lc(this.serializer),e.addTarget=(function(r,o){let a;const c=o.target;if(a=ic(c)?{documents:jv(r,c)}:{query:Hv(r,c).ft},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Jg(r,o.resumeToken);const h=oc(r,o.expectedCount);h!==null&&(a.expectedCount=h)}else if(o.snapshotVersion.compareTo(W.min())>0){a.readTime=Zr(r,o.snapshotVersion.toTimestamp());const h=oc(r,o.expectedCount);h!==null&&(a.expectedCount=h)}return a})(this.serializer,t);const i=$v(this.serializer,t);i&&(e.labels=i),this.q_(e)}Z_(t){const e={};e.database=lc(this.serializer),e.removeTarget=t,this.q_(e)}}class Ow extends hp{constructor(t,e,i,s,r,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,s,o),this.serializer=r}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(t,e){return this.connection.T_("Write",t,e)}J_(t){return nt(!!t.streamToken,31322),this.lastStreamToken=t.streamToken,nt(!t.writeResults||t.writeResults.length===0,55816),this.listener.ta()}onNext(t){nt(!!t.streamToken,12678),this.lastStreamToken=t.streamToken,this.M_.reset();const e=zv(t.writeResults,t.commitTime),i=me(t.commitTime);return this.listener.na(i,e)}ra(){const t={};t.database=lc(this.serializer),this.q_(t)}ea(t){const e={streamToken:this.lastStreamToken,writes:t.map((i=>Uv(this.serializer,i)))};this.q_(e)}}class Vw{}class Nw extends Vw{constructor(t,e,i,s){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=s,this.ia=!1}sa(){if(this.ia)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.")}Go(t,e,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,o])=>this.connection.Go(t,ac(e,i),s,r,o))).catch((r=>{throw r.name==="FirebaseError"?(r.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),r):new B(O.UNKNOWN,r.toString())}))}Ho(t,e,i,s,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,a])=>this.connection.Ho(t,ac(e,i),s,o,a,r))).catch((o=>{throw o.name==="FirebaseError"?(o.code===O.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new B(O.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class Lw{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(t){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.ca("Offline")))}set(t){this.Pa(),this.oa=0,t==="Online"&&(this.aa=!1),this.ca(t)}ca(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}la(t){const e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Le(e),this.aa=!1):U("OnlineStateTracker",e)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}const Gn="RemoteStore";class Fw{constructor(t,e,i,s,r){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=r,this.Aa.Oo((o=>{i.enqueueAndForget((async()=>{Jn(this)&&(U(Gn,"Restarting streams for network reachability change."),await(async function(c){const h=q(c);h.Ea.add(4),await qs(h),h.Ra.set("Unknown"),h.Ea.delete(4),await ko(h)})(this))}))})),this.Ra=new Lw(i,s)}}async function ko(n){if(Jn(n))for(const t of n.da)await t(!0)}async function qs(n){for(const t of n.da)await t(!1)}function up(n,t){const e=q(n);e.Ia.has(t.targetId)||(e.Ia.set(t.targetId,t),Zc(e)?Jc(e):Fi(e).O_()&&Qc(e,t))}function Xc(n,t){const e=q(n),i=Fi(e);e.Ia.delete(t),i.O_()&&dp(e,t),e.Ia.size===0&&(i.O_()?i.L_():Jn(e)&&e.Ra.set("Unknown"))}function Qc(n,t){if(n.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(W.min())>0){const e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Fi(n).Y_(t)}function dp(n,t){n.Va.Ue(t),Fi(n).Z_(t)}function Jc(n){n.Va=new Dv({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),At:t=>n.Ia.get(t)||null,ht:()=>n.datastore.serializer.databaseId}),Fi(n).start(),n.Ra.ua()}function Zc(n){return Jn(n)&&!Fi(n).x_()&&n.Ia.size>0}function Jn(n){return q(n).Ea.size===0}function fp(n){n.Va=void 0}async function Bw(n){n.Ra.set("Online")}async function Uw(n){n.Ia.forEach(((t,e)=>{Qc(n,t)}))}async function zw(n,t){fp(n),Zc(n)?(n.Ra.ha(t),Jc(n)):n.Ra.set("Unknown")}async function jw(n,t,e){if(n.Ra.set("Online"),t instanceof Qg&&t.state===2&&t.cause)try{await(async function(s,r){const o=r.cause;for(const a of r.targetIds)s.Ia.has(a)&&(await s.remoteSyncer.rejectListen(a,o),s.Ia.delete(a),s.Va.removeTarget(a))})(n,t)}catch(i){U(Gn,"Failed to remove targets %s: %s ",t.targetIds.join(","),i),await eo(n,i)}else if(t instanceof Lr?n.Va.Ze(t):t instanceof Xg?n.Va.st(t):n.Va.tt(t),!e.isEqual(W.min()))try{const i=await cp(n.localStore);e.compareTo(i)>=0&&await(function(r,o){const a=r.Va.Tt(o);return a.targetChanges.forEach(((c,h)=>{if(c.resumeToken.approximateByteSize()>0){const u=r.Ia.get(h);u&&r.Ia.set(h,u.withResumeToken(c.resumeToken,o))}})),a.targetMismatches.forEach(((c,h)=>{const u=r.Ia.get(c);if(!u)return;r.Ia.set(c,u.withResumeToken(Ot.EMPTY_BYTE_STRING,u.snapshotVersion)),dp(r,c);const d=new en(u.target,c,h,u.sequenceNumber);Qc(r,d)})),r.remoteSyncer.applyRemoteEvent(a)})(n,e)}catch(i){U(Gn,"Failed to raise snapshot:",i),await eo(n,i)}}async function eo(n,t,e){if(!Ni(t))throw t;n.Ea.add(1),await qs(n),n.Ra.set("Offline"),e||(e=()=>cp(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{U(Gn,"Retrying IndexedDB access"),await e(),n.Ea.delete(1),await ko(n)}))}function gp(n,t){return t().catch((e=>eo(n,e,t)))}async function Do(n){const t=q(n),e=yn(t);let i=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Lc;for(;Hw(t);)try{const s=await Iw(t.localStore,i);if(s===null){t.Ta.length===0&&e.L_();break}i=s.batchId,Ww(t,s)}catch(s){await eo(t,s)}pp(t)&&mp(t)}function Hw(n){return Jn(n)&&n.Ta.length<10}function Ww(n,t){n.Ta.push(t);const e=yn(n);e.O_()&&e.X_&&e.ea(t.mutations)}function pp(n){return Jn(n)&&!yn(n).x_()&&n.Ta.length>0}function mp(n){yn(n).start()}async function $w(n){yn(n).ra()}async function qw(n){const t=yn(n);for(const e of n.Ta)t.ea(e.mutations)}async function Gw(n,t,e){const i=n.Ta.shift(),s=Hc.from(i,t,e);await gp(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Do(n)}async function Kw(n,t){t&&yn(n).X_&&await(async function(i,s){if((function(o){return Rv(o)&&o!==O.ABORTED})(s.code)){const r=i.Ta.shift();yn(i).B_(),await gp(i,(()=>i.remoteSyncer.rejectFailedWrite(r.batchId,s))),await Do(i)}})(n,t),pp(n)&&mp(n)}async function Uu(n,t){const e=q(n);e.asyncQueue.verifyOperationInProgress(),U(Gn,"RemoteStore received new credentials");const i=Jn(e);e.Ea.add(3),await qs(e),i&&e.Ra.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Ea.delete(3),await ko(e)}async function Yw(n,t){const e=q(n);t?(e.Ea.delete(2),await ko(e)):t||(e.Ea.add(2),await qs(e),e.Ra.set("Unknown"))}function Fi(n){return n.ma||(n.ma=(function(e,i,s){const r=q(e);return r.sa(),new Mw(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:Bw.bind(null,n),t_:Uw.bind(null,n),r_:zw.bind(null,n),H_:jw.bind(null,n)}),n.da.push((async t=>{t?(n.ma.B_(),Zc(n)?Jc(n):n.Ra.set("Unknown")):(await n.ma.stop(),fp(n))}))),n.ma}function yn(n){return n.fa||(n.fa=(function(e,i,s){const r=q(e);return r.sa(),new Ow(i,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,s)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:$w.bind(null,n),r_:Kw.bind(null,n),ta:qw.bind(null,n),na:Gw.bind(null,n)}),n.da.push((async t=>{t?(n.fa.B_(),await Do(n)):(await n.fa.stop(),n.Ta.length>0&&(U(Gn,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}class tl{constructor(t,e,i,s,r){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new un,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,s,r){const o=Date.now()+i,a=new tl(t,e,o,s,r);return a.start(i),a}start(t){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new B(O.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((t=>this.deferred.resolve(t)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function el(n,t){if(Le("AsyncQueue",`${t}: ${n}`),Ni(n))return new B(O.UNAVAILABLE,`${t}: ${n}`);throw n}class di{static emptySet(t){return new di(t.comparator)}constructor(t){this.comparator=t?(e,i)=>t(e,i)||z.comparator(e.key,i.key):(e,i)=>z.comparator(e.key,i.key),this.keyedMap=us(),this.sortedSet=new pt(this.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){const e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal(((e,i)=>(t(e),!1)))}add(t){const e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){const e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof di)||this.size!==t.size)return!1;const e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){const s=e.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const t=[];return this.forEach((e=>{t.push(e.toString())})),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){const i=new di;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}}class zu{constructor(){this.ga=new pt(z.comparator)}track(t){const e=t.doc.key,i=this.ga.get(e);i?t.type!==0&&i.type===3?this.ga=this.ga.insert(e,t):t.type===3&&i.type!==1?this.ga=this.ga.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.ga=this.ga.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.ga=this.ga.remove(e):t.type===1&&i.type===2?this.ga=this.ga.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.ga=this.ga.insert(e,{type:2,doc:t.doc}):j(63341,{Rt:t,pa:i}):this.ga=this.ga.insert(e,t)}ya(){const t=[];return this.ga.inorderTraversal(((e,i)=>{t.push(i)})),t}}class Si{constructor(t,e,i,s,r,o,a,c,h){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=h}static fromInitialDocuments(t,e,i,s,r){const o=[];return e.forEach((a=>{o.push({type:0,doc:a})})),new Si(t,e,di.emptySet(e),o,i,s,!0,!1,r)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&Ao(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;const e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let s=0;s<e.length;s++)if(e[s].type!==i[s].type||!e[s].doc.isEqual(i[s].doc))return!1;return!0}}class Xw{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((t=>t.Da()))}}class Qw{constructor(){this.queries=ju(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(e,i){const s=q(e),r=s.queries;s.queries=ju(),r.forEach(((o,a)=>{for(const c of a.Sa)c.onError(i)}))})(this,new B(O.ABORTED,"Firestore shutting down"))}}function ju(){return new Qn((n=>Vg(n)),Ao)}async function Jw(n,t){const e=q(n);let i=3;const s=t.query;let r=e.queries.get(s);r?!r.ba()&&t.Da()&&(i=2):(r=new Xw,i=t.Da()?0:1);try{switch(i){case 0:r.wa=await e.onListen(s,!0);break;case 1:r.wa=await e.onListen(s,!1);break;case 2:await e.onFirstRemoteStoreListen(s)}}catch(o){const a=el(o,`Initialization of query '${li(t.query)}' failed`);return void t.onError(a)}e.queries.set(s,r),r.Sa.push(t),t.va(e.onlineState),r.wa&&t.Fa(r.wa)&&nl(e)}async function Zw(n,t){const e=q(n),i=t.query;let s=3;const r=e.queries.get(i);if(r){const o=r.Sa.indexOf(t);o>=0&&(r.Sa.splice(o,1),r.Sa.length===0?s=t.Da()?0:1:!r.ba()&&t.Da()&&(s=2))}switch(s){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}}function tT(n,t){const e=q(n);let i=!1;for(const s of t){const r=s.query,o=e.queries.get(r);if(o){for(const a of o.Sa)a.Fa(s)&&(i=!0);o.wa=s}}i&&nl(e)}function eT(n,t,e){const i=q(n),s=i.queries.get(t);if(s)for(const r of s.Sa)r.onError(e);i.queries.delete(t)}function nl(n){n.Ca.forEach((t=>{t.next()}))}var dc,Hu;(Hu=dc||(dc={})).Ma="default",Hu.Cache="cache";class nT{constructor(t,e,i){this.query=t,this.xa=e,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=i||{}}Fa(t){if(!this.options.includeMetadataChanges){const i=[];for(const s of t.docChanges)s.type!==3&&i.push(s);t=new Si(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.Oa?this.Ba(t)&&(this.xa.next(t),e=!0):this.La(t,this.onlineState)&&(this.ka(t),e=!0),this.Na=t,e}onError(t){this.xa.error(t)}va(t){this.onlineState=t;let e=!1;return this.Na&&!this.Oa&&this.La(this.Na,t)&&(this.ka(this.Na),e=!0),e}La(t,e){if(!t.fromCache||!this.Da())return!0;const i=e!=="Offline";return(!this.options.qa||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}Ba(t){if(t.docChanges.length>0)return!0;const e=this.Na&&this.Na.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}ka(t){t=Si.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.Oa=!0,this.xa.next(t)}Da(){return this.options.source!==dc.Cache}}class _p{constructor(t){this.key=t}}class yp{constructor(t){this.key=t}}class iT{constructor(t,e){this.query=t,this.Ya=e,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=J(),this.mutatedKeys=J(),this.eu=Ng(t),this.tu=new di(this.eu)}get nu(){return this.Ya}ru(t,e){const i=e?e.iu:new zu,s=e?e.tu:this.tu;let r=e?e.mutatedKeys:this.mutatedKeys,o=s,a=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,h=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(t.inorderTraversal(((u,d)=>{const g=s.get(u),m=xo(this.query,d)?d:null,y=!!g&&this.mutatedKeys.has(g.key),v=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;g&&m?g.data.isEqual(m.data)?y!==v&&(i.track({type:3,doc:m}),w=!0):this.su(g,m)||(i.track({type:2,doc:m}),w=!0,(c&&this.eu(m,c)>0||h&&this.eu(m,h)<0)&&(a=!0)):!g&&m?(i.track({type:0,doc:m}),w=!0):g&&!m&&(i.track({type:1,doc:g}),w=!0,(c||h)&&(a=!0)),w&&(m?(o=o.add(m),r=v?r.add(u):r.delete(u)):(o=o.delete(u),r=r.delete(u)))})),this.query.limit!==null)for(;o.size>this.query.limit;){const u=this.query.limitType==="F"?o.last():o.first();o=o.delete(u.key),r=r.delete(u.key),i.track({type:1,doc:u})}return{tu:o,iu:i,Cs:a,mutatedKeys:r}}su(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,s){const r=this.tu;this.tu=t.tu,this.mutatedKeys=t.mutatedKeys;const o=t.iu.ya();o.sort(((u,d)=>(function(m,y){const v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j(20277,{Rt:w})}};return v(m)-v(y)})(u.type,d.type)||this.eu(u.doc,d.doc))),this.ou(i),s=s??!1;const a=e&&!s?this._u():[],c=this.Xa.size===0&&this.current&&!s?1:0,h=c!==this.Za;return this.Za=c,o.length!==0||h?{snapshot:new Si(this.query,t.tu,r,o,t.mutatedKeys,c===0,h,!1,!!i&&i.resumeToken.approximateByteSize()>0),au:a}:{au:a}}va(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zu,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(t){return!this.Ya.has(t)&&!!this.tu.has(t)&&!this.tu.get(t).hasLocalMutations}ou(t){t&&(t.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),t.modifiedDocuments.forEach((e=>{})),t.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=t.current)}_u(){if(!this.current)return[];const t=this.Xa;this.Xa=J(),this.tu.forEach((i=>{this.uu(i.key)&&(this.Xa=this.Xa.add(i.key))}));const e=[];return t.forEach((i=>{this.Xa.has(i)||e.push(new yp(i))})),this.Xa.forEach((i=>{t.has(i)||e.push(new _p(i))})),e}cu(t){this.Ya=t.Qs,this.Xa=J();const e=this.ru(t.documents);return this.applyChanges(e,!0)}lu(){return Si.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const il="SyncEngine";class sT{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}}class rT{constructor(t){this.key=t,this.hu=!1}}class oT{constructor(t,e,i,s,r,o){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Qn((a=>Vg(a)),Ao),this.Iu=new Map,this.Eu=new Set,this.du=new pt(z.comparator),this.Au=new Map,this.Ru=new qc,this.Vu={},this.mu=new Map,this.fu=xi.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function aT(n,t,e=!0){const i=Ip(n);let s;const r=i.Tu.get(t);return r?(i.sharedClientState.addLocalQueryTarget(r.targetId),s=r.view.lu()):s=await bp(i,t,e,!0),s}async function cT(n,t){const e=Ip(n);await bp(e,t,!0,!1)}async function bp(n,t,e,i){const s=await Aw(n.localStore,ge(t)),r=s.targetId,o=n.sharedClientState.addLocalQueryTarget(r,e);let a;return i&&(a=await lT(n,t,r,o==="current",s.resumeToken)),n.isPrimaryClient&&e&&up(n.remoteStore,s),a}async function lT(n,t,e,i,s){n.pu=(d,g,m)=>(async function(v,w,S,R){let D=w.view.ru(S);D.Cs&&(D=await Vu(v.localStore,w.query,!1).then((({documents:E})=>w.view.ru(E,D))));const V=R&&R.targetChanges.get(w.targetId),M=R&&R.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(D,v.isPrimaryClient,V,M);return $u(v,w.targetId,L.au),L.snapshot})(n,d,g,m);const r=await Vu(n.localStore,t,!0),o=new iT(t,r.Qs),a=o.ru(r.documents),c=$s.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",s),h=o.applyChanges(a,n.isPrimaryClient,c);$u(n,e,h.au);const u=new sT(t,e,o);return n.Tu.set(t,u),n.Iu.has(e)?n.Iu.get(e).push(t):n.Iu.set(e,[t]),h.snapshot}async function hT(n,t,e){const i=q(n),s=i.Tu.get(t),r=i.Iu.get(s.targetId);if(r.length>1)return i.Iu.set(s.targetId,r.filter((o=>!Ao(o,t)))),void i.Tu.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(s.targetId),i.sharedClientState.isActiveQueryTarget(s.targetId)||await hc(i.localStore,s.targetId,!1).then((()=>{i.sharedClientState.clearQueryState(s.targetId),e&&Xc(i.remoteStore,s.targetId),fc(i,s.targetId)})).catch(Vi)):(fc(i,s.targetId),await hc(i.localStore,s.targetId,!0))}async function uT(n,t){const e=q(n),i=e.Tu.get(t),s=e.Iu.get(i.targetId);e.isPrimaryClient&&s.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),Xc(e.remoteStore,i.targetId))}async function dT(n,t,e){const i=bT(n);try{const s=await(function(o,a){const c=q(o),h=ht.now(),u=a.reduce(((m,y)=>m.add(y.key)),J());let d,g;return c.persistence.runTransaction("Locally write mutations","readwrite",(m=>{let y=Fe(),v=J();return c.Ns.getEntries(m,u).next((w=>{y=w,y.forEach(((S,R)=>{R.isValidDocument()||(v=v.add(S))}))})).next((()=>c.localDocuments.getOverlayedDocuments(m,y))).next((w=>{d=w;const S=[];for(const R of a){const D=Iv(R,d.get(R.key).overlayedDocument);D!=null&&S.push(new En(R.key,D,xg(D.value.mapValue),pe.exists(!0)))}return c.mutationQueue.addMutationBatch(m,h,S,a)})).next((w=>{g=w;const S=w.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(m,w.batchId,S)}))})).then((()=>({batchId:g.batchId,changes:Fg(d)})))})(i.localStore,t);i.sharedClientState.addPendingMutation(s.batchId),(function(o,a,c){let h=o.Vu[o.currentUser.toKey()];h||(h=new pt(Q)),h=h.insert(a,c),o.Vu[o.currentUser.toKey()]=h})(i,s.batchId,e),await Gs(i,s.changes),await Do(i.remoteStore)}catch(s){const r=el(s,"Failed to persist write");e.reject(r)}}async function vp(n,t){const e=q(n);try{const i=await Tw(e.localStore,t);t.targetChanges.forEach(((s,r)=>{const o=e.Au.get(r);o&&(nt(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o.hu=!0:s.modifiedDocuments.size>0?nt(o.hu,14607):s.removedDocuments.size>0&&(nt(o.hu,42227),o.hu=!1))})),await Gs(e,i,t)}catch(i){await Vi(i)}}function Wu(n,t,e){const i=q(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){const s=[];i.Tu.forEach(((r,o)=>{const a=o.view.va(t);a.snapshot&&s.push(a.snapshot)})),(function(o,a){const c=q(o);c.onlineState=a;let h=!1;c.queries.forEach(((u,d)=>{for(const g of d.Sa)g.va(a)&&(h=!0)})),h&&nl(c)})(i.eventManager,t),s.length&&i.Pu.H_(s),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function fT(n,t,e){const i=q(n);i.sharedClientState.updateQueryState(t,"rejected",e);const s=i.Au.get(t),r=s&&s.key;if(r){let o=new pt(z.comparator);o=o.insert(r,zt.newNoDocument(r,W.min()));const a=J().add(r),c=new Ro(W.min(),new Map,new pt(Q),o,a);await vp(i,c),i.du=i.du.remove(r),i.Au.delete(t),sl(i)}else await hc(i.localStore,t,!1).then((()=>fc(i,t,e))).catch(Vi)}async function gT(n,t){const e=q(n),i=t.batch.batchId;try{const s=await ww(e.localStore,t);Tp(e,i,null),wp(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),await Gs(e,s)}catch(s){await Vi(s)}}async function pT(n,t,e){const i=q(n);try{const s=await(function(o,a){const c=q(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let u;return c.mutationQueue.lookupMutationBatch(h,a).next((d=>(nt(d!==null,37113),u=d.keys(),c.mutationQueue.removeMutationBatch(h,d)))).next((()=>c.mutationQueue.performConsistencyCheck(h))).next((()=>c.documentOverlayCache.removeOverlaysForBatchId(h,u,a))).next((()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,u))).next((()=>c.localDocuments.getDocuments(h,u)))}))})(i.localStore,t);Tp(i,t,e),wp(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),await Gs(i,s)}catch(s){await Vi(s)}}function wp(n,t){(n.mu.get(t)||[]).forEach((e=>{e.resolve()})),n.mu.delete(t)}function Tp(n,t,e){const i=q(n);let s=i.Vu[i.currentUser.toKey()];if(s){const r=s.get(t);r&&(e?r.reject(e):r.resolve(),s=s.remove(t)),i.Vu[i.currentUser.toKey()]=s}}function fc(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(const i of n.Iu.get(t))n.Tu.delete(i),e&&n.Pu.yu(i,e);n.Iu.delete(t),n.isPrimaryClient&&n.Ru.jr(t).forEach((i=>{n.Ru.containsKey(i)||Ep(n,i)}))}function Ep(n,t){n.Eu.delete(t.path.canonicalString());const e=n.du.get(t);e!==null&&(Xc(n.remoteStore,e),n.du=n.du.remove(t),n.Au.delete(e),sl(n))}function $u(n,t,e){for(const i of e)i instanceof _p?(n.Ru.addReference(i.key,t),mT(n,i)):i instanceof yp?(U(il,"Document no longer in limbo: "+i.key),n.Ru.removeReference(i.key,t),n.Ru.containsKey(i.key)||Ep(n,i.key)):j(19791,{wu:i})}function mT(n,t){const e=t.key,i=e.path.canonicalString();n.du.get(e)||n.Eu.has(i)||(U(il,"New document in limbo: "+e),n.Eu.add(i),sl(n))}function sl(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const t=n.Eu.values().next().value;n.Eu.delete(t);const e=new z(ct.fromString(t)),i=n.fu.next();n.Au.set(i,new rT(e)),n.du=n.du.insert(e,i),up(n.remoteStore,new en(ge(Mg(e.path)),i,"TargetPurposeLimboResolution",To.ce))}}async function Gs(n,t,e){const i=q(n),s=[],r=[],o=[];i.Tu.isEmpty()||(i.Tu.forEach(((a,c)=>{o.push(i.pu(c,t,e).then((h=>{if((h||e)&&i.isPrimaryClient){const u=h?!h.fromCache:e?.targetChanges.get(c.targetId)?.current;i.sharedClientState.updateQueryState(c.targetId,u?"current":"not-current")}if(h){s.push(h);const u=Kc.As(c.targetId,h);r.push(u)}})))})),await Promise.all(o),i.Pu.H_(s),await(async function(c,h){const u=q(c);try{await u.persistence.runTransaction("notifyLocalViewChanges","readwrite",(d=>N.forEach(h,(g=>N.forEach(g.Es,(m=>u.persistence.referenceDelegate.addReference(d,g.targetId,m))).next((()=>N.forEach(g.ds,(m=>u.persistence.referenceDelegate.removeReference(d,g.targetId,m)))))))))}catch(d){if(!Ni(d))throw d;U(Yc,"Failed to update sequence numbers: "+d)}for(const d of h){const g=d.targetId;if(!d.fromCache){const m=u.Ms.get(g),y=m.snapshotVersion,v=m.withLastLimboFreeSnapshotVersion(y);u.Ms=u.Ms.insert(g,v)}}})(i.localStore,r))}async function _T(n,t){const e=q(n);if(!e.currentUser.isEqual(t)){U(il,"User change. New user:",t.toKey());const i=await ap(e.localStore,t);e.currentUser=t,(function(r,o){r.mu.forEach((a=>{a.forEach((c=>{c.reject(new B(O.CANCELLED,o))}))})),r.mu.clear()})(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),await Gs(e,i.Ls)}}function yT(n,t){const e=q(n),i=e.Au.get(t);if(i&&i.hu)return J().add(i.key);{let s=J();const r=e.Iu.get(t);if(!r)return s;for(const o of r){const a=e.Tu.get(o);s=s.unionWith(a.view.nu)}return s}}function Ip(n){const t=q(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=vp.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=yT.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=fT.bind(null,t),t.Pu.H_=tT.bind(null,t.eventManager),t.Pu.yu=eT.bind(null,t.eventManager),t}function bT(n){const t=q(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=gT.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=pT.bind(null,t),t}class no{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(t){this.serializer=Co(t.databaseInfo.databaseId),this.sharedClientState=this.Du(t),this.persistence=this.Cu(t),await this.persistence.start(),this.localStore=this.vu(t),this.gcScheduler=this.Fu(t,this.localStore),this.indexBackfillerScheduler=this.Mu(t,this.localStore)}Fu(t,e){return null}Mu(t,e){return null}vu(t){return vw(this.persistence,new _w,t.initialUser,this.serializer)}Cu(t){return new op(Gc.mi,this.serializer)}Du(t){return new Sw}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}no.provider={build:()=>new no};class vT extends no{constructor(t){super(),this.cacheSizeBytes=t}Fu(t,e){nt(this.persistence.referenceDelegate instanceof to,46915);const i=this.persistence.referenceDelegate.garbageCollector;return new nw(i,t.asyncQueue,e)}Cu(t){const e=this.cacheSizeBytes!==void 0?Kt.withCacheSize(this.cacheSizeBytes):Kt.DEFAULT;return new op((i=>to.mi(i,e)),this.serializer)}}class gc{async initialize(t,e){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Wu(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=_T.bind(null,this.syncEngine),await Yw(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(t){return(function(){return new Qw})()}createDatastore(t){const e=Co(t.databaseInfo.databaseId),i=(function(r){return new Dw(r)})(t.databaseInfo);return(function(r,o,a,c){return new Nw(r,o,a,c)})(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return(function(i,s,r,o,a){return new Fw(i,s,r,o,a)})(this.localStore,this.datastore,t.asyncQueue,(e=>Wu(this.syncEngine,e,0)),(function(){return Fu.v()?new Fu:new Pw})())}createSyncEngine(t,e){return(function(s,r,o,a,c,h,u){const d=new oT(s,r,o,a,c,h);return u&&(d.gu=!0),d})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}async terminate(){await(async function(e){const i=q(e);U(Gn,"RemoteStore shutting down."),i.Ea.add(5),await qs(i),i.Aa.shutdown(),i.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}gc.provider={build:()=>new gc};class wT{constructor(t){this.observer=t,this.muted=!1}next(t){this.muted||this.observer.next&&this.Ou(this.observer.next,t)}error(t){this.muted||(this.observer.error?this.Ou(this.observer.error,t):Le("Uncaught Error in snapshot listener:",t.toString()))}Nu(){this.muted=!0}Ou(t,e){setTimeout((()=>{this.muted||t(e)}),0)}}const bn="FirestoreClient";class TT{constructor(t,e,i,s,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=s,this.user=Bt.UNAUTHENTICATED,this.clientId=Nc.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=r,this.authCredentials.start(i,(async o=>{U(bn,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(i,(o=>(U(bn,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}terminate(){this.asyncQueue.enterRestrictedMode();const t=new un;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){const i=el(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}async function Sa(n,t){n.asyncQueue.verifyOperationInProgress(),U(bn,"Initializing OfflineComponentProvider");const e=n.configuration;await t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener((async s=>{i.isEqual(s)||(await ap(t.localStore,s),i=s)})),t.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=t}async function qu(n,t){n.asyncQueue.verifyOperationInProgress();const e=await ET(n);U(bn,"Initializing OnlineComponentProvider"),await t.initialize(e,n.configuration),n.setCredentialChangeListener((i=>Uu(t.remoteStore,i))),n.setAppCheckTokenChangeListener(((i,s)=>Uu(t.remoteStore,s))),n._onlineComponents=t}async function ET(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){U(bn,"Using user provided OfflineComponentProvider");try{await Sa(n,n._uninitializedComponentsProvider._offline)}catch(t){const e=t;if(!(function(s){return s.name==="FirebaseError"?s.code===O.FAILED_PRECONDITION||s.code===O.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(e))throw e;vi("Error using user provided cache. Falling back to memory cache: "+e),await Sa(n,new no)}}else U(bn,"Using default OfflineComponentProvider"),await Sa(n,new vT(void 0));return n._offlineComponents}async function Ap(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(U(bn,"Using user provided OnlineComponentProvider"),await qu(n,n._uninitializedComponentsProvider._online)):(U(bn,"Using default OnlineComponentProvider"),await qu(n,new gc))),n._onlineComponents}function IT(n){return Ap(n).then((t=>t.syncEngine))}async function AT(n){const t=await Ap(n),e=t.eventManager;return e.onListen=aT.bind(null,t.syncEngine),e.onUnlisten=hT.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=cT.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=uT.bind(null,t.syncEngine),e}function xT(n,t,e={}){const i=new un;return n.asyncQueue.enqueueAndForget((async()=>(function(r,o,a,c,h){const u=new wT({next:g=>{u.Nu(),o.enqueueAndForget((()=>Zw(r,d))),g.fromCache&&c.source==="server"?h.reject(new B(O.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(g)},error:g=>h.reject(g)}),d=new nT(a,u,{includeMetadataChanges:!0,qa:!0});return Jw(r,d)})(await AT(n),n.asyncQueue,t,e,i))),i.promise}function xp(n){const t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}const Gu=new Map;const Sp="firestore.googleapis.com",Ku=!0;class Yu{constructor(t){if(t.host===void 0){if(t.ssl!==void 0)throw new B(O.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Sp,this.ssl=Ku}else this.host=t.host,this.ssl=t.ssl??Ku;if(this.isUsingEmulator=t.emulatorOptions!==void 0,this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=rp;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<tw)throw new B(O.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Fb("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=xp(t.experimentalLongPollingOptions??{}),(function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new B(O.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&(function(i,s){return i.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}}class Mo{constructor(t,e,i,s){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Yu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new B(O.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(t){if(this._settingsFrozen)throw new B(O.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Yu(t),this._emulatorOptions=t.emulatorOptions||{},t.credentials!==void 0&&(this._authCredentials=(function(i){if(!i)return new Pb;switch(i.type){case"firstParty":return new Db(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new B(O.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(t.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(e){const i=Gu.get(e);i&&(U("ComponentProvider","Removing Datastore"),Gu.delete(e),i.terminate())})(this),Promise.resolve()}}function ST(n,t,e,i={}){n=qn(n,Mo);const s=Di(t),r=n._getSettings(),o={...r,emulatorOptions:n._getEmulatorOptions()},a=`${t}:${e}`;s&&(tg(`https://${a}`),eg("Firestore",!0)),r.host!==Sp&&r.host!==a&&vi("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...r,host:a,ssl:s,emulatorOptions:i};if(!Ve(c,o)&&(n._setSettings(c),i.mockUserToken)){let h,u;if(typeof i.mockUserToken=="string")h=i.mockUserToken,u=Bt.MOCK_USER;else{h=Z_(i.mockUserToken,n._app?.options.projectId);const d=i.mockUserToken.sub||i.mockUserToken.user_id;if(!d)throw new B(O.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Bt(d)}n._authCredentials=new Rb(new gg(h,u))}}class Zn{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new Zn(this.firestore,t,this._query)}}class It{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dn(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new It(this.firestore,t,this._key)}toJSON(){return{type:It._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(t,e,i){if(Hs(e,It._jsonSchema))return new It(t,i||null,new z(ct.fromString(e.referencePath)))}}It._jsonSchemaVersion="firestore/documentReference/1.0",It._jsonSchema={type:Et("string",It._jsonSchemaVersion),referencePath:Et("string")};class dn extends Zn{constructor(t,e,i){super(t,e,Mg(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const t=this._path.popLast();return t.isEmpty()?null:new It(this.firestore,null,new z(t))}withConverter(t){return new dn(this.firestore,t,this._path)}}function PT(n,t,...e){if(n=Mt(n),pg("collection","path",t),n instanceof Mo){const i=ct.fromString(t,...e);return cu(i),new dn(n,null,i)}{if(!(n instanceof It||n instanceof dn))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(t,...e));return cu(i),new dn(n.firestore,null,i)}}function Pp(n,t,...e){if(n=Mt(n),arguments.length===1&&(t=Nc.newId()),pg("doc","path",t),n instanceof Mo){const i=ct.fromString(t,...e);return au(i),new It(n,null,new z(i))}{if(!(n instanceof It||n instanceof dn))throw new B(O.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(ct.fromString(t,...e));return au(i),new It(n.firestore,n instanceof dn?n.converter:null,new z(i))}}const Xu="AsyncQueue";class Qu{constructor(t=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new lp(this,"async_queue_retry"),this._c=()=>{const i=xa();i&&U(Xu,"Visibility state changed to "+i.visibilityState),this.M_.w_()},this.ac=t;const e=xa();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.uc(),this.cc(t)}enterRestrictedMode(t){if(!this.ec){this.ec=!0,this.sc=t||!1;const e=xa();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this._c)}}enqueue(t){if(this.uc(),this.ec)return new Promise((()=>{}));const e=new un;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(t().then(e.resolve,e.reject),e.promise))).then((()=>e.promise))}enqueueRetryable(t){this.enqueueAndForget((()=>(this.Xu.push(t),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(t){if(!Ni(t))throw t;U(Xu,"Operation failed with retryable error: "+t)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(t){const e=this.ac.then((()=>(this.rc=!0,t().catch((i=>{throw this.nc=i,this.rc=!1,Le("INTERNAL UNHANDLED ERROR: ",Ju(i)),i})).then((i=>(this.rc=!1,i))))));return this.ac=e,e}enqueueAfterDelay(t,e,i){this.uc(),this.oc.indexOf(t)>-1&&(e=0);const s=tl.createAndSchedule(this,t,e,i,(r=>this.hc(r)));return this.tc.push(s),s}uc(){this.nc&&j(47125,{Pc:Ju(this.nc)})}verifyOperationInProgress(){}async Tc(){let t;do t=this.ac,await t;while(t!==this.ac)}Ic(t){for(const e of this.tc)if(e.timerId===t)return!0;return!1}Ec(t){return this.Tc().then((()=>{this.tc.sort(((e,i)=>e.targetTimeMs-i.targetTimeMs));for(const e of this.tc)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.Tc()}))}dc(t){this.oc.push(t)}hc(t){const e=this.tc.indexOf(t);this.tc.splice(e,1)}}function Ju(n){let t=n.message||"";return n.stack&&(t=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),t}class Oo extends Mo{constructor(t,e,i,s){super(t,e,i,s),this.type="firestore",this._queue=new Qu,this._persistenceKey=s?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const t=this._firestoreClient.terminate();this._queue=new Qu(t),this._firestoreClient=void 0,await t}}}function RT(n,t){const e=typeof n=="object"?n:sg(),i=typeof n=="string"?n:Kr,s=Mc(e,"firestore").getImmediate({identifier:i});if(!s._initialized){const r=Q_("firestore");r&&ST(s,...r)}return s}function Rp(n){if(n._terminated)throw new B(O.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||CT(n),n._firestoreClient}function CT(n){const t=n._freezeSettings(),e=(function(s,r,o,a){return new Yb(s,r,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,xp(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,t);n._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),n._firestoreClient=new TT(n._authCredentials,n._appCheckCredentials,n._queue,e,n._componentsProvider&&(function(s){const r=s?._online.build();return{_offline:s?._offline.build(r),_online:r}})(n._componentsProvider))}class ne{constructor(t){this._byteString=t}static fromBase64String(t){try{return new ne(Ot.fromBase64String(t))}catch(e){throw new B(O.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new ne(Ot.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}toJSON(){return{type:ne._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(t){if(Hs(t,ne._jsonSchema))return ne.fromBase64String(t.bytes)}}ne._jsonSchemaVersion="firestore/bytes/1.0",ne._jsonSchema={type:Et("string",ne._jsonSchemaVersion),bytes:Et("string")};class Vo{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new B(O.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}}class Ks{constructor(t){this._methodName=t}}class _e{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new B(O.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new B(O.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}_compareTo(t){return Q(this._lat,t._lat)||Q(this._long,t._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:_e._jsonSchemaVersion}}static fromJSON(t){if(Hs(t,_e._jsonSchema))return new _e(t.latitude,t.longitude)}}_e._jsonSchemaVersion="firestore/geoPoint/1.0",_e._jsonSchema={type:Et("string",_e._jsonSchemaVersion),latitude:Et("number"),longitude:Et("number")};class ye{constructor(t){this._values=(t||[]).map((e=>e))}toArray(){return this._values.map((t=>t))}isEqual(t){return(function(i,s){if(i.length!==s.length)return!1;for(let r=0;r<i.length;++r)if(i[r]!==s[r])return!1;return!0})(this._values,t._values)}toJSON(){return{type:ye._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(t){if(Hs(t,ye._jsonSchema)){if(Array.isArray(t.vectorValues)&&t.vectorValues.every((e=>typeof e=="number")))return new ye(t.vectorValues);throw new B(O.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}ye._jsonSchemaVersion="firestore/vectorValue/1.0",ye._jsonSchema={type:Et("string",ye._jsonSchemaVersion),vectorValues:Et("object")};const kT=/^__.*__$/;class DT{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new En(t,this.data,this.fieldMask,e,this.fieldTransforms):new Ws(t,this.data,e,this.fieldTransforms)}}class Cp{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new En(t,this.data,this.fieldMask,e,this.fieldTransforms)}}function kp(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j(40011,{Ac:n})}}class No{constructor(t,e,i,s,r,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=s,r===void 0&&this.Rc(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(t){return new No({...this.settings,...t},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.gc(t),i}yc(t){const e=this.path?.child(t),i=this.Vc({path:e,fc:!1});return i.Rc(),i}wc(t){return this.Vc({path:void 0,fc:!0})}Sc(t){return io(t,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(t){return this.fieldMask.find((e=>t.isPrefixOf(e)))!==void 0||this.fieldTransforms.find((e=>t.isPrefixOf(e.field)))!==void 0}Rc(){if(this.path)for(let t=0;t<this.path.length;t++)this.gc(this.path.get(t))}gc(t){if(t.length===0)throw this.Sc("Document fields must not be empty");if(kp(this.Ac)&&kT.test(t))throw this.Sc('Document fields cannot begin and end with "__"')}}class MT{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||Co(t)}Cc(t,e,i,s=!1){return new No({Ac:t,methodName:e,Dc:i,path:Dt.emptyPath(),fc:!1,bc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function rl(n){const t=n._freezeSettings(),e=Co(n._databaseId);return new MT(n._databaseId,!!t.ignoreUndefinedProperties,e)}function OT(n,t,e,i,s,r={}){const o=n.Cc(r.merge||r.mergeFields?2:0,t,e,s);cl("Data must be an object, but it was:",o,i);const a=Mp(i,o);let c,h;if(r.merge)c=new Zt(o.fieldMask),h=o.fieldTransforms;else if(r.mergeFields){const u=[];for(const d of r.mergeFields){const g=pc(t,d,e);if(!o.contains(g))throw new B(O.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);Vp(u,g)||u.push(g)}c=new Zt(u),h=o.fieldTransforms.filter((d=>c.covers(d.field)))}else c=null,h=o.fieldTransforms;return new DT(new Yt(a),c,h)}class Lo extends Ks{_toFieldTransform(t){if(t.Ac!==2)throw t.Ac===1?t.Sc(`${this._methodName}() can only appear at the top level of your update data`):t.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof Lo}}function Dp(n,t,e){return new No({Ac:3,Dc:t.settings.Dc,methodName:n._methodName,fc:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class ol extends Ks{constructor(t,e){super(t),this.vc=e}_toFieldTransform(t){const e=Dp(this,t,!0),i=this.vc.map((r=>ti(r,e))),s=new Ii(i);return new $g(t.path,s)}isEqual(t){return t instanceof ol&&Ve(this.vc,t.vc)}}class al extends Ks{constructor(t,e){super(t),this.vc=e}_toFieldTransform(t){const e=Dp(this,t,!0),i=this.vc.map((r=>ti(r,e))),s=new Ai(i);return new $g(t.path,s)}isEqual(t){return t instanceof al&&Ve(this.vc,t.vc)}}function VT(n,t,e,i){const s=n.Cc(1,t,e);cl("Data must be an object, but it was:",s,i);const r=[],o=Yt.empty();Tn(i,((c,h)=>{const u=ll(t,c,e);h=Mt(h);const d=s.yc(u);if(h instanceof Lo)r.push(u);else{const g=ti(h,d);g!=null&&(r.push(u),o.set(u,g))}}));const a=new Zt(r);return new Cp(o,a,s.fieldTransforms)}function NT(n,t,e,i,s,r){const o=n.Cc(1,t,e),a=[pc(t,i,e)],c=[s];if(r.length%2!=0)throw new B(O.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<r.length;g+=2)a.push(pc(t,r[g])),c.push(r[g+1]);const h=[],u=Yt.empty();for(let g=a.length-1;g>=0;--g)if(!Vp(h,a[g])){const m=a[g];let y=c[g];y=Mt(y);const v=o.yc(m);if(y instanceof Lo)h.push(m);else{const w=ti(y,v);w!=null&&(h.push(m),u.set(m,w))}}const d=new Zt(h);return new Cp(u,d,o.fieldTransforms)}function LT(n,t,e,i=!1){return ti(e,n.Cc(i?4:3,t))}function ti(n,t){if(Op(n=Mt(n)))return cl("Unsupported field value:",t,n),Mp(n,t);if(n instanceof Ks)return(function(i,s){if(!kp(s.Ac))throw s.Sc(`${i._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Sc(`${i._methodName}() is not currently supported inside arrays`);const r=i._toFieldTransform(s);r&&s.fieldTransforms.push(r)})(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.fc&&t.Ac!==4)throw t.Sc("Nested arrays are not supported");return(function(i,s){const r=[];let o=0;for(const a of i){let c=ti(a,s.wc(o));c==null&&(c={nullValue:"NULL_VALUE"}),r.push(c),o++}return{arrayValue:{values:r}}})(n,t)}return(function(i,s){if((i=Mt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return yv(s.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){const r=ht.fromDate(i);return{timestampValue:Zr(s.serializer,r)}}if(i instanceof ht){const r=new ht(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:Zr(s.serializer,r)}}if(i instanceof _e)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof ne)return{bytesValue:Jg(s.serializer,i._byteString)};if(i instanceof It){const r=s.databaseId,o=i.firestore._databaseId;if(!o.isEqual(r))throw s.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:$c(i.firestore._databaseId||s.databaseId,i._key.path)}}if(i instanceof ye)return(function(o,a){return{mapValue:{fields:{[Ig]:{stringValue:Ag},[Yr]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw a.Sc("VectorValues must only contain numeric values.");return jc(a.serializer,h)}))}}}}}})(i,s);throw s.Sc(`Unsupported field value: ${wo(i)}`)})(n,t)}function Mp(n,t){const e={};return yg(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Tn(n,((i,s)=>{const r=ti(s,t.mc(i));r!=null&&(e[i]=r)})),{mapValue:{fields:e}}}function Op(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof ht||n instanceof _e||n instanceof ne||n instanceof It||n instanceof Ks||n instanceof ye)}function cl(n,t,e){if(!Op(e)||!mg(e)){const i=wo(e);throw i==="an object"?t.Sc(n+" a custom object"):t.Sc(n+" "+i)}}function pc(n,t,e){if((t=Mt(t))instanceof Vo)return t._internalPath;if(typeof t=="string")return ll(n,t);throw io("Field path arguments must be of type string or ",n,!1,void 0,e)}const FT=new RegExp("[~\\*/\\[\\]]");function ll(n,t,e){if(t.search(FT)>=0)throw io(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Vo(...t.split("."))._internalPath}catch{throw io(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function io(n,t,e,i,s){const r=i&&!i.isEmpty(),o=s!==void 0;let a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(r||o)&&(c+=" (found",r&&(c+=` in field ${i}`),o&&(c+=` in document ${s}`),c+=")"),new B(O.INVALID_ARGUMENT,a+n+c)}function Vp(n,t){return n.some((e=>e.isEqual(t)))}class Np{constructor(t,e,i,s,r){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new It(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const t=new BT(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){const e=this._document.data.field(hl("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}}class BT extends Np{data(){return super.data()}}function hl(n,t){return typeof t=="string"?ll(n,t):t instanceof Vo?t._internalPath:t._delegate._internalPath}function UT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new B(O.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ul{}class Lp extends ul{}function zT(n,t,...e){let i=[];t instanceof ul&&i.push(t),i=i.concat(e),(function(r){const o=r.filter((c=>c instanceof fl)).length,a=r.filter((c=>c instanceof dl)).length;if(o>1||o>0&&a>0)throw new B(O.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(i);for(const s of i)n=s._apply(n);return n}class dl extends Lp{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new dl(t,e,i)}_apply(t){const e=this._parse(t);return Fp(t._query,e),new Zn(t.firestore,t.converter,sc(t._query,e))}_parse(t){const e=rl(t.firestore);return(function(r,o,a,c,h,u,d){let g;if(h.isKeyField()){if(u==="array-contains"||u==="array-contains-any")throw new B(O.INVALID_ARGUMENT,`Invalid Query. You can't perform '${u}' queries on documentId().`);if(u==="in"||u==="not-in"){td(d,u);const y=[];for(const v of d)y.push(Zu(c,r,v));g={arrayValue:{values:y}}}else g=Zu(c,r,d)}else u!=="in"&&u!=="not-in"&&u!=="array-contains-any"||td(d,u),g=LT(a,o,d,u==="in"||u==="not-in");return Tt.create(h,u,g)})(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}}class fl extends ul{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new fl(t,e)}_parse(t){const e=this._queryConstraints.map((i=>i._parse(t))).filter((i=>i.getFilters().length>0));return e.length===1?e[0]:ce.create(e,this._getOperator())}_apply(t){const e=this._parse(t);return e.getFilters().length===0?t:((function(s,r){let o=s;const a=r.getFlattenedFilters();for(const c of a)Fp(o,c),o=sc(o,c)})(t._query,e),new Zn(t.firestore,t.converter,sc(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class gl extends Lp{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new gl(t,e)}_apply(t){const e=(function(s,r,o){if(s.startAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new B(O.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ds(r,o)})(t._query,this._field,this._direction);return new Zn(t.firestore,t.converter,(function(s,r){const o=s.explicitOrderBy.concat([r]);return new Li(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(t._query,e))}}function jT(n,t="asc"){const e=t,i=hl("orderBy",n);return gl._create(i,e)}function Zu(n,t,e){if(typeof(e=Mt(e))=="string"){if(e==="")throw new B(O.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Og(t)&&e.indexOf("/")!==-1)throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);const i=t.path.child(ct.fromString(e));if(!z.isDocumentKey(i))throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return mu(n,new z(i))}if(e instanceof It)return mu(n,e._key);throw new B(O.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${wo(e)}.`)}function td(n,t){if(!Array.isArray(n)||n.length===0)throw new B(O.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Fp(n,t){const e=(function(s,r){for(const o of s)for(const a of o.getFlattenedFilters())if(r.indexOf(a.op)>=0)return a.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(t.op));if(e!==null)throw e===t.op?new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new B(O.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}class HT{convertValue(t,e="none"){switch(_n(t)){case 0:return null;case 1:return t.booleanValue;case 2:return bt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(mn(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw j(62114,{value:t})}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){const i={};return Tn(t,((s,r)=>{i[s]=this.convertValue(r,e)})),i}convertVectorValue(t){const e=t.fields?.[Yr].arrayValue?.values?.map((i=>bt(i.doubleValue)));return new ye(e)}convertGeoPoint(t){return new _e(bt(t.latitude),bt(t.longitude))}convertArray(t,e){return(t.values||[]).map((i=>this.convertValue(i,e)))}convertServerTimestamp(t,e){switch(e){case"previous":const i=Io(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Rs(t));default:return null}}convertTimestamp(t){const e=pn(t);return new ht(e.seconds,e.nanos)}convertDocumentKey(t,e){const i=ct.fromString(t);nt(sp(i),9688,{name:t});const s=new Cs(i.get(1),i.get(3)),r=new z(i.popFirst(5));return s.isEqual(e)||Le(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),r}}function WT(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}class yr{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}}class fi extends Np{constructor(t,e,i,s,r,o){super(t,e,i,s,o),this._firestore=t,this._firestoreImpl=t,this.metadata=r}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){const e=new Fr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){const i=this._document.data.field(hl("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new B(O.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t=this._document,e={};return e.type=fi._jsonSchemaVersion,e.bundle="",e.bundleSource="DocumentSnapshot",e.bundleName=this._key.toString(),!t||!t.isValidDocument()||!t.isFoundDocument()?e:(this._userDataWriter.convertObjectMap(t.data.value.mapValue.fields,"previous"),e.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),e)}}fi._jsonSchemaVersion="firestore/documentSnapshot/1.0",fi._jsonSchema={type:Et("string",fi._jsonSchemaVersion),bundleSource:Et("string","DocumentSnapshot"),bundleName:Et("string"),bundle:Et("string")};class Fr extends fi{data(t={}){return super.data(t)}}class gi{constructor(t,e,i,s){this._firestore=t,this._userDataWriter=e,this._snapshot=s,this.metadata=new yr(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const t=[];return this.forEach((e=>t.push(e))),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach((i=>{t.call(e,new Fr(this._firestore,this._userDataWriter,i.key,i,new yr(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(t={}){const e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new B(O.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=(function(s,r){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map((a=>{const c=new Fr(s._firestore,s._userDataWriter,a.doc.key,a.doc,new yr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}}))}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((a=>r||a.type!==3)).map((a=>{const c=new Fr(s._firestore,s._userDataWriter,a.doc.key,a.doc,new yr(s._snapshot.mutatedKeys.has(a.doc.key),s._snapshot.fromCache),s.query.converter);let h=-1,u=-1;return a.type!==0&&(h=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),u=o.indexOf(a.doc.key)),{type:$T(a.type),doc:c,oldIndex:h,newIndex:u}}))}})(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new B(O.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const t={};t.type=gi._jsonSchemaVersion,t.bundleSource="QuerySnapshot",t.bundleName=Nc.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const e=[],i=[],s=[];return this.docs.forEach((r=>{r._document!==null&&(e.push(r._document),i.push(this._userDataWriter.convertObjectMap(r._document.data.value.mapValue.fields,"previous")),s.push(r.ref.path))})),t.bundle=(this._firestore,this.query._query,t.bundleName,"NOT SUPPORTED"),t}}function $T(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j(61501,{type:n})}}gi._jsonSchemaVersion="firestore/querySnapshot/1.0",gi._jsonSchema={type:Et("string",gi._jsonSchemaVersion),bundleSource:Et("string","QuerySnapshot"),bundleName:Et("string"),bundle:Et("string")};class qT extends HT{constructor(t){super(),this.firestore=t}convertBytes(t){return new ne(t)}convertReference(t){const e=this.convertDocumentKey(t,this.firestore._databaseId);return new It(this.firestore,null,e)}}function GT(n){n=qn(n,Zn);const t=qn(n.firestore,Oo),e=Rp(t),i=new qT(t);return UT(n._query),xT(e,n._query).then((s=>new gi(t,i,n,s)))}function ed(n,t,e){n=qn(n,It);const i=qn(n.firestore,Oo),s=WT(n.converter,t,e);return Bp(i,[OT(rl(i),"setDoc",n._key,s,n.converter!==null,e).toMutation(n._key,pe.none())])}function KT(n,t,e,...i){n=qn(n,It);const s=qn(n.firestore,Oo),r=rl(s);let o;return o=typeof(t=Mt(t))=="string"||t instanceof Vo?NT(r,"updateDoc",n._key,t,e,i):VT(r,"updateDoc",n._key,t),Bp(s,[o.toMutation(n._key,pe.exists(!0))])}function Bp(n,t){return(function(i,s){const r=new un;return i.asyncQueue.enqueueAndForget((async()=>dT(await IT(i),s,r))),r.promise})(Rp(n),t)}function YT(...n){return new ol("arrayUnion",n)}function XT(...n){return new al("arrayRemove",n)}(function(t,e=!0){(function(s){Oi=s})(Mi),bi(new Wn("firestore",((i,{instanceIdentifier:s,options:r})=>{const o=i.getProvider("app").getImmediate(),a=new Oo(new Cb(i.getProvider("auth-internal")),new Mb(o,i.getProvider("app-check-internal")),(function(h,u){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new B(O.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cs(h.options.projectId,u)})(o,s),o);return r={useFetchStreams:e,...r},a._setSettings(r),a}),"PUBLIC").setMultipleInstances(!0)),ln(iu,su,t),ln(iu,su,"esm2020")})();function Up(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QT=Up,zp=new zs("auth","Firebase",Up());const so=new kc("@firebase/auth");function JT(n,...t){so.logLevel<=X.WARN&&so.warn(`Auth (${Mi}): ${n}`,...t)}function Br(n,...t){so.logLevel<=X.ERROR&&so.error(`Auth (${Mi}): ${n}`,...t)}function Te(n,...t){throw ml(n,...t)}function ae(n,...t){return ml(n,...t)}function pl(n,t,e){const i={...QT(),[t]:e};return new zs("auth","Firebase",i).create(t,{appName:n.name})}function zn(n){return pl(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function ZT(n,t,e){const i=e;if(!(t instanceof i))throw i.name!==t.constructor.name&&Te(n,"argument-error"),pl(n,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ml(n,...t){if(typeof n!="string"){const e=t[0],i=[...t.slice(1)];return i[0]&&(i[0].appName=n.name),n._errorFactory.create(e,...i)}return zp.create(n,...t)}function H(n,t,...e){if(!n)throw ml(t,...e)}function Ce(n){const t="INTERNAL ASSERTION FAILED: "+n;throw Br(t),new Error(t)}function Be(n,t){n||Ce(t)}function mc(){return typeof self<"u"&&self.location?.href||""}function tE(){return nd()==="http:"||nd()==="https:"}function nd(){return typeof self<"u"&&self.location?.protocol||null}function eE(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tE()||ry()||"connection"in navigator)?navigator.onLine:!0}function nE(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}class Ys{constructor(t,e){this.shortDelay=t,this.longDelay=e,Be(e>t,"Short delay should be less than long delay!"),this.isMobile=ny()||oy()}get(){return eE()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function _l(n,t){Be(n.emulator,"Emulator should always be set here");const{url:e}=n.emulator;return t?`${e}${t.startsWith("/")?t.slice(1):t}`:e}class jp{static initialize(t,e,i){this.fetchImpl=t,e&&(this.headersImpl=e),i&&(this.responseImpl=i)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ce("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ce("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ce("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const iE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const sE=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],rE=new Ys(3e4,6e4);function yl(n,t){return n.tenantId&&!t.tenantId?{...t,tenantId:n.tenantId}:t}async function Bi(n,t,e,i,s={}){return Hp(n,s,async()=>{let r={},o={};i&&(t==="GET"?o=i:r={body:JSON.stringify(i)});const a=js({key:n.config.apiKey,...o}).slice(1),c=await n._getAdditionalHeaders();c["Content-Type"]="application/json",n.languageCode&&(c["X-Firebase-Locale"]=n.languageCode);const h={method:t,headers:c,...r};return sy()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Di(n.emulatorConfig.host)&&(h.credentials="include"),jp.fetch()(await Wp(n,n.config.apiHost,e,a),h)})}async function Hp(n,t,e){n._canInitEmulator=!1;const i={...iE,...t};try{const s=new aE(n),r=await Promise.race([e(),s.promise]);s.clearNetworkTimeout();const o=await r.json();if("needConfirmation"in o)throw br(n,"account-exists-with-different-credential",o);if(r.ok&&!("errorMessage"in o))return o;{const a=r.ok?o.errorMessage:o.error.message,[c,h]=a.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw br(n,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw br(n,"email-already-in-use",o);if(c==="USER_DISABLED")throw br(n,"user-disabled",o);const u=i[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw pl(n,u,h);Te(n,u)}}catch(s){if(s instanceof Ue)throw s;Te(n,"network-request-failed",{message:String(s)})}}async function oE(n,t,e,i,s={}){const r=await Bi(n,t,e,i,s);return"mfaPendingCredential"in r&&Te(n,"multi-factor-auth-required",{_serverResponse:r}),r}async function Wp(n,t,e,i){const s=`${t}${e}?${i}`,r=n,o=r.config.emulator?_l(n.config,s):`${n.config.apiScheme}://${s}`;return sE.includes(e)&&(await r._persistenceManagerAvailable,r._getPersistenceType()==="COOKIE")?r._getPersistence()._getFinalTarget(o).toString():o}class aE{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(t){this.auth=t,this.timer=null,this.promise=new Promise((e,i)=>{this.timer=setTimeout(()=>i(ae(this.auth,"network-request-failed")),rE.get())})}}function br(n,t,e){const i={appName:n.name};e.email&&(i.email=e.email),e.phoneNumber&&(i.phoneNumber=e.phoneNumber);const s=ae(n,t,i);return s.customData._tokenResponse=e,s}async function cE(n,t){return Bi(n,"POST","/v1/accounts:delete",t)}async function ro(n,t){return Bi(n,"POST","/v1/accounts:lookup",t)}function Ts(n){if(n)try{const t=new Date(Number(n));if(!isNaN(t.getTime()))return t.toUTCString()}catch{}}async function lE(n,t=!1){const e=Mt(n),i=await e.getIdToken(t),s=bl(i);H(s&&s.exp&&s.auth_time&&s.iat,e.auth,"internal-error");const r=typeof s.firebase=="object"?s.firebase:void 0,o=r?.sign_in_provider;return{claims:s,token:i,authTime:Ts(Pa(s.auth_time)),issuedAtTime:Ts(Pa(s.iat)),expirationTime:Ts(Pa(s.exp)),signInProvider:o||null,signInSecondFactor:r?.sign_in_second_factor||null}}function Pa(n){return Number(n)*1e3}function bl(n){const[t,e,i]=n.split(".");if(t===void 0||e===void 0||i===void 0)return Br("JWT malformed, contained fewer than 3 sections"),null;try{const s=Xf(e);return s?JSON.parse(s):(Br("Failed to decode base64 JWT payload"),null)}catch(s){return Br("Caught error parsing JWT payload as JSON",s?.toString()),null}}function id(n){const t=bl(n);return H(t,"internal-error"),H(typeof t.exp<"u","internal-error"),H(typeof t.iat<"u","internal-error"),Number(t.exp)-Number(t.iat)}async function Ms(n,t,e=!1){if(e)return t;try{return await t}catch(i){throw i instanceof Ue&&hE(i)&&n.auth.currentUser===n&&await n.auth.signOut(),i}}function hE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}class uE{constructor(t){this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(t){if(t){const e=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),e}else{this.errorBackoff=3e4;const i=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,i)}}schedule(t=!1){if(!this.isRunning)return;const e=this.getInterval(t);this.timerId=setTimeout(async()=>{await this.iteration()},e)}async iteration(){try{await this.user.getIdToken(!0)}catch(t){t?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class _c{constructor(t,e){this.createdAt=t,this.lastLoginAt=e,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ts(this.lastLoginAt),this.creationTime=Ts(this.createdAt)}_copy(t){this.createdAt=t.createdAt,this.lastLoginAt=t.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function oo(n){const t=n.auth,e=await n.getIdToken(),i=await Ms(n,ro(t,{idToken:e}));H(i?.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const r=s.providerUserInfo?.length?$p(s.providerUserInfo):[],o=fE(n.providerData,r),a=n.isAnonymous,c=!(n.email&&s.passwordHash)&&!o?.length,h=a?c:!1,u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new _c(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(n,u)}async function dE(n){const t=Mt(n);await oo(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}function fE(n,t){return[...n.filter(i=>!t.some(s=>s.providerId===i.providerId)),...t]}function $p(n){return n.map(({providerId:t,...e})=>({providerId:t,uid:e.rawId||"",displayName:e.displayName||null,email:e.email||null,phoneNumber:e.phoneNumber||null,photoURL:e.photoUrl||null}))}async function gE(n,t){const e=await Hp(n,{},async()=>{const i=js({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:s,apiKey:r}=n.config,o=await Wp(n,s,"/v1/token",`key=${r}`),a=await n._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:i};return n.emulatorConfig&&Di(n.emulatorConfig.host)&&(c.credentials="include"),jp.fetch()(o,c)});return{accessToken:e.access_token,expiresIn:e.expires_in,refreshToken:e.refresh_token}}async function pE(n,t){return Bi(n,"POST","/v2/accounts:revokeToken",yl(n,t))}class pi{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(t){H(t.idToken,"internal-error"),H(typeof t.idToken<"u","internal-error"),H(typeof t.refreshToken<"u","internal-error");const e="expiresIn"in t&&typeof t.expiresIn<"u"?Number(t.expiresIn):id(t.idToken);this.updateTokensAndExpiration(t.idToken,t.refreshToken,e)}updateFromIdToken(t){H(t.length!==0,"internal-error");const e=id(t);this.updateTokensAndExpiration(t,null,e)}async getToken(t,e=!1){return!e&&this.accessToken&&!this.isExpired?this.accessToken:(H(this.refreshToken,t,"user-token-expired"),this.refreshToken?(await this.refresh(t,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(t,e){const{accessToken:i,refreshToken:s,expiresIn:r}=await gE(t,e);this.updateTokensAndExpiration(i,s,Number(r))}updateTokensAndExpiration(t,e,i){this.refreshToken=e||null,this.accessToken=t||null,this.expirationTime=Date.now()+i*1e3}static fromJSON(t,e){const{refreshToken:i,accessToken:s,expirationTime:r}=e,o=new pi;return i&&(H(typeof i=="string","internal-error",{appName:t}),o.refreshToken=i),s&&(H(typeof s=="string","internal-error",{appName:t}),o.accessToken=s),r&&(H(typeof r=="number","internal-error",{appName:t}),o.expirationTime=r),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(t){this.accessToken=t.accessToken,this.refreshToken=t.refreshToken,this.expirationTime=t.expirationTime}_clone(){return Object.assign(new pi,this.toJSON())}_performRefresh(){return Ce("not implemented")}}function Xe(n,t){H(typeof n=="string"||typeof n>"u","internal-error",{appName:t})}class re{constructor({uid:t,auth:e,stsTokenManager:i,...s}){this.providerId="firebase",this.proactiveRefresh=new uE(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=e,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _c(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(t){const e=await Ms(this,this.stsTokenManager.getToken(this.auth,t));return H(e,this.auth,"internal-error"),this.accessToken!==e&&(this.accessToken=e,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),e}getIdTokenResult(t){return lE(this,t)}reload(){return dE(this)}_assign(t){this!==t&&(H(this.uid===t.uid,this.auth,"internal-error"),this.displayName=t.displayName,this.photoURL=t.photoURL,this.email=t.email,this.emailVerified=t.emailVerified,this.phoneNumber=t.phoneNumber,this.isAnonymous=t.isAnonymous,this.tenantId=t.tenantId,this.providerData=t.providerData.map(e=>({...e})),this.metadata._copy(t.metadata),this.stsTokenManager._assign(t.stsTokenManager))}_clone(t){const e=new re({...this,auth:t,stsTokenManager:this.stsTokenManager._clone()});return e.metadata._copy(this.metadata),e}_onReload(t){H(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=t,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(t){this.reloadListener?this.reloadListener(t):this.reloadUserInfo=t}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(t,e=!1){let i=!1;t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),i=!0),e&&await oo(this),await this.auth._persistUserIfCurrent(this),i&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(se(this.auth.app))return Promise.reject(zn(this.auth));const t=await this.getIdToken();return await Ms(this,cE(this.auth,{idToken:t})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(t=>({...t})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(t,e){const i=e.displayName??void 0,s=e.email??void 0,r=e.phoneNumber??void 0,o=e.photoURL??void 0,a=e.tenantId??void 0,c=e._redirectEventId??void 0,h=e.createdAt??void 0,u=e.lastLoginAt??void 0,{uid:d,emailVerified:g,isAnonymous:m,providerData:y,stsTokenManager:v}=e;H(d&&v,t,"internal-error");const w=pi.fromJSON(this.name,v);H(typeof d=="string",t,"internal-error"),Xe(i,t.name),Xe(s,t.name),H(typeof g=="boolean",t,"internal-error"),H(typeof m=="boolean",t,"internal-error"),Xe(r,t.name),Xe(o,t.name),Xe(a,t.name),Xe(c,t.name),Xe(h,t.name),Xe(u,t.name);const S=new re({uid:d,auth:t,email:s,emailVerified:g,displayName:i,isAnonymous:m,photoURL:o,phoneNumber:r,tenantId:a,stsTokenManager:w,createdAt:h,lastLoginAt:u});return y&&Array.isArray(y)&&(S.providerData=y.map(R=>({...R}))),c&&(S._redirectEventId=c),S}static async _fromIdTokenResponse(t,e,i=!1){const s=new pi;s.updateFromServerResponse(e);const r=new re({uid:e.localId,auth:t,stsTokenManager:s,isAnonymous:i});return await oo(r),r}static async _fromGetAccountInfoResponse(t,e,i){const s=e.users[0];H(s.localId!==void 0,"internal-error");const r=s.providerUserInfo!==void 0?$p(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!r?.length,a=new pi;a.updateFromIdToken(i);const c=new re({uid:s.localId,auth:t,stsTokenManager:a,isAnonymous:o}),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:r,metadata:new _c(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!r?.length};return Object.assign(c,h),c}}const sd=new Map;function ke(n){Be(n instanceof Function,"Expected a class definition");let t=sd.get(n);return t?(Be(t instanceof n,"Instance stored in cache mismatched with class"),t):(t=new n,sd.set(n,t),t)}class qp{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(t,e){this.storage[t]=e}async _get(t){const e=this.storage[t];return e===void 0?null:e}async _remove(t){delete this.storage[t]}_addListener(t,e){}_removeListener(t,e){}}qp.type="NONE";const rd=qp;function Ur(n,t,e){return`firebase:${n}:${t}:${e}`}class mi{constructor(t,e,i){this.persistence=t,this.auth=e,this.userKey=i;const{config:s,name:r}=this.auth;this.fullUserKey=Ur(this.userKey,s.apiKey,r),this.fullPersistenceKey=Ur("persistence",s.apiKey,r),this.boundEventHandler=e._onStorageEvent.bind(e),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(t){return this.persistence._set(this.fullUserKey,t.toJSON())}async getCurrentUser(){const t=await this.persistence._get(this.fullUserKey);if(!t)return null;if(typeof t=="string"){const e=await ro(this.auth,{idToken:t}).catch(()=>{});return e?re._fromGetAccountInfoResponse(this.auth,e,t):null}return re._fromJSON(this.auth,t)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(t){if(this.persistence===t)return;const e=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=t,e)return this.setCurrentUser(e)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(t,e,i="authUser"){if(!e.length)return new mi(ke(rd),t,i);const s=(await Promise.all(e.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h);let r=s[0]||ke(rd);const o=Ur(i,t.config.apiKey,t.name);let a=null;for(const h of e)try{const u=await h._get(o);if(u){let d;if(typeof u=="string"){const g=await ro(t,{idToken:u}).catch(()=>{});if(!g)break;d=await re._fromGetAccountInfoResponse(t,g,u)}else d=re._fromJSON(t,u);h!==r&&(a=d),r=h;break}}catch{}const c=s.filter(h=>h._shouldAllowMigration);return!r._shouldAllowMigration||!c.length?new mi(r,t,i):(r=c[0],a&&await r._set(o,a.toJSON()),await Promise.all(e.map(async h=>{if(h!==r)try{await h._remove(o)}catch{}})),new mi(r,t,i))}}function od(n){const t=n.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(Xp(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Gp(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Jp(t))return"Blackberry";if(Zp(t))return"Webos";if(Kp(t))return"Safari";if((t.includes("chrome/")||Yp(t))&&!t.includes("edge/"))return"Chrome";if(Qp(t))return"Android";{const e=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,i=n.match(e);if(i?.length===2)return i[1]}return"Other"}function Gp(n=Ht()){return/firefox\//i.test(n)}function Kp(n=Ht()){const t=n.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Yp(n=Ht()){return/crios\//i.test(n)}function Xp(n=Ht()){return/iemobile/i.test(n)}function Qp(n=Ht()){return/android/i.test(n)}function Jp(n=Ht()){return/blackberry/i.test(n)}function Zp(n=Ht()){return/webos/i.test(n)}function vl(n=Ht()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function mE(n=Ht()){return vl(n)&&!!window.navigator?.standalone}function _E(){return ay()&&document.documentMode===10}function tm(n=Ht()){return vl(n)||Qp(n)||Zp(n)||Jp(n)||/windows phone/i.test(n)||Xp(n)}function em(n,t=[]){let e;switch(n){case"Browser":e=od(Ht());break;case"Worker":e=`${od(Ht())}-${n}`;break;default:e=n}const i=t.length?t.join(","):"FirebaseCore-web";return`${e}/JsCore/${Mi}/${i}`}class yE{constructor(t){this.auth=t,this.queue=[]}pushCallback(t,e){const i=r=>new Promise((o,a)=>{try{const c=t(r);o(c)}catch(c){a(c)}});i.onAbort=e,this.queue.push(i);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(t){if(this.auth.currentUser===t)return;const e=[];try{for(const i of this.queue)await i(t),i.onAbort&&e.push(i.onAbort)}catch(i){e.reverse();for(const s of e)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:i?.message})}}}async function bE(n,t={}){return Bi(n,"GET","/v2/passwordPolicy",yl(n,t))}const vE=6;class wE{constructor(t){const e=t.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=e.minPasswordLength??vE,e.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=e.maxPasswordLength),e.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=e.containsLowercaseCharacter),e.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=e.containsUppercaseCharacter),e.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=e.containsNumericCharacter),e.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=e.containsNonAlphanumericCharacter),this.enforcementState=t.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=t.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=t.forceUpgradeOnSignin??!1,this.schemaVersion=t.schemaVersion}validatePassword(t){const e={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(t,e),this.validatePasswordCharacterOptions(t,e),e.isValid&&(e.isValid=e.meetsMinPasswordLength??!0),e.isValid&&(e.isValid=e.meetsMaxPasswordLength??!0),e.isValid&&(e.isValid=e.containsLowercaseLetter??!0),e.isValid&&(e.isValid=e.containsUppercaseLetter??!0),e.isValid&&(e.isValid=e.containsNumericCharacter??!0),e.isValid&&(e.isValid=e.containsNonAlphanumericCharacter??!0),e}validatePasswordLengthOptions(t,e){const i=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;i&&(e.meetsMinPasswordLength=t.length>=i),s&&(e.meetsMaxPasswordLength=t.length<=s)}validatePasswordCharacterOptions(t,e){this.updatePasswordCharacterOptionsStatuses(e,!1,!1,!1,!1);let i;for(let s=0;s<t.length;s++)i=t.charAt(s),this.updatePasswordCharacterOptionsStatuses(e,i>="a"&&i<="z",i>="A"&&i<="Z",i>="0"&&i<="9",this.allowedNonAlphanumericCharacters.includes(i))}updatePasswordCharacterOptionsStatuses(t,e,i,s,r){this.customStrengthOptions.containsLowercaseLetter&&(t.containsLowercaseLetter||(t.containsLowercaseLetter=e)),this.customStrengthOptions.containsUppercaseLetter&&(t.containsUppercaseLetter||(t.containsUppercaseLetter=i)),this.customStrengthOptions.containsNumericCharacter&&(t.containsNumericCharacter||(t.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(t.containsNonAlphanumericCharacter||(t.containsNonAlphanumericCharacter=r))}}class TE{constructor(t,e,i,s){this.app=t,this.heartbeatServiceProvider=e,this.appCheckServiceProvider=i,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ad(this),this.idTokenSubscription=new ad(this),this.beforeStateQueue=new yE(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=zp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(r=>this._resolvePersistenceManagerAvailable=r)}_initializeWithPersistence(t,e){return e&&(this._popupRedirectResolver=ke(e)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await mi.create(this,t),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(e),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const t=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!t)){if(this.currentUser&&t&&this.currentUser.uid===t.uid){this._currentUser._assign(t),await this.currentUser.getIdToken();return}await this._updateCurrentUser(t,!0)}}async initializeCurrentUserFromIdToken(t){try{const e=await ro(this,{idToken:t}),i=await re._fromGetAccountInfoResponse(this,e,t);await this.directlySetCurrentUser(i)}catch(e){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",e),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(t){if(se(this.app)){const r=this.app.settings.authIdToken;return r?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(r).then(o,o))}):this.directlySetCurrentUser(null)}const e=await this.assertedPersistence.getCurrentUser();let i=e,s=!1;if(t&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=this.redirectUser?._redirectEventId,o=i?._redirectEventId,a=await this.tryRedirectSignIn(t);(!r||r===o)&&a?.user&&(i=a.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(r){i=e,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(r))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return H(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(t){let e=null;try{e=await this._popupRedirectResolver._completeRedirectFn(this,t,!0)}catch{await this._setRedirectUser(null)}return e}async reloadAndSetCurrentUserOrClear(t){try{await oo(t)}catch(e){if(e?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(t)}useDeviceLanguage(){this.languageCode=nE()}async _delete(){this._deleted=!0}async updateCurrentUser(t){if(se(this.app))return Promise.reject(zn(this));const e=t?Mt(t):null;return e&&H(e.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(e&&e._clone(this))}async _updateCurrentUser(t,e=!1){if(!this._deleted)return t&&H(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),e||await this.beforeStateQueue.runMiddleware(t),this.queue(async()=>{await this.directlySetCurrentUser(t),this.notifyAuthListeners()})}async signOut(){return se(this.app)?Promise.reject(zn(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(t){return se(this.app)?Promise.reject(zn(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ke(t))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(t){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const e=this._getPasswordPolicyInternal();return e.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):e.validatePassword(t)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const t=await bE(this),e=new wE(t);this.tenantId===null?this._projectPasswordPolicy=e:this._tenantPasswordPolicies[this.tenantId]=e}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(t){this._errorFactory=new zs("auth","Firebase",t())}onAuthStateChanged(t,e,i){return this.registerStateListener(this.authStateSubscription,t,e,i)}beforeAuthStateChanged(t,e){return this.beforeStateQueue.pushCallback(t,e)}onIdTokenChanged(t,e,i){return this.registerStateListener(this.idTokenSubscription,t,e,i)}authStateReady(){return new Promise((t,e)=>{if(this.currentUser)t();else{const i=this.onAuthStateChanged(()=>{i(),t()},e)}})}async revokeAccessToken(t){if(this.currentUser){const e=await this.currentUser.getIdToken(),i={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:t,idToken:e};this.tenantId!=null&&(i.tenantId=this.tenantId),await pE(this,i)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(t,e){const i=await this.getOrInitRedirectPersistenceManager(e);return t===null?i.removeCurrentUser():i.setCurrentUser(t)}async getOrInitRedirectPersistenceManager(t){if(!this.redirectPersistenceManager){const e=t&&ke(t)||this._popupRedirectResolver;H(e,this,"argument-error"),this.redirectPersistenceManager=await mi.create(this,[ke(e._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(t){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===t?this._currentUser:this.redirectUser?._redirectEventId===t?this.redirectUser:null}async _persistUserIfCurrent(t){if(t===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(t))}_notifyListenersIfCurrent(t){t===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const t=this.currentUser?.uid??null;this.lastNotifiedUid!==t&&(this.lastNotifiedUid=t,this.authStateSubscription.next(this.currentUser))}registerStateListener(t,e,i,s){if(this._deleted)return()=>{};const r=typeof e=="function"?e:e.next.bind(e);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(H(a,this,"internal-error"),a.then(()=>{o||r(this.currentUser)}),typeof e=="function"){const c=t.addObserver(e,i,s);return()=>{o=!0,c()}}else{const c=t.addObserver(e);return()=>{o=!0,c()}}}async directlySetCurrentUser(t){this.currentUser&&this.currentUser!==t&&this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh(),this.currentUser=t,t?await this.assertedPersistence.setCurrentUser(t):await this.assertedPersistence.removeCurrentUser()}queue(t){return this.operations=this.operations.then(t,t),this.operations}get assertedPersistence(){return H(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(t){!t||this.frameworks.includes(t)||(this.frameworks.push(t),this.frameworks.sort(),this.clientVersion=em(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const e=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();e&&(t["X-Firebase-Client"]=e);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){if(se(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return t?.error&&JT(`Error while retrieving App Check token: ${t.error}`),t?.token}}function Fo(n){return Mt(n)}class ad{constructor(t){this.auth=t,this.observer=null,this.addObserver=py(e=>this.observer=e)}get next(){return H(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let wl={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EE(n){wl=n}function IE(n){return wl.loadJS(n)}function AE(){return wl.gapiScript}function xE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function SE(n,t){const e=Mc(n,"auth");if(e.isInitialized()){const s=e.getImmediate(),r=e.getOptions();if(Ve(r,t??{}))return s;Te(s,"already-initialized")}return e.initialize({options:t})}function PE(n,t){const e=t?.persistence||[],i=(Array.isArray(e)?e:[e]).map(ke);t?.errorMap&&n._updateErrorMap(t.errorMap),n._initializeWithPersistence(i,t?.popupRedirectResolver)}function RE(n,t,e){const i=Fo(n);H(/^https?:\/\//.test(t),i,"invalid-emulator-scheme");const s=!1,r=nm(t),{host:o,port:a}=CE(t),c=a===null?"":`:${a}`,h={url:`${r}//${o}${c}/`},u=Object.freeze({host:o,port:a,protocol:r.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!i._canInitEmulator){H(i.config.emulator&&i.emulatorConfig,i,"emulator-config-failed"),H(Ve(h,i.config.emulator)&&Ve(u,i.emulatorConfig),i,"emulator-config-failed");return}i.config.emulator=h,i.emulatorConfig=u,i.settings.appVerificationDisabledForTesting=!0,Di(o)?(tg(`${r}//${o}${c}`),eg("Auth",!0)):kE()}function nm(n){const t=n.indexOf(":");return t<0?"":n.substr(0,t+1)}function CE(n){const t=nm(n),e=/(\/\/)?([^?#/]+)/.exec(n.substr(t.length));if(!e)return{host:"",port:null};const i=e[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(i);if(s){const r=s[1];return{host:r,port:cd(i.substr(r.length+1))}}else{const[r,o]=i.split(":");return{host:r,port:cd(o)}}}function cd(n){if(!n)return null;const t=Number(n);return isNaN(t)?null:t}function kE(){function n(){const t=document.createElement("p"),e=t.style;t.innerText="Running in emulator mode. Do not use with production credentials.",e.position="fixed",e.width="100%",e.backgroundColor="#ffffff",e.border=".1em solid #000000",e.color="#b50000",e.bottom="0px",e.left="0px",e.margin="0px",e.zIndex="10000",e.textAlign="center",t.classList.add("firebase-emulator-warning"),document.body.appendChild(t)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}class im{constructor(t,e){this.providerId=t,this.signInMethod=e}toJSON(){return Ce("not implemented")}_getIdTokenResponse(t){return Ce("not implemented")}_linkToIdToken(t,e){return Ce("not implemented")}_getReauthenticationResolver(t){return Ce("not implemented")}}async function _i(n,t){return oE(n,"POST","/v1/accounts:signInWithIdp",yl(n,t))}const DE="http://localhost";class Kn extends im{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(t){const e=new Kn(t.providerId,t.signInMethod);return t.idToken||t.accessToken?(t.idToken&&(e.idToken=t.idToken),t.accessToken&&(e.accessToken=t.accessToken),t.nonce&&!t.pendingToken&&(e.nonce=t.nonce),t.pendingToken&&(e.pendingToken=t.pendingToken)):t.oauthToken&&t.oauthTokenSecret?(e.accessToken=t.oauthToken,e.secret=t.oauthTokenSecret):Te("argument-error"),e}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(t){const e=typeof t=="string"?JSON.parse(t):t,{providerId:i,signInMethod:s,...r}=e;if(!i||!s)return null;const o=new Kn(i,s);return o.idToken=r.idToken||void 0,o.accessToken=r.accessToken||void 0,o.secret=r.secret,o.nonce=r.nonce,o.pendingToken=r.pendingToken||null,o}_getIdTokenResponse(t){const e=this.buildRequest();return _i(t,e)}_linkToIdToken(t,e){const i=this.buildRequest();return i.idToken=e,_i(t,i)}_getReauthenticationResolver(t){const e=this.buildRequest();return e.autoCreate=!1,_i(t,e)}buildRequest(){const t={requestUri:DE,returnSecureToken:!0};if(this.pendingToken)t.pendingToken=this.pendingToken;else{const e={};this.idToken&&(e.id_token=this.idToken),this.accessToken&&(e.access_token=this.accessToken),this.secret&&(e.oauth_token_secret=this.secret),e.providerId=this.providerId,this.nonce&&!this.pendingToken&&(e.nonce=this.nonce),t.postBody=js(e)}return t}}class Tl{constructor(t){this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(t){this.defaultLanguageCode=t}setCustomParameters(t){return this.customParameters=t,this}getCustomParameters(){return this.customParameters}}class Xs extends Tl{constructor(){super(...arguments),this.scopes=[]}addScope(t){return this.scopes.includes(t)||this.scopes.push(t),this}getScopes(){return[...this.scopes]}}class Je extends Xs{constructor(){super("facebook.com")}static credential(t){return Kn._fromParams({providerId:Je.PROVIDER_ID,signInMethod:Je.FACEBOOK_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Je.credentialFromTaggedObject(t)}static credentialFromError(t){return Je.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Je.credential(t.oauthAccessToken)}catch{return null}}}Je.FACEBOOK_SIGN_IN_METHOD="facebook.com";Je.PROVIDER_ID="facebook.com";class Re extends Xs{constructor(){super("google.com"),this.addScope("profile")}static credential(t,e){return Kn._fromParams({providerId:Re.PROVIDER_ID,signInMethod:Re.GOOGLE_SIGN_IN_METHOD,idToken:t,accessToken:e})}static credentialFromResult(t){return Re.credentialFromTaggedObject(t)}static credentialFromError(t){return Re.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthIdToken:e,oauthAccessToken:i}=t;if(!e&&!i)return null;try{return Re.credential(e,i)}catch{return null}}}Re.GOOGLE_SIGN_IN_METHOD="google.com";Re.PROVIDER_ID="google.com";class Ze extends Xs{constructor(){super("github.com")}static credential(t){return Kn._fromParams({providerId:Ze.PROVIDER_ID,signInMethod:Ze.GITHUB_SIGN_IN_METHOD,accessToken:t})}static credentialFromResult(t){return Ze.credentialFromTaggedObject(t)}static credentialFromError(t){return Ze.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t||!("oauthAccessToken"in t)||!t.oauthAccessToken)return null;try{return Ze.credential(t.oauthAccessToken)}catch{return null}}}Ze.GITHUB_SIGN_IN_METHOD="github.com";Ze.PROVIDER_ID="github.com";class tn extends Xs{constructor(){super("twitter.com")}static credential(t,e){return Kn._fromParams({providerId:tn.PROVIDER_ID,signInMethod:tn.TWITTER_SIGN_IN_METHOD,oauthToken:t,oauthTokenSecret:e})}static credentialFromResult(t){return tn.credentialFromTaggedObject(t)}static credentialFromError(t){return tn.credentialFromTaggedObject(t.customData||{})}static credentialFromTaggedObject({_tokenResponse:t}){if(!t)return null;const{oauthAccessToken:e,oauthTokenSecret:i}=t;if(!e||!i)return null;try{return tn.credential(e,i)}catch{return null}}}tn.TWITTER_SIGN_IN_METHOD="twitter.com";tn.PROVIDER_ID="twitter.com";class Pi{constructor(t){this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}static async _fromIdTokenResponse(t,e,i,s=!1){const r=await re._fromIdTokenResponse(t,i,s),o=ld(i);return new Pi({user:r,providerId:o,_tokenResponse:i,operationType:e})}static async _forOperation(t,e,i){await t._updateTokensIfNecessary(i,!0);const s=ld(i);return new Pi({user:t,providerId:s,_tokenResponse:i,operationType:e})}}function ld(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}class ao extends Ue{constructor(t,e,i,s){super(e.code,e.message),this.operationType=i,this.user=s,Object.setPrototypeOf(this,ao.prototype),this.customData={appName:t.name,tenantId:t.tenantId??void 0,_serverResponse:e.customData._serverResponse,operationType:i}}static _fromErrorAndOperation(t,e,i,s){return new ao(t,e,i,s)}}function sm(n,t,e,i){return(t==="reauthenticate"?e._getReauthenticationResolver(n):e._getIdTokenResponse(n)).catch(r=>{throw r.code==="auth/multi-factor-auth-required"?ao._fromErrorAndOperation(n,r,t,i):r})}async function ME(n,t,e=!1){const i=await Ms(n,t._linkToIdToken(n.auth,await n.getIdToken()),e);return Pi._forOperation(n,"link",i)}async function OE(n,t,e=!1){const{auth:i}=n;if(se(i.app))return Promise.reject(zn(i));const s="reauthenticate";try{const r=await Ms(n,sm(i,s,t,n),e);H(r.idToken,i,"internal-error");const o=bl(r.idToken);H(o,i,"internal-error");const{sub:a}=o;return H(n.uid===a,i,"user-mismatch"),Pi._forOperation(n,s,r)}catch(r){throw r?.code==="auth/user-not-found"&&Te(i,"user-mismatch"),r}}async function VE(n,t,e=!1){if(se(n.app))return Promise.reject(zn(n));const i="signIn",s=await sm(n,i,t),r=await Pi._fromIdTokenResponse(n,i,s);return e||await n._updateCurrentUser(r.user),r}function NE(n,t,e,i){return Mt(n).onIdTokenChanged(t,e,i)}function LE(n,t,e){return Mt(n).beforeAuthStateChanged(t,e)}function FE(n,t,e,i){return Mt(n).onAuthStateChanged(t,e,i)}function BE(n){return Mt(n).signOut()}const co="__sak";class rm{constructor(t,e){this.storageRetriever=t,this.type=e}_isAvailable(){try{return this.storage?(this.storage.setItem(co,"1"),this.storage.removeItem(co),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(t,e){return this.storage.setItem(t,JSON.stringify(e)),Promise.resolve()}_get(t){const e=this.storage.getItem(t);return Promise.resolve(e?JSON.parse(e):null)}_remove(t){return this.storage.removeItem(t),Promise.resolve()}get storage(){return this.storageRetriever()}}const UE=1e3,zE=10;class om extends rm{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(t,e)=>this.onStorageEvent(t,e),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tm(),this._shouldAllowMigration=!0}forAllChangedKeys(t){for(const e of Object.keys(this.listeners)){const i=this.storage.getItem(e),s=this.localCache[e];i!==s&&t(e,s,i)}}onStorageEvent(t,e=!1){if(!t.key){this.forAllChangedKeys((o,a,c)=>{this.notifyListeners(o,c)});return}const i=t.key;e?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(i);!e&&this.localCache[i]===o||this.notifyListeners(i,o)},r=this.storage.getItem(i);_E()&&r!==t.newValue&&t.newValue!==t.oldValue?setTimeout(s,zE):s()}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e&&JSON.parse(e))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((t,e,i)=>{this.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:e,newValue:i}),!0)})},UE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(t,e){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[t]||(this.listeners[t]=new Set,this.localCache[t]=this.storage.getItem(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(t,e){await super._set(t,e),this.localCache[t]=JSON.stringify(e)}async _get(t){const e=await super._get(t);return this.localCache[t]=JSON.stringify(e),e}async _remove(t){await super._remove(t),delete this.localCache[t]}}om.type="LOCAL";const jE=om;class am extends rm{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(t,e){}_removeListener(t,e){}}am.type="SESSION";const cm=am;function HE(n){return Promise.all(n.map(async t=>{try{return{fulfilled:!0,value:await t}}catch(e){return{fulfilled:!1,reason:e}}}))}class Bo{constructor(t){this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(t){const e=this.receivers.find(s=>s.isListeningto(t));if(e)return e;const i=new Bo(t);return this.receivers.push(i),i}isListeningto(t){return this.eventTarget===t}async handleEvent(t){const e=t,{eventId:i,eventType:s,data:r}=e.data,o=this.handlersMap[s];if(!o?.size)return;e.ports[0].postMessage({status:"ack",eventId:i,eventType:s});const a=Array.from(o).map(async h=>h(e.origin,r)),c=await HE(a);e.ports[0].postMessage({status:"done",eventId:i,eventType:s,response:c})}_subscribe(t,e){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[t]||(this.handlersMap[t]=new Set),this.handlersMap[t].add(e)}_unsubscribe(t,e){this.handlersMap[t]&&e&&this.handlersMap[t].delete(e),(!e||this.handlersMap[t].size===0)&&delete this.handlersMap[t],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Bo.receivers=[];function El(n="",t=10){let e="";for(let i=0;i<t;i++)e+=Math.floor(Math.random()*10);return n+e}class WE{constructor(t){this.target=t,this.handlers=new Set}removeMessageHandler(t){t.messageChannel&&(t.messageChannel.port1.removeEventListener("message",t.onMessage),t.messageChannel.port1.close()),this.handlers.delete(t)}async _send(t,e,i=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let r,o;return new Promise((a,c)=>{const h=El("",20);s.port1.start();const u=setTimeout(()=>{c(new Error("unsupported_event"))},i);o={messageChannel:s,onMessage(d){const g=d;if(g.data.eventId===h)switch(g.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(r),a(g.data.response);break;default:clearTimeout(u),clearTimeout(r),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:t,eventId:h,data:e},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}function be(){return window}function $E(n){be().location.href=n}function lm(){return typeof be().WorkerGlobalScope<"u"&&typeof be().importScripts=="function"}async function qE(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function GE(){return navigator?.serviceWorker?.controller||null}function KE(){return lm()?self:null}const hm="firebaseLocalStorageDb",YE=1,lo="firebaseLocalStorage",um="fbase_key";class Qs{constructor(t){this.request=t}toPromise(){return new Promise((t,e)=>{this.request.addEventListener("success",()=>{t(this.request.result)}),this.request.addEventListener("error",()=>{e(this.request.error)})})}}function Uo(n,t){return n.transaction([lo],t?"readwrite":"readonly").objectStore(lo)}function XE(){const n=indexedDB.deleteDatabase(hm);return new Qs(n).toPromise()}function yc(){const n=indexedDB.open(hm,YE);return new Promise((t,e)=>{n.addEventListener("error",()=>{e(n.error)}),n.addEventListener("upgradeneeded",()=>{const i=n.result;try{i.createObjectStore(lo,{keyPath:um})}catch(s){e(s)}}),n.addEventListener("success",async()=>{const i=n.result;i.objectStoreNames.contains(lo)?t(i):(i.close(),await XE(),t(await yc()))})})}async function hd(n,t,e){const i=Uo(n,!0).put({[um]:t,value:e});return new Qs(i).toPromise()}async function QE(n,t){const e=Uo(n,!1).get(t),i=await new Qs(e).toPromise();return i===void 0?null:i.value}function ud(n,t){const e=Uo(n,!0).delete(t);return new Qs(e).toPromise()}const JE=800,ZE=3;class dm{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await yc(),this.db)}async _withRetries(t){let e=0;for(;;)try{const i=await this._openDb();return await t(i)}catch(i){if(e++>ZE)throw i;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return lm()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Bo._getInstance(KE()),this.receiver._subscribe("keyChanged",async(t,e)=>({keyProcessed:(await this._poll()).includes(e.key)})),this.receiver._subscribe("ping",async(t,e)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await qE(),!this.activeServiceWorker)return;this.sender=new WE(this.activeServiceWorker);const t=await this.sender._send("ping",{},800);t&&t[0]?.fulfilled&&t[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(t){if(!(!this.sender||!this.activeServiceWorker||GE()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const t=await yc();return await hd(t,co,"1"),await ud(t,co),!0}catch{}return!1}async _withPendingWrite(t){this.pendingWrites++;try{await t()}finally{this.pendingWrites--}}async _set(t,e){return this._withPendingWrite(async()=>(await this._withRetries(i=>hd(i,t,e)),this.localCache[t]=e,this.notifyServiceWorker(t)))}async _get(t){const e=await this._withRetries(i=>QE(i,t));return this.localCache[t]=e,e}async _remove(t){return this._withPendingWrite(async()=>(await this._withRetries(e=>ud(e,t)),delete this.localCache[t],this.notifyServiceWorker(t)))}async _poll(){const t=await this._withRetries(s=>{const r=Uo(s,!1).getAll();return new Qs(r).toPromise()});if(!t)return[];if(this.pendingWrites!==0)return[];const e=[],i=new Set;if(t.length!==0)for(const{fbase_key:s,value:r}of t)i.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(r)&&(this.notifyListeners(s,r),e.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!i.has(s)&&(this.notifyListeners(s,null),e.push(s));return e}notifyListeners(t,e){this.localCache[t]=e;const i=this.listeners[t];if(i)for(const s of Array.from(i))s(e)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),JE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(t,e){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[t]||(this.listeners[t]=new Set,this._get(t)),this.listeners[t].add(e)}_removeListener(t,e){this.listeners[t]&&(this.listeners[t].delete(e),this.listeners[t].size===0&&delete this.listeners[t]),Object.keys(this.listeners).length===0&&this.stopPolling()}}dm.type="LOCAL";const t0=dm;new Ys(3e4,6e4);function fm(n,t){return t?ke(t):(H(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}class Il extends im{constructor(t){super("custom","custom"),this.params=t}_getIdTokenResponse(t){return _i(t,this._buildIdpRequest())}_linkToIdToken(t,e){return _i(t,this._buildIdpRequest(e))}_getReauthenticationResolver(t){return _i(t,this._buildIdpRequest())}_buildIdpRequest(t){const e={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return t&&(e.idToken=t),e}}function e0(n){return VE(n.auth,new Il(n),n.bypassAuthState)}function n0(n){const{auth:t,user:e}=n;return H(e,t,"internal-error"),OE(e,new Il(n),n.bypassAuthState)}async function i0(n){const{auth:t,user:e}=n;return H(e,t,"internal-error"),ME(e,new Il(n),n.bypassAuthState)}class gm{constructor(t,e,i,s,r=!1){this.auth=t,this.resolver=i,this.user=s,this.bypassAuthState=r,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(e)?e:[e]}execute(){return new Promise(async(t,e)=>{this.pendingPromise={resolve:t,reject:e};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(i){this.reject(i)}})}async onAuthEvent(t){const{urlResponse:e,sessionId:i,postBody:s,tenantId:r,error:o,type:a}=t;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:e,sessionId:i,tenantId:r||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(c))}catch(h){this.reject(h)}}onError(t){this.reject(t)}getIdpTask(t){switch(t){case"signInViaPopup":case"signInViaRedirect":return e0;case"linkViaPopup":case"linkViaRedirect":return i0;case"reauthViaPopup":case"reauthViaRedirect":return n0;default:Te(this.auth,"internal-error")}}resolve(t){Be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(t),this.unregisterAndCleanUp()}reject(t){Be(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(t),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const s0=new Ys(2e3,1e4);async function r0(n,t,e){if(se(n.app))return Promise.reject(ae(n,"operation-not-supported-in-this-environment"));const i=Fo(n);ZT(n,t,Tl);const s=fm(i,e);return new Un(i,"signInViaPopup",t,s).executeNotNull()}class Un extends gm{constructor(t,e,i,s,r){super(t,e,s,r),this.provider=i,this.authWindow=null,this.pollId=null,Un.currentPopupAction&&Un.currentPopupAction.cancel(),Un.currentPopupAction=this}async executeNotNull(){const t=await this.execute();return H(t,this.auth,"internal-error"),t}async onExecution(){Be(this.filter.length===1,"Popup operations only handle one event");const t=El();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],t),this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(ae(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ae(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Un.currentPopupAction=null}pollUserCancellation(){const t=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ae(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(t,s0.get())};t()}}Un.currentPopupAction=null;const o0="pendingRedirect",zr=new Map;class a0 extends gm{constructor(t,e,i=!1){super(t,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],e,void 0,i),this.eventId=null}async execute(){let t=zr.get(this.auth._key());if(!t){try{const i=await c0(this.resolver,this.auth)?await super.execute():null;t=()=>Promise.resolve(i)}catch(e){t=()=>Promise.reject(e)}zr.set(this.auth._key(),t)}return this.bypassAuthState||zr.set(this.auth._key(),()=>Promise.resolve(null)),t()}async onAuthEvent(t){if(t.type==="signInViaRedirect")return super.onAuthEvent(t);if(t.type==="unknown"){this.resolve(null);return}if(t.eventId){const e=await this.auth._redirectUserForId(t.eventId);if(e)return this.user=e,super.onAuthEvent(t);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function c0(n,t){const e=u0(t),i=h0(n);if(!await i._isAvailable())return!1;const s=await i._get(e)==="true";return await i._remove(e),s}function l0(n,t){zr.set(n._key(),t)}function h0(n){return ke(n._redirectPersistence)}function u0(n){return Ur(o0,n.config.apiKey,n.name)}async function d0(n,t,e=!1){if(se(n.app))return Promise.reject(zn(n));const i=Fo(n),s=fm(i,t),o=await new a0(i,s,e).execute();return o&&!e&&(delete o.user._redirectEventId,await i._persistUserIfCurrent(o.user),await i._setRedirectUser(null,t)),o}const f0=600*1e3;class g0{constructor(t){this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(t){this.consumers.add(t),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,t)&&(this.sendToConsumer(this.queuedRedirectEvent,t),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(t){this.consumers.delete(t)}onEvent(t){if(this.hasEventBeenHandled(t))return!1;let e=!1;return this.consumers.forEach(i=>{this.isEventForConsumer(t,i)&&(e=!0,this.sendToConsumer(t,i),this.saveEventToCache(t))}),this.hasHandledPotentialRedirect||!p0(t)||(this.hasHandledPotentialRedirect=!0,e||(this.queuedRedirectEvent=t,e=!0)),e}sendToConsumer(t,e){if(t.error&&!pm(t)){const i=t.error.code?.split("auth/")[1]||"internal-error";e.onError(ae(this.auth,i))}else e.onAuthEvent(t)}isEventForConsumer(t,e){const i=e.eventId===null||!!t.eventId&&t.eventId===e.eventId;return e.filter.includes(t.type)&&i}hasEventBeenHandled(t){return Date.now()-this.lastProcessedEventTime>=f0&&this.cachedEventUids.clear(),this.cachedEventUids.has(dd(t))}saveEventToCache(t){this.cachedEventUids.add(dd(t)),this.lastProcessedEventTime=Date.now()}}function dd(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(t=>t).join("-")}function pm({type:n,error:t}){return n==="unknown"&&t?.code==="auth/no-auth-event"}function p0(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return pm(n);default:return!1}}async function m0(n,t={}){return Bi(n,"GET","/v1/projects",t)}const _0=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,y0=/^https?/;async function b0(n){if(n.config.emulator)return;const{authorizedDomains:t}=await m0(n);for(const e of t)try{if(v0(e))return}catch{}Te(n,"unauthorized-domain")}function v0(n){const t=mc(),{protocol:e,hostname:i}=new URL(t);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&i===""?e==="chrome-extension:"&&n.replace("chrome-extension://","")===t.replace("chrome-extension://",""):e==="chrome-extension:"&&o.hostname===i}if(!y0.test(e))return!1;if(_0.test(n))return i===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(i)}const w0=new Ys(3e4,6e4);function fd(){const n=be().___jsl;if(n?.H){for(const t of Object.keys(n.H))if(n.H[t].r=n.H[t].r||[],n.H[t].L=n.H[t].L||[],n.H[t].r=[...n.H[t].L],n.CP)for(let e=0;e<n.CP.length;e++)n.CP[e]=null}}function T0(n){return new Promise((t,e)=>{function i(){fd(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{fd(),e(ae(n,"network-request-failed"))},timeout:w0.get()})}if(be().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else if(be().gapi?.load)i();else{const s=xE("iframefcb");return be()[s]=()=>{gapi.load?i():e(ae(n,"network-request-failed"))},IE(`${AE()}?onload=${s}`).catch(r=>e(r))}}).catch(t=>{throw jr=null,t})}let jr=null;function E0(n){return jr=jr||T0(n),jr}const I0=new Ys(5e3,15e3),A0="__/auth/iframe",x0="emulator/auth/iframe",S0={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},P0=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function R0(n){const t=n.config;H(t.authDomain,n,"auth-domain-config-required");const e=t.emulator?_l(t,x0):`https://${n.config.authDomain}/${A0}`,i={apiKey:t.apiKey,appName:n.name,v:Mi},s=P0.get(n.config.apiHost);s&&(i.eid=s);const r=n._getFrameworks();return r.length&&(i.fw=r.join(",")),`${e}?${js(i).slice(1)}`}async function C0(n){const t=await E0(n),e=be().gapi;return H(e,n,"internal-error"),t.open({where:document.body,url:R0(n),messageHandlersFilter:e.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:S0,dontclear:!0},i=>new Promise(async(s,r)=>{await i.restyle({setHideOnLeave:!1});const o=ae(n,"network-request-failed"),a=be().setTimeout(()=>{r(o)},I0.get());function c(){be().clearTimeout(a),s(i)}i.ping(c).then(c,()=>{r(o)})}))}const k0={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},D0=500,M0=600,O0="_blank",V0="http://localhost";class gd{constructor(t){this.window=t,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function N0(n,t,e,i=D0,s=M0){const r=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-i)/2,0).toString();let a="";const c={...k0,width:i.toString(),height:s.toString(),top:r,left:o},h=Ht().toLowerCase();e&&(a=Yp(h)?O0:e),Gp(h)&&(t=t||V0,c.scrollbars="yes");const u=Object.entries(c).reduce((g,[m,y])=>`${g}${m}=${y},`,"");if(mE(h)&&a!=="_self")return L0(t||"",a),new gd(null);const d=window.open(t||"",a,u);H(d,n,"popup-blocked");try{d.focus()}catch{}return new gd(d)}function L0(n,t){const e=document.createElement("a");e.href=n,e.target=t;const i=document.createEvent("MouseEvent");i.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),e.dispatchEvent(i)}const F0="__/auth/handler",B0="emulator/auth/handler",U0=encodeURIComponent("fac");async function pd(n,t,e,i,s,r){H(n.config.authDomain,n,"auth-domain-config-required"),H(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:e,redirectUrl:i,v:Mi,eventId:s};if(t instanceof Tl){t.setDefaultLanguage(n.languageCode),o.providerId=t.providerId||"",gy(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[u,d]of Object.entries({}))o[u]=d}if(t instanceof Xs){const u=t.getScopes().filter(d=>d!=="");u.length>0&&(o.scopes=u.join(","))}n.tenantId&&(o.tid=n.tenantId);const a=o;for(const u of Object.keys(a))a[u]===void 0&&delete a[u];const c=await n._getAppCheckToken(),h=c?`#${U0}=${encodeURIComponent(c)}`:"";return`${z0(n)}?${js(a).slice(1)}${h}`}function z0({config:n}){return n.emulator?_l(n,B0):`https://${n.authDomain}/${F0}`}const Ra="webStorageSupport";class j0{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=cm,this._completeRedirectFn=d0,this._overrideRedirectResult=l0}async _openPopup(t,e,i,s){Be(this.eventManagers[t._key()]?.manager,"_initialize() not called before _openPopup()");const r=await pd(t,e,i,mc(),s);return N0(t,r,El())}async _openRedirect(t,e,i,s){await this._originValidation(t);const r=await pd(t,e,i,mc(),s);return $E(r),new Promise(()=>{})}_initialize(t){const e=t._key();if(this.eventManagers[e]){const{manager:s,promise:r}=this.eventManagers[e];return s?Promise.resolve(s):(Be(r,"If manager is not set, promise should be"),r)}const i=this.initAndGetManager(t);return this.eventManagers[e]={promise:i},i.catch(()=>{delete this.eventManagers[e]}),i}async initAndGetManager(t){const e=await C0(t),i=new g0(t);return e.register("authEvent",s=>(H(s?.authEvent,t,"invalid-auth-event"),{status:i.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:i},this.iframes[t._key()]=e,i}_isIframeWebStorageSupported(t,e){this.iframes[t._key()].send(Ra,{type:Ra},s=>{const r=s?.[0]?.[Ra];r!==void 0&&e(!!r),Te(t,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(t){const e=t._key();return this.originValidationPromises[e]||(this.originValidationPromises[e]=b0(t)),this.originValidationPromises[e]}get _shouldInitProactively(){return tm()||Kp()||vl()}}const H0=j0;var md="@firebase/auth",_d="1.11.1";class W0{constructor(t){this.auth=t,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(t){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(t)}:null}addAuthTokenListener(t){if(this.assertAuthConfigured(),this.internalListeners.has(t))return;const e=this.auth.onIdTokenChanged(i=>{t(i?.stsTokenManager.accessToken||null)});this.internalListeners.set(t,e),this.updateProactiveRefresh()}removeAuthTokenListener(t){this.assertAuthConfigured();const e=this.internalListeners.get(t);e&&(this.internalListeners.delete(t),e(),this.updateProactiveRefresh())}assertAuthConfigured(){H(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function $0(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function q0(n){bi(new Wn("auth",(t,{options:e})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider("heartbeat"),r=t.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=i.options;H(o&&!o.includes(":"),"invalid-api-key",{appName:i.name});const c={apiKey:o,authDomain:a,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:em(n)},h=new TE(i,s,r,c);return PE(h,e),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,i)=>{t.getProvider("auth-internal").initialize()})),bi(new Wn("auth-internal",t=>{const e=Fo(t.getProvider("auth").getImmediate());return(i=>new W0(i))(e)},"PRIVATE").setInstantiationMode("EXPLICIT")),ln(md,_d,$0(n)),ln(md,_d,"esm2020")}const G0=300,K0=Zf("authIdTokenMaxAge")||G0;let yd=null;const Y0=n=>async t=>{const e=t&&await t.getIdTokenResult(),i=e&&(new Date().getTime()-Date.parse(e.issuedAtTime))/1e3;if(i&&i>K0)return;const s=e?.token;yd!==s&&(yd=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function X0(n=sg()){const t=Mc(n,"auth");if(t.isInitialized())return t.getImmediate();const e=SE(n,{popupRedirectResolver:H0,persistence:[t0,jE,cm]}),i=Zf("authTokenSyncURL");if(i&&typeof isSecureContext=="boolean"&&isSecureContext){const r=new URL(i,location.origin);if(location.origin===r.origin){const o=Y0(r.toString());LE(e,o,()=>o(e.currentUser)),NE(e,a=>o(a))}}const s=Qf("auth");return s&&RE(e,`http://${s}`),e}function Q0(){return document.getElementsByTagName("head")?.[0]??document}EE({loadJS(n){return new Promise((t,e)=>{const i=document.createElement("script");i.setAttribute("src",n),i.onload=t,i.onerror=s=>{const r=ae("internal-error");r.customData=s,e(r)},i.type="text/javascript",i.charset="UTF-8",Q0().appendChild(i)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});q0("Browser");const J0={apiKey:"AIzaSyBnIvx8lJga-pyQ663BdvgPMGF-B4n096M",authDomain:"weight-abd29.firebaseapp.com",projectId:"weight-abd29",storageBucket:"weight-abd29.firebasestorage.app",messagingSenderId:"467977439298",appId:"1:467977439298:web:944a7d6dc9ef42f23a45db",measurementId:"G-X94BCJ77ZP"},Z0=Oc(J0),zo=X0(Z0),tI=new Re,eI=async()=>{try{return(await r0(zo,tI)).user}catch(n){throw console.error(":",n),n}},nI=async()=>{try{await BE(zo)}catch(n){throw console.error(":",n),n}},iI=n=>FE(zo,n),sI=()=>zo.currentUser,rI={apiKey:"AIzaSyBnIvx8lJga-pyQ663BdvgPMGF-B4n096M",authDomain:"weight-abd29.firebaseapp.com",projectId:"weight-abd29",storageBucket:"weight-abd29.firebasestorage.app",messagingSenderId:"467977439298",appId:"1:467977439298:web:944a7d6dc9ef42f23a45db",measurementId:"G-X94BCJ77ZP"},oI=Oc(rI),Al=RT(oI),aI=()=>new Date().toISOString().split("T")[0],xl=()=>{const n=sI();if(!n)throw new Error("");return`users/${n.uid}/daily_logs`},Sl=async()=>{try{const n=xl(),t=zT(PT(Al,n),jT("date","asc")),e=await GT(t),i=[];return e.forEach(s=>{i.push(s.data())}),i}catch(n){return console.error("Error loading data: ",n),[]}},ho=async(n,t,e)=>{const i=xl(),s=Pp(Al,i,n);try{return t==="weight"?await ed(s,{date:n,weight:parseFloat(e)},{merge:!0}):t==="food"&&await ed(s,{date:n,food:YT(e)},{merge:!0}),await Sl()}catch(r){throw console.error("Error adding document: ",r),alert(""),r}},cI=async(n,t)=>{const e=xl(),i=Pp(Al,e,n);try{return await KT(i,{food:XT(t)}),await Sl()}catch(s){throw console.error("Error removing document: ",s),alert(""),s}};function Js(n){return n+.5|0}const nn=(n,t,e)=>Math.max(Math.min(n,e),t);function fs(n){return nn(Js(n*2.55),0,255)}function fn(n){return nn(Js(n*255),0,255)}function Pe(n){return nn(Js(n/2.55)/100,0,1)}function bd(n){return nn(Js(n*100),0,100)}const ee={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},bc=[..."0123456789ABCDEF"],lI=n=>bc[n&15],hI=n=>bc[(n&240)>>4]+bc[n&15],vr=n=>(n&240)>>4===(n&15),uI=n=>vr(n.r)&&vr(n.g)&&vr(n.b)&&vr(n.a);function dI(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&ee[n[1]]*17,g:255&ee[n[2]]*17,b:255&ee[n[3]]*17,a:t===5?ee[n[4]]*17:255}:(t===7||t===9)&&(e={r:ee[n[1]]<<4|ee[n[2]],g:ee[n[3]]<<4|ee[n[4]],b:ee[n[5]]<<4|ee[n[6]],a:t===9?ee[n[7]]<<4|ee[n[8]]:255})),e}const fI=(n,t)=>n<255?t(n):"";function gI(n){var t=uI(n)?lI:hI;return n?"#"+t(n.r)+t(n.g)+t(n.b)+fI(n.a,t):void 0}const pI=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function mm(n,t,e){const i=t*Math.min(e,1-e),s=(r,o=(r+n/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function mI(n,t,e){const i=(s,r=(s+n/60)%6)=>e-e*t*Math.max(Math.min(r,4-r,1),0);return[i(5),i(3),i(1)]}function _I(n,t,e){const i=mm(n,1,.5);let s;for(t+e>1&&(s=1/(t+e),t*=s,e*=s),s=0;s<3;s++)i[s]*=1-t-e,i[s]+=t;return i}function yI(n,t,e,i,s){return n===s?(t-e)/i+(t<e?6:0):t===s?(e-n)/i+2:(n-t)/i+4}function Pl(n){const e=n.r/255,i=n.g/255,s=n.b/255,r=Math.max(e,i,s),o=Math.min(e,i,s),a=(r+o)/2;let c,h,u;return r!==o&&(u=r-o,h=a>.5?u/(2-r-o):u/(r+o),c=yI(e,i,s,u,r),c=c*60+.5),[c|0,h||0,a]}function Rl(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(fn)}function Cl(n,t,e){return Rl(mm,n,t,e)}function bI(n,t,e){return Rl(_I,n,t,e)}function vI(n,t,e){return Rl(mI,n,t,e)}function _m(n){return(n%360+360)%360}function wI(n){const t=pI.exec(n);let e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?fs(+t[5]):fn(+t[5]));const s=_m(+t[2]),r=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=bI(s,r,o):t[1]==="hsv"?i=vI(s,r,o):i=Cl(s,r,o),{r:i[0],g:i[1],b:i[2],a:e}}function TI(n,t){var e=Pl(n);e[0]=_m(e[0]+t),e=Cl(e),n.r=e[0],n.g=e[1],n.b=e[2]}function EI(n){if(!n)return;const t=Pl(n),e=t[0],i=bd(t[1]),s=bd(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${s}%, ${Pe(n.a)})`:`hsl(${e}, ${i}%, ${s}%)`}const vd={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wd={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function II(){const n={},t=Object.keys(wd),e=Object.keys(vd);let i,s,r,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],s=0;s<e.length;s++)r=e[s],a=a.replace(r,vd[r]);r=parseInt(wd[o],16),n[a]=[r>>16&255,r>>8&255,r&255]}return n}let wr;function AI(n){wr||(wr=II(),wr.transparent=[0,0,0,0]);const t=wr[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const xI=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function SI(n){const t=xI.exec(n);let e=255,i,s,r;if(t){if(t[7]!==i){const o=+t[7];e=t[8]?fs(o):nn(o*255,0,255)}return i=+t[1],s=+t[3],r=+t[5],i=255&(t[2]?fs(i):nn(i,0,255)),s=255&(t[4]?fs(s):nn(s,0,255)),r=255&(t[6]?fs(r):nn(r,0,255)),{r:i,g:s,b:r,a:e}}}function PI(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Pe(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Ca=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,ri=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function RI(n,t,e){const i=ri(Pe(n.r)),s=ri(Pe(n.g)),r=ri(Pe(n.b));return{r:fn(Ca(i+e*(ri(Pe(t.r))-i))),g:fn(Ca(s+e*(ri(Pe(t.g))-s))),b:fn(Ca(r+e*(ri(Pe(t.b))-r))),a:n.a+e*(t.a-n.a)}}function Tr(n,t,e){if(n){let i=Pl(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=Cl(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function ym(n,t){return n&&Object.assign(t||{},n)}function Td(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=fn(n[3]))):(t=ym(n,{r:0,g:0,b:0,a:1}),t.a=fn(t.a)),t}function CI(n){return n.charAt(0)==="r"?SI(n):wI(n)}class Os{constructor(t){if(t instanceof Os)return t;const e=typeof t;let i;e==="object"?i=Td(t):e==="string"&&(i=dI(t)||AI(t)||CI(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=ym(this._rgb);return t&&(t.a=Pe(t.a)),t}set rgb(t){this._rgb=Td(t)}rgbString(){return this._valid?PI(this._rgb):void 0}hexString(){return this._valid?gI(this._rgb):void 0}hslString(){return this._valid?EI(this._rgb):void 0}mix(t,e){if(t){const i=this.rgb,s=t.rgb;let r;const o=e===r?.5:e,a=2*o-1,c=i.a-s.a,h=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;r=1-h,i.r=255&h*i.r+r*s.r+.5,i.g=255&h*i.g+r*s.g+.5,i.b=255&h*i.b+r*s.b+.5,i.a=o*i.a+(1-o)*s.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=RI(this._rgb,t._rgb,e)),this}clone(){return new Os(this.rgb)}alpha(t){return this._rgb.a=fn(t),this}clearer(t){const e=this._rgb;return e.a*=1-t,this}greyscale(){const t=this._rgb,e=Js(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){const e=this._rgb;return e.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Tr(this._rgb,2,t),this}darken(t){return Tr(this._rgb,2,-t),this}saturate(t){return Tr(this._rgb,1,t),this}desaturate(t){return Tr(this._rgb,1,-t),this}rotate(t){return TI(this._rgb,t),this}}function Ae(){}const kI=(()=>{let n=0;return()=>n++})();function K(n){return n==null}function dt(n){if(Array.isArray&&Array.isArray(n))return!0;const t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function Z(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function _t(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Jt(n,t){return _t(n)?n:t}function $(n,t){return typeof n>"u"?t:n}const DI=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,bm=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function at(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function it(n,t,e,i){let s,r,o;if(dt(n))for(r=n.length,s=0;s<r;s++)t.call(e,n[s],s);else if(Z(n))for(o=Object.keys(n),r=o.length,s=0;s<r;s++)t.call(e,n[o[s]],o[s])}function uo(n,t){let e,i,s,r;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(s=n[e],r=t[e],s.datasetIndex!==r.datasetIndex||s.index!==r.index)return!1;return!0}function fo(n){if(dt(n))return n.map(fo);if(Z(n)){const t=Object.create(null),e=Object.keys(n),i=e.length;let s=0;for(;s<i;++s)t[e[s]]=fo(n[e[s]]);return t}return n}function vm(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function MI(n,t,e,i){if(!vm(n))return;const s=t[n],r=e[n];Z(s)&&Z(r)?Vs(s,r,i):t[n]=fo(r)}function Vs(n,t,e){const i=dt(t)?t:[t],s=i.length;if(!Z(n))return n;e=e||{};const r=e.merger||MI;let o;for(let a=0;a<s;++a){if(o=i[a],!Z(o))continue;const c=Object.keys(o);for(let h=0,u=c.length;h<u;++h)r(c[h],n,o,e)}return n}function Es(n,t){return Vs(n,t,{merger:OI})}function OI(n,t,e){if(!vm(n))return;const i=t[n],s=e[n];Z(i)&&Z(s)?Es(i,s):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=fo(s))}const Ed={"":n=>n,x:n=>n.x,y:n=>n.y};function VI(n){const t=n.split("."),e=[];let i="";for(const s of t)i+=s,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function NI(n){const t=VI(n);return e=>{for(const i of t){if(i==="")break;e=e&&e[i]}return e}}function vn(n,t){return(Ed[t]||(Ed[t]=NI(t)))(n)}function kl(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Ns=n=>typeof n<"u",wn=n=>typeof n=="function",Id=(n,t)=>{if(n.size!==t.size)return!1;for(const e of n)if(!t.has(e))return!1;return!0};function LI(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const et=Math.PI,ut=2*et,FI=ut+et,go=Number.POSITIVE_INFINITY,BI=et/180,vt=et/2,Dn=et/4,Ad=et*2/3,sn=Math.log10,ve=Math.sign;function Is(n,t,e){return Math.abs(n-t)<e}function xd(n){const t=Math.round(n);n=Is(n,t,n/1e3)?t:n;const e=Math.pow(10,Math.floor(sn(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function UI(n){const t=[],e=Math.sqrt(n);let i;for(i=1;i<e;i++)n%i===0&&(t.push(i),t.push(n/i));return e===(e|0)&&t.push(e),t.sort((s,r)=>s-r).pop(),t}function zI(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Ri(n){return!zI(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function jI(n,t){const e=Math.round(n);return e-t<=n&&e+t>=n}function wm(n,t,e){let i,s,r;for(i=0,s=n.length;i<s;i++)r=n[i][e],isNaN(r)||(t.min=Math.min(t.min,r),t.max=Math.max(t.max,r))}function oe(n){return n*(et/180)}function Dl(n){return n*(180/et)}function Sd(n){if(!_t(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Tm(n,t){const e=t.x-n.x,i=t.y-n.y,s=Math.sqrt(e*e+i*i);let r=Math.atan2(i,e);return r<-.5*et&&(r+=ut),{angle:r,distance:s}}function vc(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function HI(n,t){return(n-t+FI)%ut-et}function Ut(n){return(n%ut+ut)%ut}function Ls(n,t,e,i){const s=Ut(n),r=Ut(t),o=Ut(e),a=Ut(r-s),c=Ut(o-s),h=Ut(s-r),u=Ut(s-o);return s===r||s===o||i&&r===o||a>c&&h<u}function Ct(n,t,e){return Math.max(t,Math.min(e,n))}function WI(n){return Ct(n,-32768,32767)}function De(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function Ml(n,t,e){e=e||(o=>n[o]<t);let i=n.length-1,s=0,r;for(;i-s>1;)r=s+i>>1,e(r)?s=r:i=r;return{lo:s,hi:i}}const Me=(n,t,e,i)=>Ml(n,e,i?s=>{const r=n[s][t];return r<e||r===e&&n[s+1][t]===e}:s=>n[s][t]<e),$I=(n,t,e)=>Ml(n,e,i=>n[i][t]>=e);function qI(n,t,e){let i=0,s=n.length;for(;i<s&&n[i]<t;)i++;for(;s>i&&n[s-1]>e;)s--;return i>0||s<n.length?n.slice(i,s):n}const Em=["push","pop","shift","splice","unshift"];function GI(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Em.forEach(e=>{const i="_onData"+kl(e),s=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...r){const o=s.apply(this,r);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...r)}),o}})})}function Pd(n,t){const e=n._chartjs;if(!e)return;const i=e.listeners,s=i.indexOf(t);s!==-1&&i.splice(s,1),!(i.length>0)&&(Em.forEach(r=>{delete n[r]}),delete n._chartjs)}function Im(n){const t=new Set(n);return t.size===n.length?n:Array.from(t)}const Am=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function xm(n,t){let e=[],i=!1;return function(...s){e=s,i||(i=!0,Am.call(window,()=>{i=!1,n.apply(t,e)}))}}function KI(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}const Ol=n=>n==="start"?"left":n==="end"?"right":"center",Ft=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,YI=(n,t,e,i)=>n===(i?"left":"right")?e:n==="center"?(t+e)/2:t;function Sm(n,t,e){const i=t.length;let s=0,r=i;if(n._sorted){const{iScale:o,vScale:a,_parsed:c}=n,h=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:d,max:g,minDefined:m,maxDefined:y}=o.getUserBounds();if(m){if(s=Math.min(Me(c,u,d).lo,e?i:Me(t,u,o.getPixelForValue(d)).lo),h){const v=c.slice(0,s+1).reverse().findIndex(w=>!K(w[a.axis]));s-=Math.max(0,v)}s=Ct(s,0,i-1)}if(y){let v=Math.max(Me(c,o.axis,g,!0).hi+1,e?0:Me(t,u,o.getPixelForValue(g),!0).hi+1);if(h){const w=c.slice(v-1).findIndex(S=>!K(S[a.axis]));v+=Math.max(0,w)}r=Ct(v,s,i)-s}else r=i-s}return{start:s,count:r}}function Pm(n){const{xScale:t,yScale:e,_scaleRanges:i}=n,s={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=s,!0;const r=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,s),r}const Er=n=>n===0||n===1,Rd=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*ut/e)),Cd=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*ut/e)+1,As={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*vt)+1,easeOutSine:n=>Math.sin(n*vt),easeInOutSine:n=>-.5*(Math.cos(et*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Er(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Er(n)?n:Rd(n,.075,.3),easeOutElastic:n=>Er(n)?n:Cd(n,.075,.3),easeInOutElastic(n){return Er(n)?n:n<.5?.5*Rd(n*2,.1125,.45):.5+.5*Cd(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-As.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?As.easeInBounce(n*2)*.5:As.easeOutBounce(n*2-1)*.5+.5};function Vl(n){if(n&&typeof n=="object"){const t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function kd(n){return Vl(n)?n:new Os(n)}function ka(n){return Vl(n)?n:new Os(n).saturate(.5).darken(.1).hexString()}const XI=["x","y","borderWidth","radius","tension"],QI=["color","borderColor","backgroundColor"];function JI(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:QI},numbers:{type:"number",properties:XI}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function ZI(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Dd=new Map;function tA(n,t){t=t||{};const e=n+JSON.stringify(t);let i=Dd.get(e);return i||(i=new Intl.NumberFormat(n,t),Dd.set(e,i)),i}function Zs(n,t,e){return tA(t,e).format(n)}const Rm={values(n){return dt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";const i=this.chart.options.locale;let s,r=n;if(e.length>1){const h=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(h<1e-4||h>1e15)&&(s="scientific"),r=eA(n,e)}const o=sn(Math.abs(r)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Zs(n,i,c)},logarithmic(n,t,e){if(n===0)return"0";const i=e[t].significand||n/Math.pow(10,Math.floor(sn(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?Rm.numeric.call(this,n,t,e):""}};function eA(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var jo={formatters:Rm};function nA(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:jo.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}const Yn=Object.create(null),wc=Object.create(null);function xs(n,t){if(!t)return n;const e=t.split(".");for(let i=0,s=e.length;i<s;++i){const r=e[i];n=n[r]||(n[r]=Object.create(null))}return n}function Da(n,t,e){return typeof t=="string"?Vs(xs(n,t),e):Vs(xs(n,""),t)}class iA{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,s)=>ka(s.backgroundColor),this.hoverBorderColor=(i,s)=>ka(s.borderColor),this.hoverColor=(i,s)=>ka(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return Da(this,t,e)}get(t){return xs(this,t)}describe(t,e){return Da(wc,t,e)}override(t,e){return Da(Yn,t,e)}route(t,e,i,s){const r=xs(this,t),o=xs(this,i),a="_"+e;Object.defineProperties(r,{[a]:{value:r[e],writable:!0},[e]:{enumerable:!0,get(){const c=this[a],h=o[s];return Z(c)?Object.assign({},h,c):$(c,h)},set(c){this[a]=c}}})}apply(t){t.forEach(e=>e(this))}}var ft=new iA({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[JI,ZI,nA]);function sA(n){return!n||K(n.size)||K(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function po(n,t,e,i,s){let r=t[s];return r||(r=t[s]=n.measureText(s).width,e.push(s)),r>i&&(i=r),i}function rA(n,t,e,i){i=i||{};let s=i.data=i.data||{},r=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(s=i.data={},r=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let o=0;const a=e.length;let c,h,u,d,g;for(c=0;c<a;c++)if(d=e[c],d!=null&&!dt(d))o=po(n,s,r,o,d);else if(dt(d))for(h=0,u=d.length;h<u;h++)g=d[h],g!=null&&!dt(g)&&(o=po(n,s,r,o,g));n.restore();const m=r.length/2;if(m>e.length){for(c=0;c<m;c++)delete s[r[c]];r.splice(0,m)}return o}function Mn(n,t,e){const i=n.currentDevicePixelRatio,s=e!==0?Math.max(e/2,.5):0;return Math.round((t-s)*i)/i+s}function Md(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function Tc(n,t,e,i){Cm(n,t,e,i,null)}function Cm(n,t,e,i,s){let r,o,a,c,h,u,d,g;const m=t.pointStyle,y=t.rotation,v=t.radius;let w=(y||0)*BI;if(m&&typeof m=="object"&&(r=m.toString(),r==="[object HTMLImageElement]"||r==="[object HTMLCanvasElement]")){n.save(),n.translate(e,i),n.rotate(w),n.drawImage(m,-m.width/2,-m.height/2,m.width,m.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),m){default:s?n.ellipse(e,i,s/2,v,0,0,ut):n.arc(e,i,v,0,ut),n.closePath();break;case"triangle":u=s?s/2:v,n.moveTo(e+Math.sin(w)*u,i-Math.cos(w)*v),w+=Ad,n.lineTo(e+Math.sin(w)*u,i-Math.cos(w)*v),w+=Ad,n.lineTo(e+Math.sin(w)*u,i-Math.cos(w)*v),n.closePath();break;case"rectRounded":h=v*.516,c=v-h,o=Math.cos(w+Dn)*c,d=Math.cos(w+Dn)*(s?s/2-h:c),a=Math.sin(w+Dn)*c,g=Math.sin(w+Dn)*(s?s/2-h:c),n.arc(e-d,i-a,h,w-et,w-vt),n.arc(e+g,i-o,h,w-vt,w),n.arc(e+d,i+a,h,w,w+vt),n.arc(e-g,i+o,h,w+vt,w+et),n.closePath();break;case"rect":if(!y){c=Math.SQRT1_2*v,u=s?s/2:c,n.rect(e-u,i-c,2*u,2*c);break}w+=Dn;case"rectRot":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+g,i-o),n.lineTo(e+d,i+a),n.lineTo(e-g,i+o),n.closePath();break;case"crossRot":w+=Dn;case"cross":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"star":d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o),w+=Dn,d=Math.cos(w)*(s?s/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,g=Math.sin(w)*(s?s/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+g,i-o),n.lineTo(e-g,i+o);break;case"line":o=s?s/2:Math.cos(w)*v,a=Math.sin(w)*v,n.moveTo(e-o,i-a),n.lineTo(e+o,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(w)*(s?s/2:v),i+Math.sin(w)*v);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function Oe(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function Ho(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Wo(n){n.restore()}function oA(n,t,e,i,s){if(!t)return n.lineTo(e.x,e.y);if(s==="middle"){const r=(t.x+e.x)/2;n.lineTo(r,t.y),n.lineTo(r,e.y)}else s==="after"!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function aA(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function cA(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),K(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function lA(n,t,e,i,s){if(s.strikethrough||s.underline){const r=n.measureText(i),o=t-r.actualBoundingBoxLeft,a=t+r.actualBoundingBoxRight,c=e-r.actualBoundingBoxAscent,h=e+r.actualBoundingBoxDescent,u=s.strikethrough?(c+h)/2:h;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function hA(n,t){const e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function Xn(n,t,e,i,s,r={}){const o=dt(t)?t:[t],a=r.strokeWidth>0&&r.strokeColor!=="";let c,h;for(n.save(),n.font=s.string,cA(n,r),c=0;c<o.length;++c)h=o[c],r.backdrop&&hA(n,r.backdrop),a&&(r.strokeColor&&(n.strokeStyle=r.strokeColor),K(r.strokeWidth)||(n.lineWidth=r.strokeWidth),n.strokeText(h,e,i,r.maxWidth)),n.fillText(h,e,i,r.maxWidth),lA(n,e,i,h,r),i+=Number(s.lineHeight);n.restore()}function Fs(n,t){const{x:e,y:i,w:s,h:r,radius:o}=t;n.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*et,et,!0),n.lineTo(e,i+r-o.bottomLeft),n.arc(e+o.bottomLeft,i+r-o.bottomLeft,o.bottomLeft,et,vt,!0),n.lineTo(e+s-o.bottomRight,i+r),n.arc(e+s-o.bottomRight,i+r-o.bottomRight,o.bottomRight,vt,0,!0),n.lineTo(e+s,i+o.topRight),n.arc(e+s-o.topRight,i+o.topRight,o.topRight,0,-vt,!0),n.lineTo(e+o.topLeft,i)}const uA=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,dA=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function fA(n,t){const e=(""+n).match(uA);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}const gA=n=>+n||0;function Nl(n,t){const e={},i=Z(t),s=i?Object.keys(t):t,r=Z(n)?i?o=>$(n[o],n[t[o]]):o=>n[o]:()=>n;for(const o of s)e[o]=gA(r(o));return e}function km(n){return Nl(n,{top:"y",right:"x",bottom:"y",left:"x"})}function jn(n){return Nl(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Wt(n){const t=km(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function xt(n,t){n=n||{},t=t||ft.font;let e=$(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=$(n.style,t.style);i&&!(""+i).match(dA)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);const s={family:$(n.family,t.family),lineHeight:fA($(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:$(n.weight,t.weight),string:""};return s.string=sA(s),s}function gs(n,t,e,i){let s,r,o;for(s=0,r=n.length;s<r;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function pA(n,t,e){const{min:i,max:s}=n,r=bm(t,(s-i)/2),o=(a,c)=>e&&a===0?0:a+c;return{min:o(i,-Math.abs(r)),max:o(s,r)}}function In(n,t){return Object.assign(Object.create(n),t)}function Ll(n,t=[""],e,i,s=()=>n[0]){const r=e||n;typeof i>"u"&&(i=Vm("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:r,_fallback:i,_getTarget:s,override:a=>Ll([a,...n],t,r,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return Mm(a,c,()=>EA(c,t,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return Vd(a).includes(c)},ownKeys(a){return Vd(a)},set(a,c,h){const u=a._storage||(a._storage=s());return a[c]=u[c]=h,delete a._keys,!0}})}function Ci(n,t,e,i){const s={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:Dm(n,i),setContext:r=>Ci(n,r,e,i),override:r=>Ci(n.override(r),t,e,i)};return new Proxy(s,{deleteProperty(r,o){return delete r[o],delete n[o],!0},get(r,o,a){return Mm(r,o,()=>_A(r,o,a))},getOwnPropertyDescriptor(r,o){return r._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(r,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(r,o,a){return n[o]=a,delete r[o],!0}})}function Dm(n,t={scriptable:!0,indexable:!0}){const{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:s=t.allKeys}=n;return{allKeys:s,scriptable:e,indexable:i,isScriptable:wn(e)?e:()=>e,isIndexable:wn(i)?i:()=>i}}const mA=(n,t)=>n?n+kl(t):t,Fl=(n,t)=>Z(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function Mm(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];const i=e();return n[t]=i,i}function _A(n,t,e){const{_proxy:i,_context:s,_subProxy:r,_descriptors:o}=n;let a=i[t];return wn(a)&&o.isScriptable(t)&&(a=yA(t,a,n,e)),dt(a)&&a.length&&(a=bA(t,a,n,o.isIndexable)),Fl(t,a)&&(a=Ci(a,s,r&&r[t],o)),a}function yA(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=t(r,o||i);return a.delete(n),Fl(n,c)&&(c=Bl(s._scopes,s,n,c)),c}function bA(n,t,e,i){const{_proxy:s,_context:r,_subProxy:o,_descriptors:a}=e;if(typeof r.index<"u"&&i(n))return t[r.index%t.length];if(Z(t[0])){const c=t,h=s._scopes.filter(u=>u!==c);t=[];for(const u of c){const d=Bl(h,s,n,u);t.push(Ci(d,r,o&&o[n],a))}}return t}function Om(n,t,e){return wn(n)?n(t,e):n}const vA=(n,t)=>n===!0?t:typeof n=="string"?vn(t,n):void 0;function wA(n,t,e,i,s){for(const r of t){const o=vA(e,r);if(o){n.add(o);const a=Om(o._fallback,e,s);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(o===!1&&typeof i<"u"&&e!==i)return null}return!1}function Bl(n,t,e,i){const s=t._rootScopes,r=Om(t._fallback,e,i),o=[...n,...s],a=new Set;a.add(i);let c=Od(a,o,e,r||e,i);return c===null||typeof r<"u"&&r!==e&&(c=Od(a,o,r,c,i),c===null)?!1:Ll(Array.from(a),[""],s,r,()=>TA(t,e,i))}function Od(n,t,e,i,s){for(;e;)e=wA(n,t,e,i,s);return e}function TA(n,t,e){const i=n._getTarget();t in i||(i[t]={});const s=i[t];return dt(s)&&Z(e)?e:s||{}}function EA(n,t,e,i){let s;for(const r of t)if(s=Vm(mA(r,n),e),typeof s<"u")return Fl(n,s)?Bl(e,i,n,s):s}function Vm(n,t){for(const e of t){if(!e)continue;const i=e[n];if(typeof i<"u")return i}}function Vd(n){let t=n._keys;return t||(t=n._keys=IA(n._scopes)),t}function IA(n){const t=new Set;for(const e of n)for(const i of Object.keys(e).filter(s=>!s.startsWith("_")))t.add(i);return Array.from(t)}function Nm(n,t,e,i){const{iScale:s}=n,{key:r="r"}=this._parsing,o=new Array(i);let a,c,h,u;for(a=0,c=i;a<c;++a)h=a+e,u=t[h],o[a]={r:s.parse(vn(u,r),h)};return o}const AA=Number.EPSILON||1e-14,ki=(n,t)=>t<n.length&&!n[t].skip&&n[t],Lm=n=>n==="x"?"y":"x";function xA(n,t,e,i){const s=n.skip?t:n,r=t,o=e.skip?t:e,a=vc(r,s),c=vc(o,r);let h=a/(a+c),u=c/(a+c);h=isNaN(h)?0:h,u=isNaN(u)?0:u;const d=i*h,g=i*u;return{previous:{x:r.x-d*(o.x-s.x),y:r.y-d*(o.y-s.y)},next:{x:r.x+g*(o.x-s.x),y:r.y+g*(o.y-s.y)}}}function SA(n,t,e){const i=n.length;let s,r,o,a,c,h=ki(n,0);for(let u=0;u<i-1;++u)if(c=h,h=ki(n,u+1),!(!c||!h)){if(Is(t[u],0,AA)){e[u]=e[u+1]=0;continue}s=e[u]/t[u],r=e[u+1]/t[u],a=Math.pow(s,2)+Math.pow(r,2),!(a<=9)&&(o=3/Math.sqrt(a),e[u]=s*o*t[u],e[u+1]=r*o*t[u])}}function PA(n,t,e="x"){const i=Lm(e),s=n.length;let r,o,a,c=ki(n,0);for(let h=0;h<s;++h){if(o=a,a=c,c=ki(n,h+1),!a)continue;const u=a[e],d=a[i];o&&(r=(u-o[e])/3,a[`cp1${e}`]=u-r,a[`cp1${i}`]=d-r*t[h]),c&&(r=(c[e]-u)/3,a[`cp2${e}`]=u+r,a[`cp2${i}`]=d+r*t[h])}}function RA(n,t="x"){const e=Lm(t),i=n.length,s=Array(i).fill(0),r=Array(i);let o,a,c,h=ki(n,0);for(o=0;o<i;++o)if(a=c,c=h,h=ki(n,o+1),!!c){if(h){const u=h[t]-c[t];s[o]=u!==0?(h[e]-c[e])/u:0}r[o]=a?h?ve(s[o-1])!==ve(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}SA(n,s,r),PA(n,r,t)}function Ir(n,t,e){return Math.max(Math.min(n,e),t)}function CA(n,t){let e,i,s,r,o,a=Oe(n[0],t);for(e=0,i=n.length;e<i;++e)o=r,r=a,a=e<i-1&&Oe(n[e+1],t),r&&(s=n[e],o&&(s.cp1x=Ir(s.cp1x,t.left,t.right),s.cp1y=Ir(s.cp1y,t.top,t.bottom)),a&&(s.cp2x=Ir(s.cp2x,t.left,t.right),s.cp2y=Ir(s.cp2y,t.top,t.bottom)))}function kA(n,t,e,i,s){let r,o,a,c;if(t.spanGaps&&(n=n.filter(h=>!h.skip)),t.cubicInterpolationMode==="monotone")RA(n,s);else{let h=i?n[n.length-1]:n[0];for(r=0,o=n.length;r<o;++r)a=n[r],c=xA(h,a,n[Math.min(r+1,o-(i?0:1))%o],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,h=a}t.capBezierPoints&&CA(n,e)}function Ul(){return typeof window<"u"&&typeof document<"u"}function zl(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function mo(n,t,e){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=n,i}const $o=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function DA(n,t){return $o(n).getPropertyValue(t)}const MA=["top","right","bottom","left"];function Hn(n,t,e){const i={};e=e?"-"+e:"";for(let s=0;s<4;s++){const r=MA[s];i[r]=parseFloat(n[t+"-"+r+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const OA=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function VA(n,t){const e=n.touches,i=e&&e.length?e[0]:n,{offsetX:s,offsetY:r}=i;let o=!1,a,c;if(OA(s,r,n.target))a=s,c=r;else{const h=t.getBoundingClientRect();a=i.clientX-h.left,c=i.clientY-h.top,o=!0}return{x:a,y:c,box:o}}function Ln(n,t){if("native"in n)return n;const{canvas:e,currentDevicePixelRatio:i}=t,s=$o(e),r=s.boxSizing==="border-box",o=Hn(s,"padding"),a=Hn(s,"border","width"),{x:c,y:h,box:u}=VA(n,e),d=o.left+(u&&a.left),g=o.top+(u&&a.top);let{width:m,height:y}=t;return r&&(m-=o.width+a.width,y-=o.height+a.height),{x:Math.round((c-d)/m*e.width/i),y:Math.round((h-g)/y*e.height/i)}}function NA(n,t,e){let i,s;if(t===void 0||e===void 0){const r=n&&zl(n);if(!r)t=n.clientWidth,e=n.clientHeight;else{const o=r.getBoundingClientRect(),a=$o(r),c=Hn(a,"border","width"),h=Hn(a,"padding");t=o.width-h.width-c.width,e=o.height-h.height-c.height,i=mo(a.maxWidth,r,"clientWidth"),s=mo(a.maxHeight,r,"clientHeight")}}return{width:t,height:e,maxWidth:i||go,maxHeight:s||go}}const rn=n=>Math.round(n*10)/10;function LA(n,t,e,i){const s=$o(n),r=Hn(s,"margin"),o=mo(s.maxWidth,n,"clientWidth")||go,a=mo(s.maxHeight,n,"clientHeight")||go,c=NA(n,t,e);let{width:h,height:u}=c;if(s.boxSizing==="content-box"){const g=Hn(s,"border","width"),m=Hn(s,"padding");h-=m.width+g.width,u-=m.height+g.height}return h=Math.max(0,h-r.width),u=Math.max(0,i?h/i:u-r.height),h=rn(Math.min(h,o,c.maxWidth)),u=rn(Math.min(u,a,c.maxHeight)),h&&!u&&(u=rn(h/2)),(t!==void 0||e!==void 0)&&i&&c.height&&u>c.height&&(u=c.height,h=rn(Math.floor(u*i))),{width:h,height:u}}function Nd(n,t,e){const i=t||1,s=rn(n.height*i),r=rn(n.width*i);n.height=rn(n.height),n.width=rn(n.width);const o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==s||o.width!==r?(n.currentDevicePixelRatio=i,o.height=s,o.width=r,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}const FA=(function(){let n=!1;try{const t={get passive(){return n=!0,!1}};Ul()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n})();function Ld(n,t){const e=DA(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Fn(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function BA(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:i==="middle"?e<.5?n.y:t.y:i==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function UA(n,t,e,i){const s={x:n.cp2x,y:n.cp2y},r={x:t.cp1x,y:t.cp1y},o=Fn(n,s,e),a=Fn(s,r,e),c=Fn(r,t,e),h=Fn(o,a,e),u=Fn(a,c,e);return Fn(h,u,e)}const zA=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},jA=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function yi(n,t,e){return n?zA(t,e):jA()}function Fm(n,t){let e,i;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function Bm(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function Um(n){return n==="angle"?{between:Ls,compare:HI,normalize:Ut}:{between:De,compare:(t,e)=>t-e,normalize:t=>t}}function Fd({start:n,end:t,count:e,loop:i,style:s}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e===0,style:s}}function HA(n,t,e){const{property:i,start:s,end:r}=e,{between:o,normalize:a}=Um(i),c=t.length;let{start:h,end:u,loop:d}=n,g,m;if(d){for(h+=c,u+=c,g=0,m=c;g<m&&o(a(t[h%c][i]),s,r);++g)h--,u--;h%=c,u%=c}return u<h&&(u+=c),{start:h,end:u,loop:d,style:n.style}}function zm(n,t,e){if(!e)return[n];const{property:i,start:s,end:r}=e,o=t.length,{compare:a,between:c,normalize:h}=Um(i),{start:u,end:d,loop:g,style:m}=HA(n,t,e),y=[];let v=!1,w=null,S,R,D;const V=()=>c(s,D,S)&&a(s,D)!==0,M=()=>a(r,S)===0||c(r,D,S),L=()=>v||V(),E=()=>!v||M();for(let b=u,T=u;b<=d;++b)R=t[b%o],!R.skip&&(S=h(R[i]),S!==D&&(v=c(S,s,r),w===null&&L()&&(w=a(S,s)===0?b:T),w!==null&&E()&&(y.push(Fd({start:w,end:b,loop:g,count:o,style:m})),w=null),T=b,D=S));return w!==null&&y.push(Fd({start:w,end:d,loop:g,count:o,style:m})),y}function jm(n,t){const e=[],i=n.segments;for(let s=0;s<i.length;s++){const r=zm(i[s],n.points,t);r.length&&e.push(...r)}return e}function WA(n,t,e,i){let s=0,r=t-1;if(e&&!i)for(;s<t&&!n[s].skip;)s++;for(;s<t&&n[s].skip;)s++;for(s%=t,e&&(r+=s);r>s&&n[r%t].skip;)r--;return r%=t,{start:s,end:r}}function $A(n,t,e,i){const s=n.length,r=[];let o=t,a=n[t],c;for(c=t+1;c<=e;++c){const h=n[c%s];h.skip||h.stop?a.skip||(i=!1,r.push({start:t%s,end:(c-1)%s,loop:i}),t=o=h.stop?c:null):(o=c,a.skip&&(t=c)),a=h}return o!==null&&r.push({start:t%s,end:o%s,loop:i}),r}function qA(n,t){const e=n.points,i=n.options.spanGaps,s=e.length;if(!s)return[];const r=!!n._loop,{start:o,end:a}=WA(e,s,r,i);if(i===!0)return Bd(n,[{start:o,end:a,loop:r}],e,t);const c=a<o?a+s:a,h=!!n._fullLoop&&o===0&&a===s-1;return Bd(n,$A(e,o,c,h),e,t)}function Bd(n,t,e,i){return!i||!i.setContext||!e?t:GA(n,t,e,i)}function GA(n,t,e,i){const s=n._chart.getContext(),r=Ud(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=e.length,h=[];let u=r,d=t[0].start,g=d;function m(y,v,w,S){const R=a?-1:1;if(y!==v){for(y+=c;e[y%c].skip;)y-=R;for(;e[v%c].skip;)v+=R;y%c!==v%c&&(h.push({start:y%c,end:v%c,loop:w,style:S}),u=S,d=v%c)}}for(const y of t){d=a?d:y.start;let v=e[d%c],w;for(g=d+1;g<=y.end;g++){const S=e[g%c];w=Ud(i.setContext(In(s,{type:"segment",p0:v,p1:S,p0DataIndex:(g-1)%c,p1DataIndex:g%c,datasetIndex:o}))),KA(w,u)&&m(d,g-1,y.loop,u),v=S,u=w}d<g-1&&m(d,g-1,y.loop,u)}return h}function Ud(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function KA(n,t){if(!t)return!1;const e=[],i=function(s,r){return Vl(r)?(e.includes(r)||e.push(r),e.indexOf(r)):r};return JSON.stringify(n,i)!==JSON.stringify(t,i)}function Ar(n,t,e){return n.options.clip?n[e]:t[e]}function YA(n,t){const{xScale:e,yScale:i}=n;return e&&i?{left:Ar(e,t,"left"),right:Ar(e,t,"right"),top:Ar(i,t,"top"),bottom:Ar(i,t,"bottom")}:t}function Hm(n,t){const e=t._clip;if(e.disabled)return!1;const i=YA(t,n.chartArea);return{left:e.left===!1?0:i.left-(e.left===!0?0:e.left),right:e.right===!1?n.width:i.right+(e.right===!0?0:e.right),top:e.top===!1?0:i.top-(e.top===!0?0:e.top),bottom:e.bottom===!1?n.height:i.bottom+(e.bottom===!0?0:e.bottom)}}class XA{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,s){const r=e.listeners[s],o=e.duration;r.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Am.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,s)=>{if(!i.running||!i.items.length)return;const r=i.items;let o=r.length-1,a=!1,c;for(;o>=0;--o)c=r[o],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(t),a=!0):(r[o]=r[r.length-1],r.pop());a&&(s.draw(),this._notify(s,i,t,"progress")),r.length||(i.running=!1,this._notify(s,i,t,"complete"),i.initial=!1),e+=r.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){const e=this._charts;let i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){const e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,s)=>Math.max(i,s._duration),0),this._refresh())}running(t){if(!this._running)return!1;const e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){const e=this._charts.get(t);if(!e||!e.items.length)return;const i=e.items;let s=i.length-1;for(;s>=0;--s)i[s].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var xe=new XA;const zd="transparent",QA={boolean(n,t,e){return e>.5?t:n},color(n,t,e){const i=kd(n||zd),s=i.valid&&kd(t||zd);return s&&s.valid?s.mix(i,e).hexString():t},number(n,t,e){return n+(t-n)*e}};class JA{constructor(t,e,i,s){const r=e[i];s=gs([t.to,s,r,t.from]);const o=gs([t.from,r,s]);this._active=!0,this._fn=t.fn||QA[t.type||typeof o],this._easing=As[t.easing]||As.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);const s=this._target[this._prop],r=i-this._start,o=this._duration-r;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=r,this._loop=!!t.loop,this._to=gs([t.to,e,s,t.from]),this._from=gs([t.from,s,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const e=t-this._start,i=this._duration,s=this._prop,r=this._from,o=this._loop,a=this._to;let c;if(this._active=r!==a&&(o||e<i),!this._active){this._target[s]=a,this._notify(!0);return}if(e<0){this._target[s]=r;return}c=e/i%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(r,a,c)}wait(){const t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){const e=t?"res":"rej",i=this._promises||[];for(let s=0;s<i.length;s++)i[s][e]()}}class Wm{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!Z(t))return;const e=Object.keys(ft.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(s=>{const r=t[s];if(!Z(r))return;const o={};for(const a of e)o[a]=r[a];(dt(r.properties)&&r.properties||[s]).forEach(a=>{(a===s||!i.has(a))&&i.set(a,o)})})}_animateOptions(t,e){const i=e.options,s=tx(t,i);if(!s)return[];const r=this._createAnimations(s,i);return i.$shared&&ZA(t.options.$animations,i).then(()=>{t.options=i},()=>{}),r}_createAnimations(t,e){const i=this._properties,s=[],r=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now();let c;for(c=o.length-1;c>=0;--c){const h=o[c];if(h.charAt(0)==="$")continue;if(h==="options"){s.push(...this._animateOptions(t,e));continue}const u=e[h];let d=r[h];const g=i.get(h);if(d)if(g&&d.active()){d.update(g,u,a);continue}else d.cancel();if(!g||!g.duration){t[h]=u;continue}r[h]=d=new JA(g,t,h,u),s.push(d)}return s}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}const i=this._createAnimations(t,e);if(i.length)return xe.add(this._chart,i),!0}}function ZA(n,t){const e=[],i=Object.keys(t);for(let s=0;s<i.length;s++){const r=n[i[s]];r&&r.active()&&e.push(r.wait())}return Promise.all(e)}function tx(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function jd(n,t){const e=n&&n.options||{},i=e.reverse,s=e.min===void 0?t:0,r=e.max===void 0?t:0;return{start:i?r:s,end:i?s:r}}function ex(n,t,e){if(e===!1)return!1;const i=jd(n,e),s=jd(t,e);return{top:s.end,right:i.end,bottom:s.start,left:i.start}}function nx(n){let t,e,i,s;return Z(n)?(t=n.top,e=n.right,i=n.bottom,s=n.left):t=e=i=s=n,{top:t,right:e,bottom:i,left:s,disabled:n===!1}}function $m(n,t){const e=[],i=n._getSortedDatasetMetas(t);let s,r;for(s=0,r=i.length;s<r;++s)e.push(i[s].index);return e}function Hd(n,t,e,i={}){const s=n.keys,r=i.mode==="single";let o,a,c,h;if(t===null)return;let u=!1;for(o=0,a=s.length;o<a;++o){if(c=+s[o],c===e){if(u=!0,i.all)continue;break}h=n.values[c],_t(h)&&(r||t===0||ve(t)===ve(h))&&(t+=h)}return!u&&!i.all?0:t}function ix(n,t){const{iScale:e,vScale:i}=t,s=e.axis==="x"?"x":"y",r=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let c,h,u;for(c=0,h=o.length;c<h;++c)u=o[c],a[c]={[s]:u,[r]:n[u]};return a}function Ma(n,t){const e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function sx(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function rx(n){const{min:t,max:e,minDefined:i,maxDefined:s}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:s?e:Number.POSITIVE_INFINITY}}function ox(n,t,e){const i=n[t]||(n[t]={});return i[e]||(i[e]={})}function Wd(n,t,e,i){for(const s of t.getMatchingVisibleMetas(i).reverse()){const r=n[s.index];if(e&&r>0||!e&&r<0)return s.index}return null}function $d(n,t){const{chart:e,_cachedMeta:i}=n,s=e._stacks||(e._stacks={}),{iScale:r,vScale:o,index:a}=i,c=r.axis,h=o.axis,u=sx(r,o,i),d=t.length;let g;for(let m=0;m<d;++m){const y=t[m],{[c]:v,[h]:w}=y,S=y._stacks||(y._stacks={});g=S[h]=ox(s,u,v),g[a]=w,g._top=Wd(g,o,!0,i.type),g._bottom=Wd(g,o,!1,i.type);const R=g._visualValues||(g._visualValues={});R[a]=w}}function Oa(n,t){const e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function ax(n,t){return In(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function cx(n,t,e){return In(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function ns(n,t){const e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(const s of t){const r=s._stacks;if(!r||r[i]===void 0||r[i][e]===void 0)return;delete r[i][e],r[i]._visualValues!==void 0&&r[i]._visualValues[e]!==void 0&&delete r[i]._visualValues[e]}}}const Va=n=>n==="reset"||n==="none",qd=(n,t)=>t?n:Object.assign({},n),lx=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:$m(e,!0),values:null};class An{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(t,e){this.chart=t,this._ctx=t.ctx,this.index=e,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=Ma(t.vScale,t),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(t){this.index!==t&&ns(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,e=this._cachedMeta,i=this.getDataset(),s=(d,g,m,y)=>d==="x"?g:d==="r"?y:m,r=e.xAxisID=$(i.xAxisID,Oa(t,"x")),o=e.yAxisID=$(i.yAxisID,Oa(t,"y")),a=e.rAxisID=$(i.rAxisID,Oa(t,"r")),c=e.indexAxis,h=e.iAxisID=s(c,r,o,a),u=e.vAxisID=s(c,o,r,a);e.xScale=this.getScaleForId(r),e.yScale=this.getScaleForId(o),e.rScale=this.getScaleForId(a),e.iScale=this.getScaleForId(h),e.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const e=this._cachedMeta;return t===e.iScale?e.vScale:e.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Pd(this._data,this),t._stacked&&ns(t)}_dataCheck(){const t=this.getDataset(),e=t.data||(t.data=[]),i=this._data;if(Z(e)){const s=this._cachedMeta;this._data=ix(e,s)}else if(i!==e){if(i){Pd(i,this);const s=this._cachedMeta;ns(s),s._parsed=[]}e&&Object.isExtensible(e)&&GI(e,this),this._syncList=[],this._data=e}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const e=this._cachedMeta,i=this.getDataset();let s=!1;this._dataCheck();const r=e._stacked;e._stacked=Ma(e.vScale,e),e.stack!==i.stack&&(s=!0,ns(e),e.stack=i.stack),this._resyncElements(t),(s||r!==e._stacked)&&($d(this,e._parsed),e._stacked=Ma(e.vScale,e))}configure(){const t=this.chart.config,e=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),e,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,e){const{_cachedMeta:i,_data:s}=this,{iScale:r,_stacked:o}=i,a=r.axis;let c=t===0&&e===s.length?!0:i._sorted,h=t>0&&i._parsed[t-1],u,d,g;if(this._parsing===!1)i._parsed=s,i._sorted=!0,g=s;else{dt(s[t])?g=this.parseArrayData(i,s,t,e):Z(s[t])?g=this.parseObjectData(i,s,t,e):g=this.parsePrimitiveData(i,s,t,e);const m=()=>d[a]===null||h&&d[a]<h[a];for(u=0;u<e;++u)i._parsed[u+t]=d=g[u],c&&(m()&&(c=!1),h=d);i._sorted=c}o&&$d(this,g)}parsePrimitiveData(t,e,i,s){const{iScale:r,vScale:o}=t,a=r.axis,c=o.axis,h=r.getLabels(),u=r===o,d=new Array(s);let g,m,y;for(g=0,m=s;g<m;++g)y=g+i,d[g]={[a]:u||r.parse(h[y],y),[c]:o.parse(e[y],y)};return d}parseArrayData(t,e,i,s){const{xScale:r,yScale:o}=t,a=new Array(s);let c,h,u,d;for(c=0,h=s;c<h;++c)u=c+i,d=e[u],a[c]={x:r.parse(d[0],u),y:o.parse(d[1],u)};return a}parseObjectData(t,e,i,s){const{xScale:r,yScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,h=new Array(s);let u,d,g,m;for(u=0,d=s;u<d;++u)g=u+i,m=e[g],h[u]={x:r.parse(vn(m,a),g),y:o.parse(vn(m,c),g)};return h}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,e,i){const s=this.chart,r=this._cachedMeta,o=e[t.axis],a={keys:$m(s,!0),values:e._stacks[t.axis]._visualValues};return Hd(a,o,r.index,{mode:i})}updateRangeFromParsed(t,e,i,s){const r=i[e.axis];let o=r===null?NaN:r;const a=s&&i._stacks[e.axis];s&&a&&(s.values=a,o=Hd(s,r,this._cachedMeta.index)),t.min=Math.min(t.min,o),t.max=Math.max(t.max,o)}getMinMax(t,e){const i=this._cachedMeta,s=i._parsed,r=i._sorted&&t===i.iScale,o=s.length,a=this._getOtherScale(t),c=lx(e,i,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=rx(a);let g,m;function y(){m=s[g];const v=m[a.axis];return!_t(m[t.axis])||u>v||d<v}for(g=0;g<o&&!(!y()&&(this.updateRangeFromParsed(h,t,m,c),r));++g);if(r){for(g=o-1;g>=0;--g)if(!y()){this.updateRangeFromParsed(h,t,m,c);break}}return h}getAllParsedValues(t){const e=this._cachedMeta._parsed,i=[];let s,r,o;for(s=0,r=e.length;s<r;++s)o=e[s][t.axis],_t(o)&&i.push(o);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const e=this._cachedMeta,i=e.iScale,s=e.vScale,r=this.getParsed(t);return{label:i?""+i.getLabelForValue(r[i.axis]):"",value:s?""+s.getLabelForValue(r[s.axis]):""}}_update(t){const e=this._cachedMeta;this.update(t||"default"),e._clip=nx($(this.options.clip,ex(e.xScale,e.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,e=this.chart,i=this._cachedMeta,s=i.data||[],r=e.chartArea,o=[],a=this._drawStart||0,c=this._drawCount||s.length-a,h=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(t,r,a,c),u=a;u<a+c;++u){const d=s[u];d.hidden||(d.active&&h?o.push(d):d.draw(t,r))}for(u=0;u<o.length;++u)o[u].draw(t,r)}getStyle(t,e){const i=e?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,e,i){const s=this.getDataset();let r;if(t>=0&&t<this._cachedMeta.data.length){const o=this._cachedMeta.data[t];r=o.$context||(o.$context=cx(this.getContext(),t,o)),r.parsed=this.getParsed(t),r.raw=s.data[t],r.index=r.dataIndex=t}else r=this.$context||(this.$context=ax(this.chart.getContext(),this.index)),r.dataset=s,r.index=r.datasetIndex=this.index;return r.active=!!e,r.mode=i,r}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,e){return this._resolveElementOptions(this.dataElementType.id,e,t)}_resolveElementOptions(t,e="default",i){const s=e==="active",r=this._cachedDataOpts,o=t+"-"+e,a=r[o],c=this.enableOptionSharing&&Ns(i);if(a)return qd(a,c);const h=this.chart.config,u=h.datasetElementScopeKeys(this._type,t),d=s?[`${t}Hover`,"hover",t,""]:[t,""],g=h.getOptionScopes(this.getDataset(),u),m=Object.keys(ft.elements[t]),y=()=>this.getContext(i,s,e),v=h.resolveNamedOptions(g,m,y,d);return v.$shared&&(v.$shared=c,r[o]=Object.freeze(qd(v,c))),v}_resolveAnimations(t,e,i){const s=this.chart,r=this._cachedDataOpts,o=`animation-${e}`,a=r[o];if(a)return a;let c;if(s.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,e),g=u.getOptionScopes(this.getDataset(),d);c=u.createResolver(g,this.getContext(t,i,e))}const h=new Wm(s,c&&c.animations);return c&&c._cacheable&&(r[o]=Object.freeze(h)),h}getSharedOptions(t){if(t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,e){return!e||Va(t)||this.chart._animationsDisabled}_getSharedOptions(t,e){const i=this.resolveDataElementOptions(t,e),s=this._sharedOptions,r=this.getSharedOptions(i),o=this.includeOptions(e,r)||r!==s;return this.updateSharedOptions(r,e,i),{sharedOptions:r,includeOptions:o}}updateElement(t,e,i,s){Va(s)?Object.assign(t,i):this._resolveAnimations(e,s).update(t,i)}updateSharedOptions(t,e,i){t&&!Va(e)&&this._resolveAnimations(void 0,e).update(t,i)}_setStyle(t,e,i,s){t.active=s;const r=this.getStyle(e,s);this._resolveAnimations(e,i,s).update(t,{options:!s&&this.getSharedOptions(r)||r})}removeHoverStyle(t,e,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,e,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const e=this._data,i=this._cachedMeta.data;for(const[a,c,h]of this._syncList)this[a](c,h);this._syncList=[];const s=i.length,r=e.length,o=Math.min(r,s);o&&this.parse(0,o),r>s?this._insertElements(s,r-s,t):r<s&&this._removeElements(r,s-r)}_insertElements(t,e,i=!0){const s=this._cachedMeta,r=s.data,o=t+e;let a;const c=h=>{for(h.length+=e,a=h.length-1;a>=o;a--)h[a]=h[a-e]};for(c(r),a=t;a<o;++a)r[a]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(t,e),i&&this.updateElements(r,t,e,"reset")}updateElements(t,e,i,s){}_removeElements(t,e){const i=this._cachedMeta;if(this._parsing){const s=i._parsed.splice(t,e);i._stacked&&ns(i,s)}i.data.splice(t,e)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[e,i,s]=t;this[e](i,s)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,e){e&&this._sync(["_removeElements",t,e]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function hx(n,t){if(!n._cache.$bar){const e=n.getMatchingVisibleMetas(t);let i=[];for(let s=0,r=e.length;s<r;s++)i=i.concat(e[s].controller.getAllParsedValues(n));n._cache.$bar=Im(i.sort((s,r)=>s-r))}return n._cache.$bar}function ux(n){const t=n.iScale,e=hx(t,n.type);let i=t._length,s,r,o,a;const c=()=>{o===32767||o===-32768||(Ns(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(s=0,r=e.length;s<r;++s)o=t.getPixelForValue(e[s]),c();for(a=void 0,s=0,r=t.ticks.length;s<r;++s)o=t.getPixelForTick(s),c();return i}function dx(n,t,e,i){const s=e.barThickness;let r,o;return K(s)?(r=t.min*e.categoryPercentage,o=e.barPercentage):(r=s*i,o=1),{chunk:r/i,ratio:o,start:t.pixels[n]-r/2}}function fx(n,t,e,i){const s=t.pixels,r=s[n];let o=n>0?s[n-1]:null,a=n<s.length-1?s[n+1]:null;const c=e.categoryPercentage;o===null&&(o=r-(a===null?t.end-t.start:a-r)),a===null&&(a=r+r-o);const h=r-(r-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:e.barPercentage,start:h}}function gx(n,t,e,i){const s=e.parse(n[0],i),r=e.parse(n[1],i),o=Math.min(s,r),a=Math.max(s,r);let c=o,h=a;Math.abs(o)>Math.abs(a)&&(c=a,h=o),t[e.axis]=h,t._custom={barStart:c,barEnd:h,start:s,end:r,min:o,max:a}}function qm(n,t,e,i){return dt(n)?gx(n,t,e,i):t[e.axis]=e.parse(n,i),t}function Gd(n,t,e,i){const s=n.iScale,r=n.vScale,o=s.getLabels(),a=s===r,c=[];let h,u,d,g;for(h=e,u=e+i;h<u;++h)g=t[h],d={},d[s.axis]=a||s.parse(o[h],h),c.push(qm(g,d,r,h));return c}function Na(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function px(n,t,e){return n!==0?ve(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function mx(n){let t,e,i,s,r;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(s="end",r="start"):(s="start",r="end"),{start:e,end:i,reverse:t,top:s,bottom:r}}function _x(n,t,e,i){let s=t.borderSkipped;const r={};if(!s){n.borderSkipped=r;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:c,top:h,bottom:u}=mx(n);s==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?s=h:(e._bottom||0)===i?s=u:(r[Kd(u,o,a,c)]=!0,s=h)),r[Kd(s,o,a,c)]=!0,n.borderSkipped=r}function Kd(n,t,e,i){return i?(n=yx(n,t,e),n=Yd(n,e,t)):n=Yd(n,t,e),n}function yx(n,t,e){return n===t?e:n===e?t:n}function Yd(n,t,e){return n==="start"?t:n==="end"?e:n}function bx(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}class vx extends An{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(t,e,i,s){return Gd(t,e,i,s)}parseArrayData(t,e,i,s){return Gd(t,e,i,s)}parseObjectData(t,e,i,s){const{iScale:r,vScale:o}=t,{xAxisKey:a="x",yAxisKey:c="y"}=this._parsing,h=r.axis==="x"?a:c,u=o.axis==="x"?a:c,d=[];let g,m,y,v;for(g=i,m=i+s;g<m;++g)v=e[g],y={},y[r.axis]=r.parse(vn(v,h),g),d.push(qm(vn(v,u),y,o,g));return d}updateRangeFromParsed(t,e,i,s){super.updateRangeFromParsed(t,e,i,s);const r=i._custom;r&&e===this._cachedMeta.vScale&&(t.min=Math.min(t.min,r.min),t.max=Math.max(t.max,r.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const e=this._cachedMeta,{iScale:i,vScale:s}=e,r=this.getParsed(t),o=r._custom,a=Na(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(r[s.axis]);return{label:""+i.getLabelForValue(r[i.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const e=this._cachedMeta;this.updateElements(e.data,0,e.data.length,t)}updateElements(t,e,i,s){const r=s==="reset",{index:o,_cachedMeta:{vScale:a}}=this,c=a.getBasePixel(),h=a.isHorizontal(),u=this._getRuler(),{sharedOptions:d,includeOptions:g}=this._getSharedOptions(e,s);for(let m=e;m<e+i;m++){const y=this.getParsed(m),v=r||K(y[a.axis])?{base:c,head:c}:this._calculateBarValuePixels(m),w=this._calculateBarIndexPixels(m,u),S=(y._stacks||{})[a.axis],R={horizontal:h,base:v.base,enableBorderRadius:!S||Na(y._custom)||o===S._top||o===S._bottom,x:h?v.head:w.center,y:h?w.center:v.head,height:h?w.size:Math.abs(v.size),width:h?Math.abs(v.size):w.size};g&&(R.options=d||this.resolveDataElementOptions(m,t[m].active?"active":s));const D=R.options||t[m].options;_x(R,D,S,o),bx(R,D,u.ratio),this.updateElement(t[m],m,R,s)}}_getStacks(t,e){const{iScale:i}=this._cachedMeta,s=i.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),r=i.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(e),c=a&&a[i.axis],h=u=>{const d=u._parsed.find(m=>m[i.axis]===c),g=d&&d[u.vScale.axis];if(K(g)||isNaN(g))return!0};for(const u of s)if(!(e!==void 0&&h(u))&&((r===!1||o.indexOf(u.stack)===-1||r===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===t))break;return o.length||o.push(void 0),o}_getStackCount(t){return this._getStacks(void 0,t).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const t=this.chart.scales,e=this.chart.options.indexAxis;return Object.keys(t).filter(i=>t[i].axis===e).shift()}_getAxis(){const t={},e=this.getFirstScaleIdForIndexAxis();for(const i of this.chart.data.datasets)t[$(this.chart.options.indexAxis==="x"?i.xAxisID:i.yAxisID,e)]=!0;return Object.keys(t)}_getStackIndex(t,e,i){const s=this._getStacks(t,i),r=e!==void 0?s.indexOf(e):-1;return r===-1?s.length-1:r}_getRuler(){const t=this.options,e=this._cachedMeta,i=e.iScale,s=[];let r,o;for(r=0,o=e.data.length;r<o;++r)s.push(i.getPixelForValue(this.getParsed(r)[i.axis],r));const a=t.barThickness;return{min:a||ux(e),pixels:s,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:a?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:e,_stacked:i,index:s},options:{base:r,minBarLength:o}}=this,a=r||0,c=this.getParsed(t),h=c._custom,u=Na(h);let d=c[e.axis],g=0,m=i?this.applyStack(e,c,i):d,y,v;m!==d&&(g=m-d,m=d),u&&(d=h.barStart,m=h.barEnd-h.barStart,d!==0&&ve(d)!==ve(h.barEnd)&&(g=0),g+=d);const w=!K(r)&&!u?r:g;let S=e.getPixelForValue(w);if(this.chart.getDataVisibility(t)?y=e.getPixelForValue(g+m):y=S,v=y-S,Math.abs(v)<o){v=px(v,e,a)*o,d===a&&(S-=v/2);const R=e.getPixelForDecimal(0),D=e.getPixelForDecimal(1),V=Math.min(R,D),M=Math.max(R,D);S=Math.max(Math.min(S,M),V),y=S+v,i&&!u&&(c._stacks[e.axis]._visualValues[s]=e.getValueForPixel(y)-e.getValueForPixel(S))}if(S===e.getPixelForValue(a)){const R=ve(v)*e.getLineWidthForValue(a)/2;S+=R,v-=R}return{size:v,base:S,head:y,center:y+v/2}}_calculateBarIndexPixels(t,e){const i=e.scale,s=this.options,r=s.skipNull,o=$(s.maxBarThickness,1/0);let a,c;const h=this._getAxisCount();if(e.grouped){const u=r?this._getStackCount(t):e.stackCount,d=s.barThickness==="flex"?fx(t,e,s,u*h):dx(t,e,s,u*h),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,m=this._getAxis().indexOf($(g,this.getFirstScaleIdForIndexAxis())),y=this._getStackIndex(this.index,this._cachedMeta.stack,r?t:void 0)+m;a=d.start+d.chunk*y+d.chunk/2,c=Math.min(o,d.chunk*d.ratio)}else a=i.getPixelForValue(this.getParsed(t)[i.axis],t),c=Math.min(o,e.min*e.ratio);return{base:a-c/2,head:a+c/2,center:a,size:c}}draw(){const t=this._cachedMeta,e=t.vScale,i=t.data,s=i.length;let r=0;for(;r<s;++r)this.getParsed(r)[e.axis]!==null&&!i[r].hidden&&i[r].draw(this._ctx)}}class wx extends An{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,e,i,s){const r=super.parsePrimitiveData(t,e,i,s);for(let o=0;o<r.length;o++)r[o]._custom=this.resolveDataElementOptions(o+i).radius;return r}parseArrayData(t,e,i,s){const r=super.parseArrayData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=$(a[2],this.resolveDataElementOptions(o+i).radius)}return r}parseObjectData(t,e,i,s){const r=super.parseObjectData(t,e,i,s);for(let o=0;o<r.length;o++){const a=e[i+o];r[o]._custom=$(a&&a.r&&+a.r,this.resolveDataElementOptions(o+i).radius)}return r}getMaxOverflow(){const t=this._cachedMeta.data;let e=0;for(let i=t.length-1;i>=0;--i)e=Math.max(e,t[i].size(this.resolveDataElementOptions(i))/2);return e>0&&e}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y),h=o._custom;return{label:i[t]||"",value:"("+a+", "+c+(h?", "+h:"")+")"}}update(t){const e=this._cachedMeta.data;this.updateElements(e,0,e.length,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a}=this._cachedMeta,{sharedOptions:c,includeOptions:h}=this._getSharedOptions(e,s),u=o.axis,d=a.axis;for(let g=e;g<e+i;g++){const m=t[g],y=!r&&this.getParsed(g),v={},w=v[u]=r?o.getPixelForDecimal(.5):o.getPixelForValue(y[u]),S=v[d]=r?a.getBasePixel():a.getPixelForValue(y[d]);v.skip=isNaN(w)||isNaN(S),h&&(v.options=c||this.resolveDataElementOptions(g,m.active?"active":s),r&&(v.options.radius=0)),this.updateElement(m,g,v,s)}}resolveDataElementOptions(t,e){const i=this.getParsed(t);let s=super.resolveDataElementOptions(t,e);s.$shared&&(s=Object.assign({},s,{$shared:!1}));const r=s.radius;return e!=="active"&&(s.radius=0),s.radius+=$(i&&i._custom,r),s}}function Tx(n,t,e){let i=1,s=1,r=0,o=0;if(t<ut){const a=n,c=a+t,h=Math.cos(a),u=Math.sin(a),d=Math.cos(c),g=Math.sin(c),m=(D,V,M)=>Ls(D,a,c,!0)?1:Math.max(V,V*e,M,M*e),y=(D,V,M)=>Ls(D,a,c,!0)?-1:Math.min(V,V*e,M,M*e),v=m(0,h,d),w=m(vt,u,g),S=y(et,h,d),R=y(et+vt,u,g);i=(v-S)/2,s=(w-R)/2,r=-(v+S)/2,o=-(w+R)/2}return{ratioX:i,ratioY:s,offsetX:r,offsetY:o}}class jl extends An{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:t=>t!=="spacing",_indexable:t=>t!=="spacing"&&!t.startsWith("borderDash")&&!t.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data,{labels:{pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=t.legend.options;return e.labels.length&&e.datasets.length?e.labels.map((c,h)=>{const d=t.getDatasetMeta(0).controller.getStyle(h);return{text:c,fillStyle:d.backgroundColor,fontColor:r,hidden:!t.getDataVisibility(h),lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:d.borderWidth,strokeStyle:d.borderColor,textAlign:s,pointStyle:i,borderRadius:o&&(a||d.borderRadius),index:h}}):[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}}};constructor(t,e){super(t,e),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,e){const i=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=i;else{let r=c=>+i[c];if(Z(i[t])){const{key:c="value"}=this._parsing;r=h=>+vn(i[h],c)}let o,a;for(o=t,a=t+e;o<a;++o)s._parsed[o]=r(o)}}_getRotation(){return oe(this.options.rotation-90)}_getCircumference(){return oe(this.options.circumference)}_getRotationExtents(){let t=ut,e=-ut;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)&&this.chart.getDatasetMeta(i).type===this._type){const s=this.chart.getDatasetMeta(i).controller,r=s._getRotation(),o=s._getCircumference();t=Math.min(t,r),e=Math.max(e,r+o)}return{rotation:t,circumference:e-t}}update(t){const e=this.chart,{chartArea:i}=e,s=this._cachedMeta,r=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(r)+this.options.spacing,a=Math.max((Math.min(i.width,i.height)-o)/2,0),c=Math.min(DI(this.options.cutout,a),1),h=this._getRingWeight(this.index),{circumference:u,rotation:d}=this._getRotationExtents(),{ratioX:g,ratioY:m,offsetX:y,offsetY:v}=Tx(d,u,c),w=(i.width-o)/g,S=(i.height-o)/m,R=Math.max(Math.min(w,S)/2,0),D=bm(this.options.radius,R),V=Math.max(D*c,0),M=(D-V)/this._getVisibleDatasetWeightTotal();this.offsetX=y*D,this.offsetY=v*D,s.total=this.calculateTotal(),this.outerRadius=D-M*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-M*h,0),this.updateElements(r,0,r.length,t)}_circumference(t,e){const i=this.options,s=this._cachedMeta,r=this._getCircumference();return e&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||s._parsed[t]===null||s.data[t].hidden?0:this.calculateCircumference(s._parsed[t]*r/ut)}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,a=o.chartArea,h=o.options.animation,u=(a.left+a.right)/2,d=(a.top+a.bottom)/2,g=r&&h.animateScale,m=g?0:this.innerRadius,y=g?0:this.outerRadius,{sharedOptions:v,includeOptions:w}=this._getSharedOptions(e,s);let S=this._getRotation(),R;for(R=0;R<e;++R)S+=this._circumference(R,r);for(R=e;R<e+i;++R){const D=this._circumference(R,r),V=t[R],M={x:u+this.offsetX,y:d+this.offsetY,startAngle:S,endAngle:S+D,circumference:D,outerRadius:y,innerRadius:m};w&&(M.options=v||this.resolveDataElementOptions(R,V.active?"active":s)),S+=D,this.updateElement(V,R,M,s)}}calculateTotal(){const t=this._cachedMeta,e=t.data;let i=0,s;for(s=0;s<e.length;s++){const r=t._parsed[s];r!==null&&!isNaN(r)&&this.chart.getDataVisibility(s)&&!e[s].hidden&&(i+=Math.abs(r))}return i}calculateCircumference(t){const e=this._cachedMeta.total;return e>0&&!isNaN(t)?ut*(Math.abs(t)/e):0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Zs(e._parsed[t],i.options.locale);return{label:s[t]||"",value:r}}getMaxBorderWidth(t){let e=0;const i=this.chart;let s,r,o,a,c;if(!t){for(s=0,r=i.data.datasets.length;s<r;++s)if(i.isDatasetVisible(s)){o=i.getDatasetMeta(s),t=o.data,a=o.controller;break}}if(!t)return 0;for(s=0,r=t.length;s<r;++s)c=a.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(e=Math.max(e,c.borderWidth||0,c.hoverBorderWidth||0));return e}getMaxOffset(t){let e=0;for(let i=0,s=t.length;i<s;++i){const r=this.resolveDataElementOptions(i);e=Math.max(e,r.offset||0,r.hoverOffset||0)}return e}_getRingWeightOffset(t){let e=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(e+=this._getRingWeight(i));return e}_getRingWeight(t){return Math.max($(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Ex extends An{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const e=this._cachedMeta,{dataset:i,data:s=[],_dataset:r}=e,o=this.chart._animationsDisabled;let{start:a,count:c}=Sm(e,s,o);this._drawStart=a,this._drawCount=c,Pm(e)&&(a=0,c=s.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!r._decimated,i.points=s;const h=this.resolveDatasetElementOptions(t);this.options.showLine||(h.borderWidth=0),h.segment=this.options.segment,this.updateElement(i,void 0,{animated:!o,options:h},t),this.updateElements(s,a,c,t)}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:h}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(e,s),g=o.axis,m=a.axis,{spanGaps:y,segment:v}=this.options,w=Ri(y)?y:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||r||s==="none",R=e+i,D=t.length;let V=e>0&&this.getParsed(e-1);for(let M=0;M<D;++M){const L=t[M],E=S?L:{};if(M<e||M>=R){E.skip=!0;continue}const b=this.getParsed(M),T=K(b[m]),x=E[g]=o.getPixelForValue(b[g],M),A=E[m]=r||T?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,b,c):b[m],M);E.skip=isNaN(x)||isNaN(A)||T,E.stop=M>0&&Math.abs(b[g]-V[g])>w,v&&(E.parsed=b,E.raw=h.data[M]),d&&(E.options=u||this.resolveDataElementOptions(M,L.active?"active":s)),S||this.updateElement(L,M,E,s),V=b}}getMaxOverflow(){const t=this._cachedMeta,e=t.dataset,i=e.options&&e.options.borderWidth||0,s=t.data||[];if(!s.length)return i;const r=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(i,r,o)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}class Gm extends An{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(t){const e=t.data;if(e.labels.length&&e.datasets.length){const{labels:{pointStyle:i,color:s}}=t.legend.options;return e.labels.map((r,o)=>{const c=t.getDatasetMeta(0).controller.getStyle(o);return{text:r,fillStyle:c.backgroundColor,strokeStyle:c.borderColor,fontColor:s,lineWidth:c.borderWidth,pointStyle:i,hidden:!t.getDataVisibility(o),index:o}})}return[]}},onClick(t,e,i){i.chart.toggleDataVisibility(e.index),i.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(t,e){super(t,e),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const e=this._cachedMeta,i=this.chart,s=i.data.labels||[],r=Zs(e._parsed[t].r,i.options.locale);return{label:s[t]||"",value:r}}parseObjectData(t,e,i,s){return Nm.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta.data;this._updateRadius(),this.updateElements(e,0,e.length,t)}getMinMax(){const t=this._cachedMeta,e={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,s)=>{const r=this.getParsed(s).r;!isNaN(r)&&this.chart.getDataVisibility(s)&&(r<e.min&&(e.min=r),r>e.max&&(e.max=r))}),e}_updateRadius(){const t=this.chart,e=t.chartArea,i=t.options,s=Math.min(e.right-e.left,e.bottom-e.top),r=Math.max(s/2,0),o=Math.max(i.cutoutPercentage?r/100*i.cutoutPercentage:1,0),a=(r-o)/t.getVisibleDatasetCount();this.outerRadius=r-a*this.index,this.innerRadius=this.outerRadius-a}updateElements(t,e,i,s){const r=s==="reset",o=this.chart,c=o.options.animation,h=this._cachedMeta.rScale,u=h.xCenter,d=h.yCenter,g=h.getIndexAngle(0)-.5*et;let m=g,y;const v=360/this.countVisibleElements();for(y=0;y<e;++y)m+=this._computeAngle(y,s,v);for(y=e;y<e+i;y++){const w=t[y];let S=m,R=m+this._computeAngle(y,s,v),D=o.getDataVisibility(y)?h.getDistanceFromCenterForValue(this.getParsed(y).r):0;m=R,r&&(c.animateScale&&(D=0),c.animateRotate&&(S=R=g));const V={x:u,y:d,innerRadius:0,outerRadius:D,startAngle:S,endAngle:R,options:this.resolveDataElementOptions(y,w.active?"active":s)};this.updateElement(w,y,V,s)}}countVisibleElements(){const t=this._cachedMeta;let e=0;return t.data.forEach((i,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&e++}),e}_computeAngle(t,e,i){return this.chart.getDataVisibility(t)?oe(this.resolveDataElementOptions(t,e).angle||i):0}}class Ix extends jl{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}class Ax extends An{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(t){const e=this._cachedMeta.vScale,i=this.getParsed(t);return{label:e.getLabels()[t],value:""+e.getLabelForValue(i[e.axis])}}parseObjectData(t,e,i,s){return Nm.bind(this)(t,e,i,s)}update(t){const e=this._cachedMeta,i=e.dataset,s=e.data||[],r=e.iScale.getLabels();if(i.points=s,t!=="resize"){const o=this.resolveDatasetElementOptions(t);this.options.showLine||(o.borderWidth=0);const a={_loop:!0,_fullLoop:r.length===s.length,options:o};this.updateElement(i,void 0,a,t)}this.updateElements(s,0,s.length,t)}updateElements(t,e,i,s){const r=this._cachedMeta.rScale,o=s==="reset";for(let a=e;a<e+i;a++){const c=t[a],h=this.resolveDataElementOptions(a,c.active?"active":s),u=r.getPointPositionForValue(a,this.getParsed(a).r),d=o?r.xCenter:u.x,g=o?r.yCenter:u.y,m={x:d,y:g,angle:u.angle,skip:isNaN(d)||isNaN(g),options:h};this.updateElement(c,a,m,s)}}}class xx extends An{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(t){const e=this._cachedMeta,i=this.chart.data.labels||[],{xScale:s,yScale:r}=e,o=this.getParsed(t),a=s.getLabelForValue(o.x),c=r.getLabelForValue(o.y);return{label:i[t]||"",value:"("+a+", "+c+")"}}update(t){const e=this._cachedMeta,{data:i=[]}=e,s=this.chart._animationsDisabled;let{start:r,count:o}=Sm(e,i,s);if(this._drawStart=r,this._drawCount=o,Pm(e)&&(r=0,o=i.length),this.options.showLine){this.datasetElementType||this.addElements();const{dataset:a,_dataset:c}=e;a._chart=this.chart,a._datasetIndex=this.index,a._decimated=!!c._decimated,a.points=i;const h=this.resolveDatasetElementOptions(t);h.segment=this.options.segment,this.updateElement(a,void 0,{animated:!s,options:h},t)}else this.datasetElementType&&(delete e.dataset,this.datasetElementType=!1);this.updateElements(i,r,o,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(t,e,i,s){const r=s==="reset",{iScale:o,vScale:a,_stacked:c,_dataset:h}=this._cachedMeta,u=this.resolveDataElementOptions(e,s),d=this.getSharedOptions(u),g=this.includeOptions(s,d),m=o.axis,y=a.axis,{spanGaps:v,segment:w}=this.options,S=Ri(v)?v:Number.POSITIVE_INFINITY,R=this.chart._animationsDisabled||r||s==="none";let D=e>0&&this.getParsed(e-1);for(let V=e;V<e+i;++V){const M=t[V],L=this.getParsed(V),E=R?M:{},b=K(L[y]),T=E[m]=o.getPixelForValue(L[m],V),x=E[y]=r||b?a.getBasePixel():a.getPixelForValue(c?this.applyStack(a,L,c):L[y],V);E.skip=isNaN(T)||isNaN(x)||b,E.stop=V>0&&Math.abs(L[m]-D[m])>S,w&&(E.parsed=L,E.raw=h.data[V]),g&&(E.options=d||this.resolveDataElementOptions(V,M.active?"active":s)),R||this.updateElement(M,V,E,s),D=L}this.updateSharedOptions(d,s,u)}getMaxOverflow(){const t=this._cachedMeta,e=t.data||[];if(!this.options.showLine){let a=0;for(let c=e.length-1;c>=0;--c)a=Math.max(a,e[c].size(this.resolveDataElementOptions(c))/2);return a>0&&a}const i=t.dataset,s=i.options&&i.options.borderWidth||0;if(!e.length)return s;const r=e[0].size(this.resolveDataElementOptions(0)),o=e[e.length-1].size(this.resolveDataElementOptions(e.length-1));return Math.max(s,r,o)/2}}var Sx=Object.freeze({__proto__:null,BarController:vx,BubbleController:wx,DoughnutController:jl,LineController:Ex,PieController:Ix,PolarAreaController:Gm,RadarController:Ax,ScatterController:xx});function On(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Hl{static override(t){Object.assign(Hl.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return On()}parse(){return On()}format(){return On()}add(){return On()}diff(){return On()}startOf(){return On()}endOf(){return On()}}var Px={_date:Hl};function Rx(n,t,e,i){const{controller:s,data:r,_sorted:o}=n,a=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&t===a.axis&&t!=="r"&&o&&r.length){const h=a._reversePixels?$I:Me;if(i){if(s._sharedOptions){const u=r[0],d=typeof u.getRange=="function"&&u.getRange(t);if(d){const g=h(r,t,e-d),m=h(r,t,e+d);return{lo:g.lo,hi:m.hi}}}}else{const u=h(r,t,e);if(c){const{vScale:d}=s._cachedMeta,{_parsed:g}=n,m=g.slice(0,u.lo+1).reverse().findIndex(v=>!K(v[d.axis]));u.lo-=Math.max(0,m);const y=g.slice(u.hi).findIndex(v=>!K(v[d.axis]));u.hi+=Math.max(0,y)}return u}}return{lo:0,hi:r.length-1}}function qo(n,t,e,i,s){const r=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,c=r.length;a<c;++a){const{index:h,data:u}=r[a],{lo:d,hi:g}=Rx(r[a],t,o,s);for(let m=d;m<=g;++m){const y=u[m];y.skip||i(y,h,m)}}}function Cx(n){const t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(i,s){const r=t?Math.abs(i.x-s.x):0,o=e?Math.abs(i.y-s.y):0;return Math.sqrt(Math.pow(r,2)+Math.pow(o,2))}}function La(n,t,e,i,s){const r=[];return!s&&!n.isPointInArea(t)||qo(n,e,t,function(a,c,h){!s&&!Oe(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&r.push({element:a,datasetIndex:c,index:h})},!0),r}function kx(n,t,e,i){let s=[];function r(o,a,c){const{startAngle:h,endAngle:u}=o.getProps(["startAngle","endAngle"],i),{angle:d}=Tm(o,{x:t.x,y:t.y});Ls(d,h,u)&&s.push({element:o,datasetIndex:a,index:c})}return qo(n,e,t,r),s}function Dx(n,t,e,i,s,r){let o=[];const a=Cx(e);let c=Number.POSITIVE_INFINITY;function h(u,d,g){const m=u.inRange(t.x,t.y,s);if(i&&!m)return;const y=u.getCenterPoint(s);if(!(!!r||n.isPointInArea(y))&&!m)return;const w=a(t,y);w<c?(o=[{element:u,datasetIndex:d,index:g}],c=w):w===c&&o.push({element:u,datasetIndex:d,index:g})}return qo(n,e,t,h),o}function Fa(n,t,e,i,s,r){return!r&&!n.isPointInArea(t)?[]:e==="r"&&!i?kx(n,t,e,s):Dx(n,t,e,i,s,r)}function Xd(n,t,e,i,s){const r=[],o=e==="x"?"inXRange":"inYRange";let a=!1;return qo(n,e,t,(c,h,u)=>{c[o]&&c[o](t[e],s)&&(r.push({element:c,datasetIndex:h,index:u}),a=a||c.inRange(t.x,t.y,s))}),i&&!a?[]:r}var Mx={modes:{index(n,t,e,i){const s=Ln(t,n),r=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?La(n,s,r,i,o):Fa(n,s,r,!1,i,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(h=>{const u=a[0].index,d=h.data[u];d&&!d.skip&&c.push({element:d,datasetIndex:h.index,index:u})}),c):[]},dataset(n,t,e,i){const s=Ln(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;let a=e.intersect?La(n,s,r,i,o):Fa(n,s,r,!1,i,o);if(a.length>0){const c=a[0].datasetIndex,h=n.getDatasetMeta(c).data;a=[];for(let u=0;u<h.length;++u)a.push({element:h[u],datasetIndex:c,index:u})}return a},point(n,t,e,i){const s=Ln(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return La(n,s,r,i,o)},nearest(n,t,e,i){const s=Ln(t,n),r=e.axis||"xy",o=e.includeInvisible||!1;return Fa(n,s,r,e.intersect,i,o)},x(n,t,e,i){const s=Ln(t,n);return Xd(n,s,"x",e.intersect,i)},y(n,t,e,i){const s=Ln(t,n);return Xd(n,s,"y",e.intersect,i)}}};const Km=["left","top","right","bottom"];function is(n,t){return n.filter(e=>e.pos===t)}function Qd(n,t){return n.filter(e=>Km.indexOf(e.pos)===-1&&e.box.axis===t)}function ss(n,t){return n.sort((e,i)=>{const s=t?i:e,r=t?e:i;return s.weight===r.weight?s.index-r.index:s.weight-r.weight})}function Ox(n){const t=[];let e,i,s,r,o,a;for(e=0,i=(n||[]).length;e<i;++e)s=n[e],{position:r,options:{stack:o,stackWeight:a=1}}=s,t.push({index:e,box:s,pos:r,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&r+o,stackWeight:a});return t}function Vx(n){const t={};for(const e of n){const{stack:i,pos:s,stackWeight:r}=e;if(!i||!Km.includes(s))continue;const o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=r}return t}function Nx(n,t){const e=Vx(n),{vBoxMaxWidth:i,hBoxMaxHeight:s}=t;let r,o,a;for(r=0,o=n.length;r<o;++r){a=n[r];const{fullSize:c}=a.box,h=e[a.stack],u=h&&a.stackWeight/h.weight;a.horizontal?(a.width=u?u*i:c&&t.availableWidth,a.height=s):(a.width=i,a.height=u?u*s:c&&t.availableHeight)}return e}function Lx(n){const t=Ox(n),e=ss(t.filter(h=>h.box.fullSize),!0),i=ss(is(t,"left"),!0),s=ss(is(t,"right")),r=ss(is(t,"top"),!0),o=ss(is(t,"bottom")),a=Qd(t,"x"),c=Qd(t,"y");return{fullSize:e,leftAndTop:i.concat(r),rightAndBottom:s.concat(c).concat(o).concat(a),chartArea:is(t,"chartArea"),vertical:i.concat(s).concat(c),horizontal:r.concat(o).concat(a)}}function Jd(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function Ym(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function Fx(n,t,e,i){const{pos:s,box:r}=e,o=n.maxPadding;if(!Z(s)){e.size&&(n[s]-=e.size);const d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?r.height:r.width),e.size=d.size/d.count,n[s]+=e.size}r.getPadding&&Ym(o,r.getPadding());const a=Math.max(0,t.outerWidth-Jd(o,n,"left","right")),c=Math.max(0,t.outerHeight-Jd(o,n,"top","bottom")),h=a!==n.w,u=c!==n.h;return n.w=a,n.h=c,e.horizontal?{same:h,other:u}:{same:u,other:h}}function Bx(n){const t=n.maxPadding;function e(i){const s=Math.max(t[i]-n[i],0);return n[i]+=s,s}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function Ux(n,t){const e=t.maxPadding;function i(s){const r={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{r[o]=Math.max(t[o],e[o])}),r}return i(n?["left","right"]:["top","bottom"])}function ps(n,t,e,i){const s=[];let r,o,a,c,h,u;for(r=0,o=n.length,h=0;r<o;++r){a=n[r],c=a.box,c.update(a.width||t.w,a.height||t.h,Ux(a.horizontal,t));const{same:d,other:g}=Fx(t,e,a,i);h|=d&&s.length,u=u||g,c.fullSize||s.push(a)}return h&&ps(s,t,e,i)||u}function xr(n,t,e,i,s){n.top=e,n.left=t,n.right=t+i,n.bottom=e+s,n.width=i,n.height=s}function Zd(n,t,e,i){const s=e.padding;let{x:r,y:o}=t;for(const a of n){const c=a.box,h=i[a.stack]||{placed:0,weight:1},u=a.stackWeight/h.weight||1;if(a.horizontal){const d=t.w*u,g=h.size||c.height;Ns(h.start)&&(o=h.start),c.fullSize?xr(c,s.left,o,e.outerWidth-s.right-s.left,g):xr(c,t.left+h.placed,o,d,g),h.start=o,h.placed+=d,o=c.bottom}else{const d=t.h*u,g=h.size||c.width;Ns(h.start)&&(r=h.start),c.fullSize?xr(c,r,s.top,g,e.outerHeight-s.bottom-s.top):xr(c,r,t.top+h.placed,g,d),h.start=r,h.placed+=d,r=c.right}}t.x=r,t.y=o}var jt={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){const e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;const s=Wt(n.options.layout.padding),r=Math.max(t-s.width,0),o=Math.max(e-s.height,0),a=Lx(n.boxes),c=a.vertical,h=a.horizontal;it(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const u=c.reduce((v,w)=>w.box.options&&w.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:s,availableWidth:r,availableHeight:o,vBoxMaxWidth:r/2/u,hBoxMaxHeight:o/2}),g=Object.assign({},s);Ym(g,Wt(i));const m=Object.assign({maxPadding:g,w:r,h:o,x:s.left,y:s.top},s),y=Nx(c.concat(h),d);ps(a.fullSize,m,d,y),ps(c,m,d,y),ps(h,m,d,y)&&ps(c,m,d,y),Bx(m),Zd(a.leftAndTop,m,d,y),m.x+=m.w,m.y+=m.h,Zd(a.rightAndBottom,m,d,y),n.chartArea={left:m.left,top:m.top,right:m.left+m.w,bottom:m.top+m.h,height:m.h,width:m.w},it(a.chartArea,v=>{const w=v.box;Object.assign(w,n.chartArea),w.update(m.w,m.h,{left:0,top:0,right:0,bottom:0})})}};class Xm{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,s){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,s?Math.floor(e/s):i)}}isAttached(t){return!0}updateConfig(t){}}class zx extends Xm{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Hr="$chartjs",jx={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},tf=n=>n===null||n==="";function Hx(n,t){const e=n.style,i=n.getAttribute("height"),s=n.getAttribute("width");if(n[Hr]={initial:{height:i,width:s,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",tf(s)){const r=Ld(n,"width");r!==void 0&&(n.width=r)}if(tf(i))if(n.style.height==="")n.height=n.width/(t||2);else{const r=Ld(n,"height");r!==void 0&&(n.height=r)}return n}const Qm=FA?{passive:!0}:!1;function Wx(n,t,e){n&&n.addEventListener(t,e,Qm)}function $x(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,Qm)}function qx(n,t){const e=jx[n.type]||n.type,{x:i,y:s}=Ln(n,t);return{type:e,chart:t,native:n,x:i!==void 0?i:null,y:s!==void 0?s:null}}function _o(n,t){for(const e of n)if(e===t||e.contains(t))return!0}function Gx(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||_o(a.addedNodes,i),o=o&&!_o(a.removedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}function Kx(n,t,e){const i=n.canvas,s=new MutationObserver(r=>{let o=!1;for(const a of r)o=o||_o(a.removedNodes,i),o=o&&!_o(a.addedNodes,i);o&&e()});return s.observe(document,{childList:!0,subtree:!0}),s}const Bs=new Map;let ef=0;function Jm(){const n=window.devicePixelRatio;n!==ef&&(ef=n,Bs.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function Yx(n,t){Bs.size||window.addEventListener("resize",Jm),Bs.set(n,t)}function Xx(n){Bs.delete(n),Bs.size||window.removeEventListener("resize",Jm)}function Qx(n,t,e){const i=n.canvas,s=i&&zl(i);if(!s)return;const r=xm((a,c)=>{const h=s.clientWidth;e(a,c),h<s.clientWidth&&e()},window),o=new ResizeObserver(a=>{const c=a[0],h=c.contentRect.width,u=c.contentRect.height;h===0&&u===0||r(h,u)});return o.observe(s),Yx(n,r),o}function Ba(n,t,e){e&&e.disconnect(),t==="resize"&&Xx(n)}function Jx(n,t,e){const i=n.canvas,s=xm(r=>{n.ctx!==null&&e(qx(r,n))},n);return Wx(i,t,s),s}class Zx extends Xm{acquireContext(t,e){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(Hx(t,e),i):null}releaseContext(t){const e=t.canvas;if(!e[Hr])return!1;const i=e[Hr].initial;["height","width"].forEach(r=>{const o=i[r];K(o)?e.removeAttribute(r):e.setAttribute(r,o)});const s=i.style||{};return Object.keys(s).forEach(r=>{e.style[r]=s[r]}),e.width=e.width,delete e[Hr],!0}addEventListener(t,e,i){this.removeEventListener(t,e);const s=t.$proxies||(t.$proxies={}),o={attach:Gx,detach:Kx,resize:Qx}[e]||Jx;s[e]=o(t,e,i)}removeEventListener(t,e){const i=t.$proxies||(t.$proxies={}),s=i[e];if(!s)return;({attach:Ba,detach:Ba,resize:Ba}[e]||$x)(t,e,s),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,s){return LA(t,e,i,s)}isAttached(t){const e=t&&zl(t);return!!(e&&e.isConnected)}}function tS(n){return!Ul()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?zx:Zx}class ze{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return Ri(this.x)&&Ri(this.y)}getProps(t,e){const i=this.$animations;if(!e||!i)return this;const s={};return t.forEach(r=>{s[r]=i[r]&&i[r].active()?i[r]._to:this[r]}),s}}function eS(n,t){const e=n.options.ticks,i=nS(n),s=Math.min(e.maxTicksLimit||i,i),r=e.major.enabled?sS(t):[],o=r.length,a=r[0],c=r[o-1],h=[];if(o>s)return rS(t,h,r,o/s),h;const u=iS(r,t,s);if(o>0){let d,g;const m=o>1?Math.round((c-a)/(o-1)):null;for(Sr(t,h,u,K(m)?0:a-m,a),d=0,g=o-1;d<g;d++)Sr(t,h,u,r[d],r[d+1]);return Sr(t,h,u,c,K(m)?t.length:c+m),h}return Sr(t,h,u),h}function nS(n){const t=n.options.offset,e=n._tickSize(),i=n._length/e+(t?0:1),s=n._maxLength/e;return Math.floor(Math.min(i,s))}function iS(n,t,e){const i=oS(n),s=t.length/e;if(!i)return Math.max(s,1);const r=UI(i);for(let o=0,a=r.length-1;o<a;o++){const c=r[o];if(c>s)return c}return Math.max(s,1)}function sS(n){const t=[];let e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}function rS(n,t,e,i){let s=0,r=e[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===r&&(t.push(n[o]),s++,r=e[s*i])}function Sr(n,t,e,i,s){const r=$(i,0),o=Math.min($(s,n.length),n.length);let a=0,c,h,u;for(e=Math.ceil(e),s&&(c=s-i,e=c/Math.floor(c/e)),u=r;u<0;)a++,u=Math.round(r+a*e);for(h=Math.max(r,0);h<o;h++)h===u&&(t.push(n[h]),a++,u=Math.round(r+a*e))}function oS(n){const t=n.length;let e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}const aS=n=>n==="left"?"right":n==="right"?"left":n,nf=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,sf=(n,t)=>Math.min(t||n,n);function rf(n,t){const e=[],i=n.length/t,s=n.length;let r=0;for(;r<s;r+=i)e.push(n[Math.floor(r)]);return e}function cS(n,t,e){const i=n.ticks.length,s=Math.min(t,i-1),r=n._startPixel,o=n._endPixel,a=1e-6;let c=n.getPixelForTick(s),h;if(!(e&&(i===1?h=Math.max(c-r,o-c):t===0?h=(n.getPixelForTick(1)-c)/2:h=(c-n.getPixelForTick(s-1))/2,c+=s<t?h:-h,c<r-a||c>o+a)))return c}function lS(n,t){it(n,e=>{const i=e.gc,s=i.length/2;let r;if(s>t){for(r=0;r<s;++r)delete e.data[i[r]];i.splice(0,s)}})}function rs(n){return n.drawTicks?n.tickLength:0}function of(n,t){if(!n.display)return 0;const e=xt(n.font,t),i=Wt(n.padding);return(dt(n.text)?n.text.length:1)*e.lineHeight+i.height}function hS(n,t){return In(n,{scale:t,type:"scale"})}function uS(n,t,e){return In(n,{tick:e,index:t,type:"tick"})}function dS(n,t,e){let i=Ol(n);return(e&&t!=="right"||!e&&t==="right")&&(i=aS(i)),i}function fS(n,t,e,i){const{top:s,left:r,bottom:o,right:a,chart:c}=n,{chartArea:h,scales:u}=c;let d=0,g,m,y;const v=o-s,w=a-r;if(n.isHorizontal()){if(m=Ft(i,r,a),Z(e)){const S=Object.keys(e)[0],R=e[S];y=u[S].getPixelForValue(R)+v-t}else e==="center"?y=(h.bottom+h.top)/2+v-t:y=nf(n,e,t);g=a-r}else{if(Z(e)){const S=Object.keys(e)[0],R=e[S];m=u[S].getPixelForValue(R)-w+t}else e==="center"?m=(h.left+h.right)/2-w+t:m=nf(n,e,t);y=Ft(i,o,s),d=e==="left"?-vt:vt}return{titleX:m,titleY:y,maxWidth:g,rotation:d}}class ei extends ze{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:s}=this;return t=Jt(t,Number.POSITIVE_INFINITY),e=Jt(e,Number.NEGATIVE_INFINITY),i=Jt(i,Number.POSITIVE_INFINITY),s=Jt(s,Number.NEGATIVE_INFINITY),{min:Jt(t,i),max:Jt(e,s),minDefined:_t(t),maxDefined:_t(e)}}getMinMax(t){let{min:e,max:i,minDefined:s,maxDefined:r}=this.getUserBounds(),o;if(s&&r)return{min:e,max:i};const a=this.getMatchingVisibleMetas();for(let c=0,h=a.length;c<h;++c)o=a[c].controller.getMinMax(this,t),s||(e=Math.min(e,o.min)),r||(i=Math.max(i,o.max));return e=r&&e>i?i:e,i=s&&e>i?e:i,{min:Jt(e,Jt(i,e)),max:Jt(i,Jt(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){at(this.options.beforeUpdate,[this])}update(t,e,i){const{beginAtZero:s,grace:r,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=pA(this,r,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=a<this.ticks.length;this._convertTicksToLabels(c?rf(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=eS(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){at(this.options.afterUpdate,[this])}beforeSetDimensions(){at(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){at(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),at(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){at(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const e=this.options.ticks;let i,s,r;for(i=0,s=t.length;i<s;i++)r=t[i],r.label=at(e.callback,[r.value,i,t],this)}afterTickToLabelConversion(){at(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){at(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,e=t.ticks,i=sf(this.ticks.length,t.ticks.maxTicksLimit),s=e.minRotation||0,r=e.maxRotation;let o=s,a,c,h;if(!this._isVisible()||!e.display||s>=r||i<=1||!this.isHorizontal()){this.labelRotation=s;return}const u=this._getLabelSizes(),d=u.widest.width,g=u.highest.height,m=Ct(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/i:m/(i-1),d+6>a&&(a=m/(i-(t.offset?.5:1)),c=this.maxHeight-rs(t.grid)-e.padding-of(t.title,this.chart.options.font),h=Math.sqrt(d*d+g*g),o=Dl(Math.min(Math.asin(Ct((u.highest.height+6)/a,-1,1)),Math.asin(Ct(c/h,-1,1))-Math.asin(Ct(g/h,-1,1)))),o=Math.max(s,Math.min(r,o))),this.labelRotation=o}afterCalculateLabelRotation(){at(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){at(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:e,options:{ticks:i,title:s,grid:r}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const c=of(s,e.options.font);if(a?(t.width=this.maxWidth,t.height=rs(r)+c):(t.height=this.maxHeight,t.width=rs(r)+c),i.display&&this.ticks.length){const{first:h,last:u,widest:d,highest:g}=this._getLabelSizes(),m=i.padding*2,y=oe(this.labelRotation),v=Math.cos(y),w=Math.sin(y);if(a){const S=i.mirror?0:w*d.width+v*g.height;t.height=Math.min(this.maxHeight,t.height+S+m)}else{const S=i.mirror?0:v*d.width+w*g.height;t.width=Math.min(this.maxWidth,t.width+S+m)}this._calculatePadding(h,u,w,v)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,s){const{ticks:{align:r,padding:o},position:a}=this.options,c=this.labelRotation!==0,h=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,m=0;c?h?(g=s*t.width,m=i*e.height):(g=i*t.height,m=s*e.width):r==="start"?m=e.width:r==="end"?g=t.width:r!=="inner"&&(g=t.width/2,m=e.width/2),this.paddingLeft=Math.max((g-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((m-d+o)*this.width/(this.width-d),0)}else{let u=e.height/2,d=t.height/2;r==="start"?(u=0,d=t.height):r==="end"&&(u=e.height,d=0),this.paddingTop=u+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){at(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)K(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const e=this.options.ticks.sampleSize;let i=this.ticks;e<i.length&&(i=rf(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){const{ctx:s,_longestTextCache:r}=this,o=[],a=[],c=Math.floor(e/sf(e,i));let h=0,u=0,d,g,m,y,v,w,S,R,D,V,M;for(d=0;d<e;d+=c){if(y=t[d].label,v=this._resolveTickFontOptions(d),s.font=w=v.string,S=r[w]=r[w]||{data:{},gc:[]},R=v.lineHeight,D=V=0,!K(y)&&!dt(y))D=po(s,S.data,S.gc,D,y),V=R;else if(dt(y))for(g=0,m=y.length;g<m;++g)M=y[g],!K(M)&&!dt(M)&&(D=po(s,S.data,S.gc,D,M),V+=R);o.push(D),a.push(V),h=Math.max(D,h),u=Math.max(V,u)}lS(r,e);const L=o.indexOf(h),E=a.indexOf(u),b=T=>({width:o[T]||0,height:a[T]||0});return{first:b(0),last:b(e-1),widest:b(L),highest:b(E),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const e=this._startPixel+t*this._length;return WI(this._alignToPixels?Mn(this.chart,e,0):e)}getDecimalForPixel(t){const e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){const e=this.ticks||[];if(t>=0&&t<e.length){const i=e[t];return i.$context||(i.$context=uS(this.getContext(),t,i))}return this.$context||(this.$context=hS(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,e=oe(this.labelRotation),i=Math.abs(Math.cos(e)),s=Math.abs(Math.sin(e)),r=this._getLabelSizes(),o=t.autoSkipPadding||0,a=r?r.widest.width+o:0,c=r?r.highest.height+o:0;return this.isHorizontal()?c*i>a*s?a/i:c/s:c*s<a*i?c/i:a/s}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const e=this.axis,i=this.chart,s=this.options,{grid:r,position:o,border:a}=s,c=r.offset,h=this.isHorizontal(),d=this.ticks.length+(c?1:0),g=rs(r),m=[],y=a.setContext(this.getContext()),v=y.display?y.width:0,w=v/2,S=function(ot){return Mn(i,ot,v)};let R,D,V,M,L,E,b,T,x,A,P,I;if(o==="top")R=S(this.bottom),E=this.bottom-g,T=R-w,A=S(t.top)+w,I=t.bottom;else if(o==="bottom")R=S(this.top),A=t.top,I=S(t.bottom)-w,E=R+w,T=this.top+g;else if(o==="left")R=S(this.right),L=this.right-g,b=R-w,x=S(t.left)+w,P=t.right;else if(o==="right")R=S(this.left),x=t.left,P=S(t.right)-w,L=R+w,b=this.left+g;else if(e==="x"){if(o==="center")R=S((t.top+t.bottom)/2+.5);else if(Z(o)){const ot=Object.keys(o)[0],gt=o[ot];R=S(this.chart.scales[ot].getPixelForValue(gt))}A=t.top,I=t.bottom,E=R+w,T=E+g}else if(e==="y"){if(o==="center")R=S((t.left+t.right)/2);else if(Z(o)){const ot=Object.keys(o)[0],gt=o[ot];R=S(this.chart.scales[ot].getPixelForValue(gt))}L=R-w,b=L-g,x=t.left,P=t.right}const st=$(s.ticks.maxTicksLimit,d),Y=Math.max(1,Math.ceil(d/st));for(D=0;D<d;D+=Y){const ot=this.getContext(D),gt=r.setContext(ot),Vt=a.setContext(ot),yt=gt.lineWidth,je=gt.color,xn=Vt.dash||[],Ee=Vt.dashOffset,He=gt.tickWidth,te=gt.tickColor,Ie=gt.tickBorderDash||[],ie=gt.tickBorderDashOffset;V=cS(this,D,c),V!==void 0&&(M=Mn(i,V,yt),h?L=b=x=P=M:E=T=A=I=M,m.push({tx1:L,ty1:E,tx2:b,ty2:T,x1:x,y1:A,x2:P,y2:I,width:yt,color:je,borderDash:xn,borderDashOffset:Ee,tickWidth:He,tickColor:te,tickBorderDash:Ie,tickBorderDashOffset:ie}))}return this._ticksLength=d,this._borderValue=R,m}_computeLabelItems(t){const e=this.axis,i=this.options,{position:s,ticks:r}=i,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:h,padding:u,mirror:d}=r,g=rs(i.grid),m=g+u,y=d?-u:m,v=-oe(this.labelRotation),w=[];let S,R,D,V,M,L,E,b,T,x,A,P,I="middle";if(s==="top")L=this.bottom-y,E=this._getXAxisLabelAlignment();else if(s==="bottom")L=this.top+y,E=this._getXAxisLabelAlignment();else if(s==="left"){const Y=this._getYAxisLabelAlignment(g);E=Y.textAlign,M=Y.x}else if(s==="right"){const Y=this._getYAxisLabelAlignment(g);E=Y.textAlign,M=Y.x}else if(e==="x"){if(s==="center")L=(t.top+t.bottom)/2+m;else if(Z(s)){const Y=Object.keys(s)[0],ot=s[Y];L=this.chart.scales[Y].getPixelForValue(ot)+m}E=this._getXAxisLabelAlignment()}else if(e==="y"){if(s==="center")M=(t.left+t.right)/2-m;else if(Z(s)){const Y=Object.keys(s)[0],ot=s[Y];M=this.chart.scales[Y].getPixelForValue(ot)}E=this._getYAxisLabelAlignment(g).textAlign}e==="y"&&(c==="start"?I="top":c==="end"&&(I="bottom"));const st=this._getLabelSizes();for(S=0,R=a.length;S<R;++S){D=a[S],V=D.label;const Y=r.setContext(this.getContext(S));b=this.getPixelForTick(S)+r.labelOffset,T=this._resolveTickFontOptions(S),x=T.lineHeight,A=dt(V)?V.length:1;const ot=A/2,gt=Y.color,Vt=Y.textStrokeColor,yt=Y.textStrokeWidth;let je=E;o?(M=b,E==="inner"&&(S===R-1?je=this.options.reverse?"left":"right":S===0?je=this.options.reverse?"right":"left":je="center"),s==="top"?h==="near"||v!==0?P=-A*x+x/2:h==="center"?P=-st.highest.height/2-ot*x+x:P=-st.highest.height+x/2:h==="near"||v!==0?P=x/2:h==="center"?P=st.highest.height/2-ot*x:P=st.highest.height-A*x,d&&(P*=-1),v!==0&&!Y.showLabelBackdrop&&(M+=x/2*Math.sin(v))):(L=b,P=(1-A)*x/2);let xn;if(Y.showLabelBackdrop){const Ee=Wt(Y.backdropPadding),He=st.heights[S],te=st.widths[S];let Ie=P-Ee.top,ie=0-Ee.left;switch(I){case"middle":Ie-=He/2;break;case"bottom":Ie-=He;break}switch(E){case"center":ie-=te/2;break;case"right":ie-=te;break;case"inner":S===R-1?ie-=te:S>0&&(ie-=te/2);break}xn={left:ie,top:Ie,width:te+Ee.width,height:He+Ee.height,color:Y.backdropColor}}w.push({label:V,font:T,textOffset:P,options:{rotation:v,color:gt,strokeColor:Vt,strokeWidth:yt,textAlign:je,textBaseline:I,translation:[M,L],backdrop:xn}})}return w}_getXAxisLabelAlignment(){const{position:t,ticks:e}=this.options;if(-oe(this.labelRotation))return t==="top"?"left":"right";let s="center";return e.align==="start"?s="left":e.align==="end"?s="right":e.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(t){const{position:e,ticks:{crossAlign:i,mirror:s,padding:r}}=this.options,o=this._getLabelSizes(),a=t+r,c=o.widest.width;let h,u;return e==="left"?s?(u=this.right+r,i==="near"?h="left":i==="center"?(h="center",u+=c/2):(h="right",u+=c)):(u=this.right-a,i==="near"?h="right":i==="center"?(h="center",u-=c/2):(h="left",u=this.left)):e==="right"?s?(u=this.left+r,i==="near"?h="right":i==="center"?(h="center",u-=c/2):(h="left",u-=c)):(u=this.left+a,i==="near"?h="left":i==="center"?(h="center",u+=c/2):(h="right",u=this.right)):h="right",{textAlign:h,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:e},left:i,top:s,width:r,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,s,r,o),t.restore())}getLineWidthForValue(t){const e=this.options.grid;if(!this._isVisible()||!e.display)return 0;const s=this.ticks.findIndex(r=>r.value===t);return s>=0?e.setContext(this.getContext(s)).lineWidth:0}drawGrid(t){const e=this.options.grid,i=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let r,o;const a=(c,h,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(h.x,h.y),i.stroke(),i.restore())};if(e.display)for(r=0,o=s.length;r<o;++r){const c=s[r];e.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),e.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:e,options:{border:i,grid:s}}=this,r=i.setContext(this.getContext()),o=i.display?r.width:0;if(!o)return;const a=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let h,u,d,g;this.isHorizontal()?(h=Mn(t,this.left,o)-o/2,u=Mn(t,this.right,a)+a/2,d=g=c):(d=Mn(t,this.top,o)-o/2,g=Mn(t,this.bottom,a)+a/2,h=u=c),e.save(),e.lineWidth=r.width,e.strokeStyle=r.color,e.beginPath(),e.moveTo(h,d),e.lineTo(u,g),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,s=this._computeLabelArea();s&&Ho(i,s);const r=this.getLabelItems(t);for(const o of r){const a=o.options,c=o.font,h=o.label,u=o.textOffset;Xn(i,h,0,u,c,a)}s&&Wo(i)}drawTitle(){const{ctx:t,options:{position:e,title:i,reverse:s}}=this;if(!i.display)return;const r=xt(i.font),o=Wt(i.padding),a=i.align;let c=r.lineHeight/2;e==="bottom"||e==="center"||Z(e)?(c+=o.bottom,dt(i.text)&&(c+=r.lineHeight*(i.text.length-1))):c+=o.top;const{titleX:h,titleY:u,maxWidth:d,rotation:g}=fS(this,c,e,a);Xn(t,i.text,0,0,r,{color:i.color,maxWidth:d,rotation:g,textAlign:dS(a,e,s),textBaseline:"middle",translation:[h,u]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,e=t.ticks&&t.ticks.z||0,i=$(t.grid&&t.grid.z,-1),s=$(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==ei.prototype.draw?[{z:e,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:e,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",s=[];let r,o;for(r=0,o=e.length;r<o;++r){const a=e[r];a[i]===this.id&&(!t||a.type===t)&&s.push(a)}return s}_resolveTickFontOptions(t){const e=this.options.ticks.setContext(this.getContext(t));return xt(e.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Pr{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const e=Object.getPrototypeOf(t);let i;mS(e)&&(i=this.register(e));const s=this.items,r=t.id,o=this.scope+"."+r;if(!r)throw new Error("class does not have id: "+t);return r in s||(s[r]=t,gS(t,o,i),this.override&&ft.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){const e=this.items,i=t.id,s=this.scope;i in e&&delete e[i],s&&i in ft[s]&&(delete ft[s][i],this.override&&delete Yn[i])}}function gS(n,t,e){const i=Vs(Object.create(null),[e?ft.get(e):{},ft.get(t),n.defaults]);ft.set(t,i),n.defaultRoutes&&pS(t,n.defaultRoutes),n.descriptors&&ft.describe(t,n.descriptors)}function pS(n,t){Object.keys(t).forEach(e=>{const i=e.split("."),s=i.pop(),r=[n].concat(i).join("."),o=t[e].split("."),a=o.pop(),c=o.join(".");ft.route(r,s,c,a)})}function mS(n){return"id"in n&&"defaults"in n}class _S{constructor(){this.controllers=new Pr(An,"datasets",!0),this.elements=new Pr(ze,"elements"),this.plugins=new Pr(Object,"plugins"),this.scales=new Pr(ei,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(s=>{const r=i||this._getRegistryForType(s);i||r.isForType(s)||r===this.plugins&&s.id?this._exec(t,r,s):it(s,o=>{const a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,i){const s=kl(t);at(i["before"+s],[],i),e[t](i),at(i["after"+s],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){const i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){const s=e.get(t);if(s===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return s}}var de=new _S;class yS{constructor(){this._init=void 0}notify(t,e,i,s){if(e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install")),this._init===void 0)return;const r=s?this._descriptors(t).filter(s):this._descriptors(t),o=this._notify(r,t,e,i);return e==="afterDestroy"&&(this._notify(r,t,"stop"),this._notify(this._init,t,"uninstall"),this._init=void 0),o}_notify(t,e,i,s){s=s||{};for(const r of t){const o=r.plugin,a=o[i],c=[e,s,r.options];if(at(a,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){K(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){const i=t&&t.config,s=$(i.options&&i.options.plugins,{}),r=bS(i);return s===!1&&!e?[]:wS(t,r,s,e)}_notifyStateChanges(t){const e=this._oldCache||[],i=this._cache,s=(r,o)=>r.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(s(e,i),t,"stop"),this._notify(s(i,e),t,"start")}}function bS(n){const t={},e=[],i=Object.keys(de.plugins.items);for(let r=0;r<i.length;r++)e.push(de.getPlugin(i[r]));const s=n.plugins||[];for(let r=0;r<s.length;r++){const o=s[r];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function vS(n,t){return!t&&n===!1?null:n===!0?{}:n}function wS(n,{plugins:t,localIds:e},i,s){const r=[],o=n.getContext();for(const a of t){const c=a.id,h=vS(i[c],s);h!==null&&r.push({plugin:a,options:TS(n.config,{plugin:a,local:e[c]},h,o)})}return r}function TS(n,{plugin:t,local:e},i,s){const r=n.pluginScopeKeys(t),o=n.getOptionScopes(i,r);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ec(n,t){const e=ft.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function ES(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function IS(n,t){return n===t?"_index_":"_value_"}function af(n){if(n==="x"||n==="y"||n==="r")return n}function AS(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Ic(n,...t){if(af(n))return n;for(const e of t){const i=e.axis||AS(e.position)||n.length>1&&af(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function cf(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function xS(n,t){if(t.data&&t.data.datasets){const e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return cf(n,"x",e[0])||cf(n,"y",e[0])}return{}}function SS(n,t){const e=Yn[n.type]||{scales:{}},i=t.scales||{},s=Ec(n.type,t),r=Object.create(null);return Object.keys(i).forEach(o=>{const a=i[o];if(!Z(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=Ic(o,a,xS(o,n),ft.scales[a.type]),h=IS(c,s),u=e.scales||{};r[o]=Es(Object.create(null),[{axis:c},a,u[c],u[h]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,c=o.indexAxis||Ec(a,t),u=(Yn[a]||{}).scales||{};Object.keys(u).forEach(d=>{const g=ES(d,c),m=o[g+"AxisID"]||g;r[m]=r[m]||Object.create(null),Es(r[m],[{axis:g},i[m],u[d]])})}),Object.keys(r).forEach(o=>{const a=r[o];Es(a,[ft.scales[a.type],ft.scale])}),r}function Zm(n){const t=n.options||(n.options={});t.plugins=$(t.plugins,{}),t.scales=SS(n,t)}function t_(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function PS(n){return n=n||{},n.data=t_(n.data),Zm(n),n}const lf=new Map,e_=new Set;function Rr(n,t){let e=lf.get(n);return e||(e=t(),lf.set(n,e),e_.add(e)),e}const os=(n,t,e)=>{const i=vn(t,e);i!==void 0&&n.add(i)};class RS{constructor(t){this._config=PS(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=t_(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Zm(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Rr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Rr(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Rr(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){const e=t.id,i=this.type;return Rr(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){const i=this._scopeCache;let s=i.get(t);return(!s||e)&&(s=new Map,i.set(t,s)),s}getOptionScopes(t,e,i){const{options:s,type:r}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;const c=new Set;e.forEach(u=>{t&&(c.add(t),u.forEach(d=>os(c,t,d))),u.forEach(d=>os(c,s,d)),u.forEach(d=>os(c,Yn[r]||{},d)),u.forEach(d=>os(c,ft,d)),u.forEach(d=>os(c,wc,d))});const h=Array.from(c);return h.length===0&&h.push(Object.create(null)),e_.has(e)&&o.set(e,h),h}chartOptionScopes(){const{options:t,type:e}=this;return[t,Yn[e]||{},ft.datasets[e]||{},{type:e},ft,wc]}resolveNamedOptions(t,e,i,s=[""]){const r={$shared:!0},{resolver:o,subPrefixes:a}=hf(this._resolverCache,t,s);let c=o;if(kS(o,e)){r.$shared=!1,i=wn(i)?i():i;const h=this.createResolver(t,i,a);c=Ci(o,i,h)}for(const h of e)r[h]=c[h];return r}createResolver(t,e,i=[""],s){const{resolver:r}=hf(this._resolverCache,t,i);return Z(e)?Ci(r,e,void 0,s):r}}function hf(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));const s=e.join();let r=i.get(s);return r||(r={resolver:Ll(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(s,r)),r}const CS=n=>Z(n)&&Object.getOwnPropertyNames(n).some(t=>wn(n[t]));function kS(n,t){const{isScriptable:e,isIndexable:i}=Dm(n);for(const s of t){const r=e(s),o=i(s),a=(o||r)&&n[s];if(r&&(wn(a)||CS(a))||o&&dt(a))return!0}return!1}var DS="4.5.1";const MS=["top","bottom","left","right","chartArea"];function uf(n,t){return n==="top"||n==="bottom"||MS.indexOf(n)===-1&&t==="x"}function df(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function ff(n){const t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),at(e&&e.onComplete,[n],t)}function OS(n){const t=n.chart,e=t.options.animation;at(e&&e.onProgress,[n],t)}function n_(n){return Ul()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Wr={},gf=n=>{const t=n_(n);return Object.values(Wr).filter(e=>e.canvas===t).pop()};function VS(n,t,e){const i=Object.keys(n);for(const s of i){const r=+s;if(r>=t){const o=n[s];delete n[s],(e>0||r>t)&&(n[r+e]=o)}}}function NS(n,t,e,i){return!e||n.type==="mouseout"?null:i?t:n}class Wl{static defaults=ft;static instances=Wr;static overrides=Yn;static registry=de;static version=DS;static getChart=gf;static register(...t){de.add(...t),pf()}static unregister(...t){de.remove(...t),pf()}constructor(t,e){const i=this.config=new RS(e),s=n_(t),r=gf(s);if(r)throw new Error("Canvas is already in use. Chart with ID '"+r.id+"' must be destroyed before the canvas with ID '"+r.canvas.id+"' can be reused.");const o=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||tS(s)),this.platform.updateConfig(i);const a=this.platform.acquireContext(s,o.aspectRatio),c=a&&a.canvas,h=c&&c.height,u=c&&c.width;if(this.id=kI(),this.ctx=a,this.canvas=c,this.width=u,this.height=h,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new yS,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=KI(d=>this.update(d),o.resizeDelay||0),this._dataChanges=[],Wr[this.id]=this,!a||!c){console.error("Failed to create chart: can't acquire context from the given item");return}xe.listen(this,"complete",ff),xe.listen(this,"progress",OS),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:e},width:i,height:s,_aspectRatio:r}=this;return K(t)?e&&r?r:s?i/s:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}get registry(){return de}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Nd(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Md(this.canvas,this.ctx),this}stop(){return xe.stop(this),this}resize(t,e){xe.running(this)?this._resizeBeforeDraw={width:t,height:e}:this._resize(t,e)}_resize(t,e){const i=this.options,s=this.canvas,r=i.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,t,e,r),a=i.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Nd(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),at(i.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const e=this.options.scales||{};it(e,(i,s)=>{i.id=s})}buildOrUpdateScales(){const t=this.options,e=t.scales,i=this.scales,s=Object.keys(i).reduce((o,a)=>(o[a]=!1,o),{});let r=[];e&&(r=r.concat(Object.keys(e).map(o=>{const a=e[o],c=Ic(o,a),h=c==="r",u=c==="x";return{options:a,dposition:h?"chartArea":u?"bottom":"left",dtype:h?"radialLinear":u?"category":"linear"}}))),it(r,o=>{const a=o.options,c=a.id,h=Ic(c,a),u=$(a.type,o.dtype);(a.position===void 0||uf(a.position,h)!==uf(o.dposition))&&(a.position=o.dposition),s[c]=!0;let d=null;if(c in i&&i[c].type===u)d=i[c];else{const g=de.getScale(u);d=new g({id:c,type:u,ctx:this.ctx,chart:this}),i[d.id]=d}d.init(a,t)}),it(s,(o,a)=>{o||delete i[a]}),it(i,o=>{jt.configure(this,o,o.options),jt.addBox(this,o)})}_updateMetasets(){const t=this._metasets,e=this.data.datasets.length,i=t.length;if(t.sort((s,r)=>s.index-r.index),i>e){for(let s=e;s<i;++s)this._destroyDatasetMeta(s);t.splice(e,i-e)}this._sortedMetasets=t.slice(0).sort(df("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:e}}=this;t.length>e.length&&delete this._stacks,t.forEach((i,s)=>{e.filter(r=>r===i._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const t=[],e=this.data.datasets;let i,s;for(this._removeUnreferencedMetasets(),i=0,s=e.length;i<s;i++){const r=e[i];let o=this.getDatasetMeta(i);const a=r.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(i),o=this.getDatasetMeta(i)),o.type=a,o.indexAxis=r.indexAxis||Ec(a,this.options),o.order=r.order||0,o.index=i,o.label=""+r.label,o.visible=this.isDatasetVisible(i),o.controller)o.controller.updateIndex(i),o.controller.linkScales();else{const c=de.getController(a),{datasetElementType:h,dataElementType:u}=ft.datasets[a];Object.assign(c,{dataElementType:de.getElement(u),datasetElementType:h&&de.getElement(h)}),o.controller=new c(this,i),t.push(o.controller)}}return this._updateMetasets(),t}_resetElements(){it(this.data.datasets,(t,e)=>{this.getDatasetMeta(e).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const e=this.config;e.update();const i=this._options=e.createResolver(e.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const r=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let h=0,u=this.data.datasets.length;h<u;h++){const{controller:d}=this.getDatasetMeta(h),g=!s&&r.indexOf(d)===-1;d.buildOrUpdateElements(g),o=Math.max(+d.getMaxOverflow(),o)}o=this._minPadding=i.layout.autoPadding?o:0,this._updateLayout(o),s||it(r,h=>{h.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(df("z","_idx"));const{_active:a,_lastEvent:c}=this;c?this._eventHandler(c,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){it(this.scales,t=>{jt.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,e=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Id(e,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,e=this._getUniformDataChanges()||[];for(const{method:i,start:s,count:r}of e){const o=i==="_removeElements"?-r:r;VS(t,s,o)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const e=this.data.datasets.length,i=r=>new Set(t.filter(o=>o[0]===r).map((o,a)=>a+","+o.splice(1).join(","))),s=i(0);for(let r=1;r<e;r++)if(!Id(s,i(r)))return;return Array.from(s).map(r=>r.split(",")).map(r=>({method:r[1],start:+r[2],count:+r[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;jt.update(this,this.width,this.height,t);const e=this.chartArea,i=e.width<=0||e.height<=0;this._layers=[],it(this.boxes,s=>{i&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,r)=>{s._idx=r}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let e=0,i=this.data.datasets.length;e<i;++e)this.getDatasetMeta(e).controller.configure();for(let e=0,i=this.data.datasets.length;e<i;++e)this._updateDataset(e,wn(t)?t({datasetIndex:e}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,e){const i=this.getDatasetMeta(t),s={meta:i,index:t,mode:e,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(i.controller._update(e),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(xe.has(this)?this.attached&&!xe.running(this)&&xe.start(this):(this.draw(),ff({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(i,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const e=this._layers;for(t=0;t<e.length&&e[t].z<=0;++t)e[t].draw(this.chartArea);for(this._drawDatasets();t<e.length;++t)e[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const e=this._sortedMetasets,i=[];let s,r;for(s=0,r=e.length;s<r;++s){const o=e[s];(!t||o.visible)&&i.push(o)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let e=t.length-1;e>=0;--e)this._drawDataset(t[e]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const e=this.ctx,i={meta:t,index:t.index,cancelable:!0},s=Hm(this,t);this.notifyPlugins("beforeDatasetDraw",i)!==!1&&(s&&Ho(e,s),t.controller.draw(),s&&Wo(e),i.cancelable=!1,this.notifyPlugins("afterDatasetDraw",i))}isPointInArea(t){return Oe(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,e,i,s){const r=Mx.modes[e];return typeof r=="function"?r(this,t,i,s):[]}getDatasetMeta(t){const e=this.data.datasets[t],i=this._metasets;let s=i.filter(r=>r&&r._dataset===e).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:e&&e.order||0,index:t,_dataset:e,_parsed:[],_sorted:!1},i.push(s)),s}getContext(){return this.$context||(this.$context=In(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const e=this.data.datasets[t];if(!e)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!e.hidden}setDatasetVisibility(t,e){const i=this.getDatasetMeta(t);i.hidden=!e}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,e,i){const s=i?"show":"hide",r=this.getDatasetMeta(t),o=r.controller._resolveAnimations(void 0,s);Ns(e)?(r.data[e].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),o.update(r,{visible:i}),this.update(a=>a.datasetIndex===t?s:void 0))}hide(t,e){this._updateVisibility(t,e,!1)}show(t,e){this._updateVisibility(t,e,!0)}_destroyDatasetMeta(t){const e=this._metasets[t];e&&e.controller&&e.controller._destroy(),delete this._metasets[t]}_stop(){let t,e;for(this.stop(),xe.remove(this),t=0,e=this.data.datasets.length;t<e;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:e}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),Md(t,e),this.platform.releaseContext(e),this.canvas=null,this.ctx=null),delete Wr[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,e=this.platform,i=(r,o)=>{e.addEventListener(this,r,o),t[r]=o},s=(r,o,a)=>{r.offsetX=o,r.offsetY=a,this._eventHandler(r)};it(this.options.events,r=>i(r,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,e=this.platform,i=(c,h)=>{e.addEventListener(this,c,h),t[c]=h},s=(c,h)=>{t[c]&&(e.removeEventListener(this,c,h),delete t[c])},r=(c,h)=>{this.canvas&&this.resize(c,h)};let o;const a=()=>{s("attach",a),this.attached=!0,this.resize(),i("resize",r),i("detach",o)};o=()=>{this.attached=!1,s("resize",r),this._stop(),this._resize(0,0),i("attach",a)},e.isAttached(this.canvas)?a():o()}unbindEvents(){it(this._listeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._listeners={},it(this._responsiveListeners,(t,e)=>{this.platform.removeEventListener(this,e,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,e,i){const s=i?"set":"remove";let r,o,a,c;for(e==="dataset"&&(r=this.getDatasetMeta(t[0].datasetIndex),r.controller["_"+s+"DatasetHoverStyle"]()),a=0,c=t.length;a<c;++a){o=t[a];const h=o&&this.getDatasetMeta(o.datasetIndex).controller;h&&h[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const e=this._active||[],i=t.map(({datasetIndex:r,index:o})=>{const a=this.getDatasetMeta(r);if(!a)throw new Error("No dataset found at index "+r);return{datasetIndex:r,element:a.data[o],index:o}});!uo(i,e)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,e))}notifyPlugins(t,e,i){return this._plugins.notify(this,t,e,i)}isPluginEnabled(t){return this._plugins._cache.filter(e=>e.plugin.id===t).length===1}_updateHoverStyles(t,e,i){const s=this.options.hover,r=(c,h)=>c.filter(u=>!h.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),o=r(e,t),a=i?t:r(t,e);o.length&&this.updateHoverStyle(o,s.mode,!1),a.length&&s.mode&&this.updateHoverStyle(a,s.mode,!0)}_eventHandler(t,e){const i={event:t,replay:e,cancelable:!0,inChartArea:this.isPointInArea(t)},s=o=>(o.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,s)===!1)return;const r=this._handleEvent(t,e,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,s),(r||i.changed)&&this.render(),this}_handleEvent(t,e,i){const{_active:s=[],options:r}=this,o=e,a=this._getActiveElements(t,s,i,o),c=LI(t),h=NS(t,this._lastEvent,i,c);i&&(this._lastEvent=null,at(r.onHover,[t,a,this],this),c&&at(r.onClick,[t,a,this],this));const u=!uo(a,s);return(u||e)&&(this._active=a,this._updateHoverStyles(a,s,e)),this._lastEvent=h,u}_getActiveElements(t,e,i,s){if(t.type==="mouseout")return[];if(!i)return e;const r=this.options.hover;return this.getElementsAtEventForMode(t,r.mode,r,s)}}function pf(){return it(Wl.instances,n=>n._plugins.invalidate())}function LS(n,t,e){const{startAngle:i,x:s,y:r,outerRadius:o,innerRadius:a,options:c}=t,{borderWidth:h,borderJoinStyle:u}=c,d=Math.min(h/o,Ut(i-e));if(n.beginPath(),n.arc(s,r,o-h/2,i+d/2,e-d/2),a>0){const g=Math.min(h/a,Ut(i-e));n.arc(s,r,a+h/2,e-g/2,i+g/2,!0)}else{const g=Math.min(h/2,o*Ut(i-e));if(u==="round")n.arc(s,r,g,e-et/2,i+et/2,!0);else if(u==="bevel"){const m=2*g*g,y=-m*Math.cos(e+et/2)+s,v=-m*Math.sin(e+et/2)+r,w=m*Math.cos(i+et/2)+s,S=m*Math.sin(i+et/2)+r;n.lineTo(y,v),n.lineTo(w,S)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function FS(n,t,e){const{startAngle:i,pixelMargin:s,x:r,y:o,outerRadius:a,innerRadius:c}=t;let h=s/a;n.beginPath(),n.arc(r,o,a,i-h,e+h),c>s?(h=s/c,n.arc(r,o,c,e+h,i-h,!0)):n.arc(r,o,s,e+vt,i-vt),n.closePath(),n.clip()}function BS(n){return Nl(n,["outerStart","outerEnd","innerStart","innerEnd"])}function US(n,t,e,i){const s=BS(n.options.borderRadius),r=(e-t)/2,o=Math.min(r,i*t/2),a=c=>{const h=(e-Math.min(r,c))*i/2;return Ct(c,0,Math.min(r,h))};return{outerStart:a(s.outerStart),outerEnd:a(s.outerEnd),innerStart:Ct(s.innerStart,0,o),innerEnd:Ct(s.innerEnd,0,o)}}function oi(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function yo(n,t,e,i,s,r){const{x:o,y:a,startAngle:c,pixelMargin:h,innerRadius:u}=t,d=Math.max(t.outerRadius+i+e-h,0),g=u>0?u+i+e+h:0;let m=0;const y=s-c;if(i){const Y=u>0?u-i:0,ot=d>0?d-i:0,gt=(Y+ot)/2,Vt=gt!==0?y*gt/(gt+i):y;m=(y-Vt)/2}const v=Math.max(.001,y*d-e/et)/d,w=(y-v)/2,S=c+w+m,R=s-w-m,{outerStart:D,outerEnd:V,innerStart:M,innerEnd:L}=US(t,g,d,R-S),E=d-D,b=d-V,T=S+D/E,x=R-V/b,A=g+M,P=g+L,I=S+M/A,st=R-L/P;if(n.beginPath(),r){const Y=(T+x)/2;if(n.arc(o,a,d,T,Y),n.arc(o,a,d,Y,x),V>0){const yt=oi(b,x,o,a);n.arc(yt.x,yt.y,V,x,R+vt)}const ot=oi(P,R,o,a);if(n.lineTo(ot.x,ot.y),L>0){const yt=oi(P,st,o,a);n.arc(yt.x,yt.y,L,R+vt,st+Math.PI)}const gt=(R-L/g+(S+M/g))/2;if(n.arc(o,a,g,R-L/g,gt,!0),n.arc(o,a,g,gt,S+M/g,!0),M>0){const yt=oi(A,I,o,a);n.arc(yt.x,yt.y,M,I+Math.PI,S-vt)}const Vt=oi(E,S,o,a);if(n.lineTo(Vt.x,Vt.y),D>0){const yt=oi(E,T,o,a);n.arc(yt.x,yt.y,D,S-vt,T)}}else{n.moveTo(o,a);const Y=Math.cos(T)*d+o,ot=Math.sin(T)*d+a;n.lineTo(Y,ot);const gt=Math.cos(x)*d+o,Vt=Math.sin(x)*d+a;n.lineTo(gt,Vt)}n.closePath()}function zS(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a}=t;let c=t.endAngle;if(r){yo(n,t,e,i,c,s);for(let h=0;h<r;++h)n.fill();isNaN(a)||(c=o+(a%ut||ut))}return yo(n,t,e,i,c,s),n.fill(),c}function jS(n,t,e,i,s){const{fullCircles:r,startAngle:o,circumference:a,options:c}=t,{borderWidth:h,borderJoinStyle:u,borderDash:d,borderDashOffset:g,borderRadius:m}=c,y=c.borderAlign==="inner";if(!h)return;n.setLineDash(d||[]),n.lineDashOffset=g,y?(n.lineWidth=h*2,n.lineJoin=u||"round"):(n.lineWidth=h,n.lineJoin=u||"bevel");let v=t.endAngle;if(r){yo(n,t,e,i,v,s);for(let w=0;w<r;++w)n.stroke();isNaN(a)||(v=o+(a%ut||ut))}y&&FS(n,t,v),c.selfJoin&&v-o>=et&&m===0&&u!=="miter"&&LS(n,t,v),r||(yo(n,t,e,i,v,s),n.stroke())}class HS extends ze{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.getProps(["x","y"],i),{angle:r,distance:o}=Tm(s,{x:t,y:e}),{startAngle:a,endAngle:c,innerRadius:h,outerRadius:u,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),g=(this.options.spacing+this.options.borderWidth)/2,m=$(d,c-a),y=Ls(r,a,c)&&a!==c,v=m>=ut||y,w=De(o,h+g,u+g);return v&&w}getCenterPoint(t){const{x:e,y:i,startAngle:s,endAngle:r,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:h}=this.options,u=(s+r)/2,d=(o+a+h+c)/2;return{x:e+Math.cos(u)*d,y:i+Math.sin(u)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:e,circumference:i}=this,s=(e.offset||0)/4,r=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=i>ut?Math.floor(i/ut):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*s,Math.sin(a)*s);const c=1-Math.sin(Math.min(et,i||0)),h=s*c;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,zS(t,this,h,r,o),jS(t,this,h,r,o),t.restore()}}function i_(n,t,e=t){n.lineCap=$(e.borderCapStyle,t.borderCapStyle),n.setLineDash($(e.borderDash,t.borderDash)),n.lineDashOffset=$(e.borderDashOffset,t.borderDashOffset),n.lineJoin=$(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=$(e.borderWidth,t.borderWidth),n.strokeStyle=$(e.borderColor,t.borderColor)}function WS(n,t,e){n.lineTo(e.x,e.y)}function $S(n){return n.stepped?oA:n.tension||n.cubicInterpolationMode==="monotone"?aA:WS}function s_(n,t,e={}){const i=n.length,{start:s=0,end:r=i-1}=e,{start:o,end:a}=t,c=Math.max(s,o),h=Math.min(r,a),u=s<o&&r<o||s>a&&r>a;return{count:i,start:c,loop:t.loop,ilen:h<c&&!u?i+h-c:h-c}}function qS(n,t,e,i){const{points:s,options:r}=t,{count:o,start:a,loop:c,ilen:h}=s_(s,e,i),u=$S(r);let{move:d=!0,reverse:g}=i||{},m,y,v;for(m=0;m<=h;++m)y=s[(a+(g?h-m:m))%o],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):u(n,v,y,g,r.stepped),v=y);return c&&(y=s[(a+(g?h:0))%o],u(n,v,y,g,r.stepped)),!!c}function GS(n,t,e,i){const s=t.points,{count:r,start:o,ilen:a}=s_(s,e,i),{move:c=!0,reverse:h}=i||{};let u=0,d=0,g,m,y,v,w,S;const R=V=>(o+(h?a-V:V))%r,D=()=>{v!==w&&(n.lineTo(u,w),n.lineTo(u,v),n.lineTo(u,S))};for(c&&(m=s[R(0)],n.moveTo(m.x,m.y)),g=0;g<=a;++g){if(m=s[R(g)],m.skip)continue;const V=m.x,M=m.y,L=V|0;L===y?(M<v?v=M:M>w&&(w=M),u=(d*u+V)/++d):(D(),n.lineTo(V,M),y=L,d=0,v=w=M),S=M}D()}function Ac(n){const t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?GS:qS}function KS(n){return n.stepped?BA:n.tension||n.cubicInterpolationMode==="monotone"?UA:Fn}function YS(n,t,e,i){let s=t._path;s||(s=t._path=new Path2D,t.path(s,e,i)&&s.closePath()),i_(n,t.options),n.stroke(s)}function XS(n,t,e,i){const{segments:s,options:r}=t,o=Ac(t);for(const a of s)i_(n,r,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}const QS=typeof Path2D=="function";function JS(n,t,e,i){QS&&!t.options.segment?YS(n,t,e,i):XS(n,t,e,i)}class Go extends ze{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"&&t!=="fill"};constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,e){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const s=i.spanGaps?this._loop:this._fullLoop;kA(this._points,i,t,s,e),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=qA(this,this.options.segment))}first(){const t=this.segments,e=this.points;return t.length&&e[t[0].start]}last(){const t=this.segments,e=this.points,i=t.length;return i&&e[t[i-1].end]}interpolate(t,e){const i=this.options,s=t[e],r=this.points,o=jm(this,{property:e,start:s,end:s});if(!o.length)return;const a=[],c=KS(i);let h,u;for(h=0,u=o.length;h<u;++h){const{start:d,end:g}=o[h],m=r[d],y=r[g];if(m===y){a.push(m);continue}const v=Math.abs((s-m[e])/(y[e]-m[e])),w=c(m,y,v,i.stepped);w[e]=t[e],a.push(w)}return a.length===1?a[0]:a}pathSegment(t,e,i){return Ac(this)(t,this,e,i)}path(t,e,i){const s=this.segments,r=Ac(this);let o=this._loop;e=e||0,i=i||this.points.length-e;for(const a of s)o&=r(t,this,a,{start:e,end:e+i-1});return!!o}draw(t,e,i,s){const r=this.options||{};(this.points||[]).length&&r.borderWidth&&(t.save(),JS(t,this,i,s),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function mf(n,t,e,i){const s=n.options,{[e]:r}=n.getProps([e],i);return Math.abs(t-r)<s.radius+s.hitRadius}class ZS extends ze{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,e,i){const s=this.options,{x:r,y:o}=this.getProps(["x","y"],i);return Math.pow(t-r,2)+Math.pow(e-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,e){return mf(this,t,"x",e)}inYRange(t,e){return mf(this,t,"y",e)}getCenterPoint(t){const{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}size(t){t=t||this.options||{};let e=t.radius||0;e=Math.max(e,e&&t.hoverRadius||0);const i=e&&t.borderWidth||0;return(e+i)*2}draw(t,e){const i=this.options;this.skip||i.radius<.1||!Oe(this,e,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Tc(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}function r_(n,t){const{x:e,y:i,base:s,width:r,height:o}=n.getProps(["x","y","base","width","height"],t);let a,c,h,u,d;return n.horizontal?(d=o/2,a=Math.min(e,s),c=Math.max(e,s),h=i-d,u=i+d):(d=r/2,a=e-d,c=e+d,h=Math.min(i,s),u=Math.max(i,s)),{left:a,top:h,right:c,bottom:u}}function on(n,t,e,i){return n?0:Ct(t,e,i)}function tP(n,t,e){const i=n.options.borderWidth,s=n.borderSkipped,r=km(i);return{t:on(s.top,r.top,0,e),r:on(s.right,r.right,0,t),b:on(s.bottom,r.bottom,0,e),l:on(s.left,r.left,0,t)}}function eP(n,t,e){const{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,r=jn(s),o=Math.min(t,e),a=n.borderSkipped,c=i||Z(s);return{topLeft:on(!c||a.top||a.left,r.topLeft,0,o),topRight:on(!c||a.top||a.right,r.topRight,0,o),bottomLeft:on(!c||a.bottom||a.left,r.bottomLeft,0,o),bottomRight:on(!c||a.bottom||a.right,r.bottomRight,0,o)}}function nP(n){const t=r_(n),e=t.right-t.left,i=t.bottom-t.top,s=tP(n,e/2,i/2),r=eP(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:r},inner:{x:t.left+s.l,y:t.top+s.t,w:e-s.l-s.r,h:i-s.t-s.b,radius:{topLeft:Math.max(0,r.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,r.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,r.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,r.bottomRight-Math.max(s.b,s.r))}}}}function Ua(n,t,e,i){const s=t===null,r=e===null,a=n&&!(s&&r)&&r_(n,i);return a&&(s||De(t,a.left,a.right))&&(r||De(e,a.top,a.bottom))}function iP(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function sP(n,t){n.rect(t.x,t.y,t.w,t.h)}function za(n,t,e={}){const i=n.x!==e.x?-t:0,s=n.y!==e.y?-t:0,r=(n.x+n.w!==e.x+e.w?t:0)-i,o=(n.y+n.h!==e.y+e.h?t:0)-s;return{x:n.x+i,y:n.y+s,w:n.w+r,h:n.h+o,radius:n.radius}}class rP extends ze{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:e,options:{borderColor:i,backgroundColor:s}}=this,{inner:r,outer:o}=nP(this),a=iP(o.radius)?Fs:sP;t.save(),(o.w!==r.w||o.h!==r.h)&&(t.beginPath(),a(t,za(o,e,r)),t.clip(),a(t,za(r,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,za(r,e)),t.fillStyle=s,t.fill(),t.restore()}inRange(t,e,i){return Ua(this,t,e,i)}inXRange(t,e){return Ua(this,t,null,e)}inYRange(t,e){return Ua(this,null,t,e)}getCenterPoint(t){const{x:e,y:i,base:s,horizontal:r}=this.getProps(["x","y","base","horizontal"],t);return{x:r?(e+s)/2:e,y:r?i:(i+s)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}var oP=Object.freeze({__proto__:null,ArcElement:HS,BarElement:rP,LineElement:Go,PointElement:ZS});const xc=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],_f=xc.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function o_(n){return xc[n%xc.length]}function a_(n){return _f[n%_f.length]}function aP(n,t){return n.borderColor=o_(t),n.backgroundColor=a_(t),++t}function cP(n,t){return n.backgroundColor=n.data.map(()=>o_(t++)),t}function lP(n,t){return n.backgroundColor=n.data.map(()=>a_(t++)),t}function hP(n){let t=0;return(e,i)=>{const s=n.getDatasetMeta(i).controller;s instanceof jl?t=cP(e,t):s instanceof Gm?t=lP(e,t):s&&(t=aP(e,t))}}function yf(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function uP(n){return n&&(n.borderColor||n.backgroundColor)}function dP(){return ft.borderColor!=="rgba(0,0,0,0.1)"||ft.backgroundColor!=="rgba(0,0,0,0.1)"}var fP={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;const{data:{datasets:i},options:s}=n.config,{elements:r}=s,o=yf(i)||uP(s)||r&&yf(r)||dP();if(!e.forceOverride&&o)return;const a=hP(n);i.forEach(a)}};function gP(n,t,e,i,s){const r=s.samples||i;if(r>=e)return n.slice(t,t+e);const o=[],a=(e-2)/(r-2);let c=0;const h=t+e-1;let u=t,d,g,m,y,v;for(o[c++]=n[u],d=0;d<r-2;d++){let w=0,S=0,R;const D=Math.floor((d+1)*a)+1+t,V=Math.min(Math.floor((d+2)*a)+1,e)+t,M=V-D;for(R=D;R<V;R++)w+=n[R].x,S+=n[R].y;w/=M,S/=M;const L=Math.floor(d*a)+1+t,E=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:b,y:T}=n[u];for(m=y=-1,R=L;R<E;R++)y=.5*Math.abs((b-w)*(n[R].y-T)-(b-n[R].x)*(S-T)),y>m&&(m=y,g=n[R],v=R);o[c++]=g,u=v}return o[c++]=n[h],o}function pP(n,t,e,i){let s=0,r=0,o,a,c,h,u,d,g,m,y,v;const w=[],S=t+e-1,R=n[t].x,V=n[S].x-R;for(o=t;o<t+e;++o){a=n[o],c=(a.x-R)/V*i,h=a.y;const M=c|0;if(M===u)h<y?(y=h,d=o):h>v&&(v=h,g=o),s=(r*s+a.x)/++r;else{const L=o-1;if(!K(d)&&!K(g)){const E=Math.min(d,g),b=Math.max(d,g);E!==m&&E!==L&&w.push({...n[E],x:s}),b!==m&&b!==L&&w.push({...n[b],x:s})}o>0&&L!==m&&w.push(n[L]),w.push(a),u=M,r=0,y=v=h,d=g=m=o}}return w}function c_(n){if(n._decimated){const t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function bf(n){n.data.datasets.forEach(t=>{c_(t)})}function mP(n,t){const e=t.length;let i=0,s;const{iScale:r}=n,{min:o,max:a,minDefined:c,maxDefined:h}=r.getUserBounds();return c&&(i=Ct(Me(t,r.axis,o).lo,0,e-1)),h?s=Ct(Me(t,r.axis,a).hi+1,i,e)-i:s=e-i,{start:i,count:s}}var _P={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){bf(n);return}const i=n.width;n.data.datasets.forEach((s,r)=>{const{_data:o,indexAxis:a}=s,c=n.getDatasetMeta(r),h=o||s.data;if(gs([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;const u=n.scales[c.xAxisID];if(u.type!=="linear"&&u.type!=="time"||n.options.parsing)return;let{start:d,count:g}=mP(c,h);const m=e.threshold||4*i;if(g<=m){c_(s);return}K(o)&&(s._data=h,delete s.data,Object.defineProperty(s,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(v){this._data=v}}));let y;switch(e.algorithm){case"lttb":y=gP(h,d,g,i,e);break;case"min-max":y=pP(h,d,g,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}s._decimated=y})},destroy(n){bf(n)}};function yP(n,t,e){const i=n.segments,s=n.points,r=t.points,o=[];for(const a of i){let{start:c,end:h}=a;h=Ko(c,h,s);const u=Sc(e,s[c],s[h],a.loop);if(!t.segments){o.push({source:a,target:u,start:s[c],end:s[h]});continue}const d=jm(t,u);for(const g of d){const m=Sc(e,r[g.start],r[g.end],g.loop),y=zm(a,s,m);for(const v of y)o.push({source:v,target:g,start:{[e]:vf(u,m,"start",Math.max)},end:{[e]:vf(u,m,"end",Math.min)}})}}return o}function Sc(n,t,e,i){if(i)return;let s=t[n],r=e[n];return n==="angle"&&(s=Ut(s),r=Ut(r)),{property:n,start:s,end:r}}function bP(n,t){const{x:e=null,y:i=null}=n||{},s=t.points,r=[];return t.segments.forEach(({start:o,end:a})=>{a=Ko(o,a,s);const c=s[o],h=s[a];i!==null?(r.push({x:c.x,y:i}),r.push({x:h.x,y:i})):e!==null&&(r.push({x:e,y:c.y}),r.push({x:e,y:h.y}))}),r}function Ko(n,t,e){for(;t>n;t--){const i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function vf(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function l_(n,t){let e=[],i=!1;return dt(n)?(i=!0,e=n):e=bP(n,t),e.length?new Go({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function wf(n){return n&&n.fill!==!1}function vP(n,t,e){let s=n[t].fill;const r=[t];let o;if(!e)return s;for(;s!==!1&&r.indexOf(s)===-1;){if(!_t(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;r.push(s),s=o.fill}return!1}function wP(n,t,e){const i=AP(n);if(Z(i))return isNaN(i.value)?!1:i;let s=parseFloat(i);return _t(s)&&Math.floor(s)===s?TP(i[0],t,s,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function TP(n,t,e,i){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=i?!1:e}function EP(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:Z(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function IP(n,t,e){let i;return n==="start"?i=e:n==="end"?i=t.options.reverse?t.min:t.max:Z(n)?i=n.value:i=t.getBaseValue(),i}function AP(n){const t=n.options,e=t.fill;let i=$(e&&e.target,e);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function xP(n){const{scale:t,index:e,line:i}=n,s=[],r=i.segments,o=i.points,a=SP(t,e);a.push(l_({x:null,y:t.bottom},i));for(let c=0;c<r.length;c++){const h=r[c];for(let u=h.start;u<=h.end;u++)PP(s,o[u],a)}return new Go({points:s,options:{}})}function SP(n,t){const e=[],i=n.getMatchingVisibleMetas("line");for(let s=0;s<i.length;s++){const r=i[s];if(r.index===t)break;r.hidden||e.unshift(r.dataset)}return e}function PP(n,t,e){const i=[];for(let s=0;s<e.length;s++){const r=e[s],{first:o,last:a,point:c}=RP(r,t,"x");if(!(!c||o&&a)){if(o)i.unshift(c);else if(n.push(c),!a)break}}n.push(...i)}function RP(n,t,e){const i=n.interpolate(t,e);if(!i)return{};const s=i[e],r=n.segments,o=n.points;let a=!1,c=!1;for(let h=0;h<r.length;h++){const u=r[h],d=o[u.start][e],g=o[u.end][e];if(De(s,d,g)){a=s===d,c=s===g;break}}return{first:a,last:c,point:i}}class h_{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){const{x:s,y:r,radius:o}=this;return e=e||{start:0,end:ut},t.arc(s,r,o,e.end,e.start,!0),!i.bounds}interpolate(t){const{x:e,y:i,radius:s}=this,r=t.angle;return{x:e+Math.cos(r)*s,y:i+Math.sin(r)*s,angle:r}}}function CP(n){const{chart:t,fill:e,line:i}=n;if(_t(e))return kP(t,e);if(e==="stack")return xP(n);if(e==="shape")return!0;const s=DP(n);return s instanceof h_?s:l_(s,i)}function kP(n,t){const e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function DP(n){return(n.scale||{}).getPointPositionForValue?OP(n):MP(n)}function MP(n){const{scale:t={},fill:e}=n,i=EP(e,t);if(_t(i)){const s=t.isHorizontal();return{x:s?i:null,y:s?null:i}}return null}function OP(n){const{scale:t,fill:e}=n,i=t.options,s=t.getLabels().length,r=i.reverse?t.max:t.min,o=IP(e,t,r),a=[];if(i.grid.circular){const c=t.getPointPositionForValue(0,r);return new h_({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)a.push(t.getPointPositionForValue(c,o));return a}function ja(n,t,e){const i=CP(t),{chart:s,index:r,line:o,scale:a,axis:c}=t,h=o.options,u=h.fill,d=h.backgroundColor,{above:g=d,below:m=d}=u||{},y=s.getDatasetMeta(r),v=Hm(s,y);i&&o.points.length&&(Ho(n,e),VP(n,{line:o,target:i,above:g,below:m,area:e,scale:a,axis:c,clip:v}),Wo(n))}function VP(n,t){const{line:e,target:i,above:s,below:r,area:o,scale:a,clip:c}=t,h=e._loop?"angle":t.axis;n.save();let u=r;r!==s&&(h==="x"?(Tf(n,i,o.top),Ha(n,{line:e,target:i,color:s,scale:a,property:h,clip:c}),n.restore(),n.save(),Tf(n,i,o.bottom)):h==="y"&&(Ef(n,i,o.left),Ha(n,{line:e,target:i,color:r,scale:a,property:h,clip:c}),n.restore(),n.save(),Ef(n,i,o.right),u=s)),Ha(n,{line:e,target:i,color:u,scale:a,property:h,clip:c}),n.restore()}function Tf(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:h}=a,u=s[c],d=s[Ko(c,h,s)];r?(n.moveTo(u.x,u.y),r=!1):(n.lineTo(u.x,e),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function Ef(n,t,e){const{segments:i,points:s}=t;let r=!0,o=!1;n.beginPath();for(const a of i){const{start:c,end:h}=a,u=s[c],d=s[Ko(c,h,s)];r?(n.moveTo(u.x,u.y),r=!1):(n.lineTo(e,u.y),n.lineTo(u.x,u.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(e,d.y)}n.lineTo(e,t.first().y),n.closePath(),n.clip()}function Ha(n,t){const{line:e,target:i,property:s,color:r,scale:o,clip:a}=t,c=yP(e,i,s);for(const{source:h,target:u,start:d,end:g}of c){const{style:{backgroundColor:m=r}={}}=h,y=i!==!0;n.save(),n.fillStyle=m,NP(n,o,a,y&&Sc(s,d,g)),n.beginPath();const v=!!e.pathSegment(n,h);let w;if(y){v?n.closePath():If(n,i,g,s);const S=!!i.pathSegment(n,u,{move:v,reverse:!0});w=v&&S,w||If(n,i,d,s)}n.closePath(),n.fill(w?"evenodd":"nonzero"),n.restore()}}function NP(n,t,e,i){const s=t.chart.chartArea,{property:r,start:o,end:a}=i||{};if(r==="x"||r==="y"){let c,h,u,d;r==="x"?(c=o,h=s.top,u=a,d=s.bottom):(c=s.left,h=o,u=s.right,d=a),n.beginPath(),e&&(c=Math.max(c,e.left),u=Math.min(u,e.right),h=Math.max(h,e.top),d=Math.min(d,e.bottom)),n.rect(c,h,u-c,d-h),n.clip()}}function If(n,t,e,i){const s=t.interpolate(e,i);s&&n.lineTo(s.x,s.y)}var LP={id:"filler",afterDatasetsUpdate(n,t,e){const i=(n.data.datasets||[]).length,s=[];let r,o,a,c;for(o=0;o<i;++o)r=n.getDatasetMeta(o),a=r.dataset,c=null,a&&a.options&&a instanceof Go&&(c={visible:n.isDatasetVisible(o),index:o,fill:wP(a,o,i),chart:n,axis:r.controller.options.indexAxis,scale:r.vScale,line:a}),r.$filler=c,s.push(c);for(o=0;o<i;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=vP(s,o,e.propagate))},beforeDraw(n,t,e){const i=e.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),r=n.chartArea;for(let o=s.length-1;o>=0;--o){const a=s[o].$filler;a&&(a.line.updateControlPoints(r,a.axis),i&&a.fill&&ja(n.ctx,a,r))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;const i=n.getSortedVisibleDatasetMetas();for(let s=i.length-1;s>=0;--s){const r=i[s].$filler;wf(r)&&ja(n.ctx,r,n.chartArea)}},beforeDatasetDraw(n,t,e){const i=t.meta.$filler;!wf(i)||e.drawTime!=="beforeDatasetDraw"||ja(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const Af=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},FP=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index;class xf extends ze{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let e=at(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,s)=>t.sort(i,s,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){const{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,s=xt(i.font),r=s.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=Af(i,r);let h,u;e.font=s.string,this.isHorizontal()?(h=this.maxWidth,u=this._fitRows(o,r,a,c)+10):(u=this.maxHeight,h=this._fitCols(o,s,a,c)+10),this.width=Math.min(h,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,s){const{ctx:r,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],h=this.lineWidths=[0],u=s+a;let d=t;r.textAlign="left",r.textBaseline="middle";let g=-1,m=-u;return this.legendItems.forEach((y,v)=>{const w=i+e/2+r.measureText(y.text).width;(v===0||h[h.length-1]+w+2*a>o)&&(d+=u,h[h.length-(v>0?0:1)]=0,m+=u,g++),c[v]={left:0,top:m,row:g,width:w,height:s},h[h.length-1]+=w+a}),d}_fitCols(t,e,i,s){const{ctx:r,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],h=this.columnSizes=[],u=o-t;let d=a,g=0,m=0,y=0,v=0;return this.legendItems.forEach((w,S)=>{const{itemWidth:R,itemHeight:D}=BP(i,e,r,w,s);S>0&&m+D+2*a>u&&(d+=g+a,h.push({width:g,height:m}),y+=g+a,v++,g=m=0),c[S]={left:y,top:m,col:v,width:R,height:D},g=Math.max(g,R),m+=D+a}),d+=g,h.push({width:g,height:m}),d}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:s},rtl:r}}=this,o=yi(r,this.left,this.width);if(this.isHorizontal()){let a=0,c=Ft(i,this.left+s,this.right-this.lineWidths[a]);for(const h of e)a!==h.row&&(a=h.row,c=Ft(i,this.left+s,this.right-this.lineWidths[a])),h.top+=this.top+t+s,h.left=o.leftForLtr(o.x(c),h.width),c+=h.width+s}else{let a=0,c=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height);for(const h of e)h.col!==a&&(a=h.col,c=Ft(i,this.top+t+s,this.bottom-this.columnSizes[a].height)),h.top=c,h.left+=this.left+s,h.left=o.leftForLtr(o.x(h.left),h.width),c+=h.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Ho(t,this),this._draw(),Wo(t)}}_draw(){const{options:t,columnSizes:e,lineWidths:i,ctx:s}=this,{align:r,labels:o}=t,a=ft.color,c=yi(t.rtl,this.left,this.width),h=xt(o.font),{padding:u}=o,d=h.size,g=d/2;let m;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=h.string;const{boxWidth:y,boxHeight:v,itemHeight:w}=Af(o,d),S=function(L,E,b){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;s.save();const T=$(b.lineWidth,1);if(s.fillStyle=$(b.fillStyle,a),s.lineCap=$(b.lineCap,"butt"),s.lineDashOffset=$(b.lineDashOffset,0),s.lineJoin=$(b.lineJoin,"miter"),s.lineWidth=T,s.strokeStyle=$(b.strokeStyle,a),s.setLineDash($(b.lineDash,[])),o.usePointStyle){const x={radius:v*Math.SQRT2/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:T},A=c.xPlus(L,y/2),P=E+g;Cm(s,x,A,P,o.pointStyleWidth&&y)}else{const x=E+Math.max((d-v)/2,0),A=c.leftForLtr(L,y),P=jn(b.borderRadius);s.beginPath(),Object.values(P).some(I=>I!==0)?Fs(s,{x:A,y:x,w:y,h:v,radius:P}):s.rect(A,x,y,v),s.fill(),T!==0&&s.stroke()}s.restore()},R=function(L,E,b){Xn(s,b.text,L,E+w/2,h,{strikethrough:b.hidden,textAlign:c.textAlign(b.textAlign)})},D=this.isHorizontal(),V=this._computeTitleHeight();D?m={x:Ft(r,this.left+u,this.right-i[0]),y:this.top+u+V,line:0}:m={x:this.left+u,y:Ft(r,this.top+V+u,this.bottom-e[0].height),line:0},Fm(this.ctx,t.textDirection);const M=w+u;this.legendItems.forEach((L,E)=>{s.strokeStyle=L.fontColor,s.fillStyle=L.fontColor;const b=s.measureText(L.text).width,T=c.textAlign(L.textAlign||(L.textAlign=o.textAlign)),x=y+g+b;let A=m.x,P=m.y;c.setWidth(this.width),D?E>0&&A+x+u>this.right&&(P=m.y+=M,m.line++,A=m.x=Ft(r,this.left+u,this.right-i[m.line])):E>0&&P+M>this.bottom&&(A=m.x=A+e[m.line].width+u,m.line++,P=m.y=Ft(r,this.top+V+u,this.bottom-e[m.line].height));const I=c.x(A);if(S(I,P,L),A=YI(T,A+y+g,D?A+x:this.right,t.rtl),R(c.x(A),P,L),D)m.x+=x+u;else if(typeof L.text!="string"){const st=h.lineHeight;m.y+=u_(L,st)+u}else m.y+=M}),Bm(this.ctx,t.textDirection)}drawTitle(){const t=this.options,e=t.title,i=xt(e.font),s=Wt(e.padding);if(!e.display)return;const r=yi(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=i.size/2,h=s.top+c;let u,d=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),u=this.top+h,d=Ft(t.align,d,this.right-g);else{const y=this.columnSizes.reduce((v,w)=>Math.max(v,w.height),0);u=h+Ft(t.align,this.top,this.bottom-y-t.labels.padding-this._computeTitleHeight())}const m=Ft(a,d,d+g);o.textAlign=r.textAlign(Ol(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,Xn(o,e.text,m,u,i)}_computeTitleHeight(){const t=this.options.title,e=xt(t.font),i=Wt(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,s,r;if(De(t,this.left,this.right)&&De(e,this.top,this.bottom)){for(r=this.legendHitBoxes,i=0;i<r.length;++i)if(s=r[i],De(t,s.left,s.left+s.width)&&De(e,s.top,s.top+s.height))return this.legendItems[i]}return null}handleEvent(t){const e=this.options;if(!jP(t.type,e))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const s=this._hoveredItem,r=FP(s,i);s&&!r&&at(e.onLeave,[t,s,this],this),this._hoveredItem=i,i&&!r&&at(e.onHover,[t,i,this],this)}else i&&at(e.onClick,[t,i,this],this)}}function BP(n,t,e,i,s){const r=UP(i,n,t,e),o=zP(s,i,t.lineHeight);return{itemWidth:r,itemHeight:o}}function UP(n,t,e,i){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((r,o)=>r.length>o.length?r:o)),t+e.size/2+i.measureText(s).width}function zP(n,t,e){let i=n;return typeof t.text!="string"&&(i=u_(t,e)),i}function u_(n,t){const e=n.text?n.text.length:0;return t*e}function jP(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var HP={id:"legend",_element:xf,start(n,t,e){const i=n.legend=new xf({ctx:n.ctx,options:e,chart:n});jt.configure(n,i,e),jt.addBox(n,i)},stop(n){jt.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){const i=n.legend;jt.configure(n,i,e),i.options=e},afterUpdate(n){const t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){const i=t.datasetIndex,s=e.chart;s.isDatasetVisible(i)?(s.hide(i),t.hidden=!0):(s.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:s,color:r,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const h=c.controller.getStyle(e?0:void 0),u=Wt(h.borderWidth);return{text:t[c.index].label,fillStyle:h.backgroundColor,fontColor:r,hidden:!c.visible,lineCap:h.borderCapStyle,lineDash:h.borderDash,lineDashOffset:h.borderDashOffset,lineJoin:h.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:h.borderColor,pointStyle:i||h.pointStyle,rotation:h.rotation,textAlign:s||h.textAlign,borderRadius:o&&(a||h.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class $l extends ze{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;const s=dt(i.text)?i.text.length:1;this._padding=Wt(i.padding);const r=s*xt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=r:this.width=r}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:e,left:i,bottom:s,right:r,options:o}=this,a=o.align;let c=0,h,u,d;return this.isHorizontal()?(u=Ft(a,i,r),d=e+t,h=r-i):(o.position==="left"?(u=i+t,d=Ft(a,s,e),c=et*-.5):(u=r-t,d=Ft(a,e,s),c=et*.5),h=s-e),{titleX:u,titleY:d,maxWidth:h,rotation:c}}draw(){const t=this.ctx,e=this.options;if(!e.display)return;const i=xt(e.font),r=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:h}=this._drawArgs(r);Xn(t,e.text,0,0,i,{color:e.color,maxWidth:c,rotation:h,textAlign:Ol(e.align),textBaseline:"middle",translation:[o,a]})}}function WP(n,t){const e=new $l({ctx:n.ctx,options:t,chart:n});jt.configure(n,e,t),jt.addBox(n,e),n.titleBlock=e}var $P={id:"title",_element:$l,start(n,t,e){WP(n,e)},stop(n){const t=n.titleBlock;jt.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){const i=n.titleBlock;jt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Cr=new WeakMap;var qP={id:"subtitle",start(n,t,e){const i=new $l({ctx:n.ctx,options:e,chart:n});jt.configure(n,i,e),jt.addBox(n,i),Cr.set(n,i)},stop(n){jt.removeBox(n,Cr.get(n)),Cr.delete(n)},beforeUpdate(n,t,e){const i=Cr.get(n);jt.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const ms={average(n){if(!n.length)return!1;let t,e,i=new Set,s=0,r=0;for(t=0,e=n.length;t<e;++t){const a=n[t].element;if(a&&a.hasValue()){const c=a.tooltipPosition();i.add(c.x),s+=c.y,++r}}return r===0||i.size===0?!1:{x:[...i].reduce((a,c)=>a+c)/i.size,y:s/r}},nearest(n,t){if(!n.length)return!1;let e=t.x,i=t.y,s=Number.POSITIVE_INFINITY,r,o,a;for(r=0,o=n.length;r<o;++r){const c=n[r].element;if(c&&c.hasValue()){const h=c.getCenterPoint(),u=vc(t,h);u<s&&(s=u,a=c)}}if(a){const c=a.tooltipPosition();e=c.x,i=c.y}return{x:e,y:i}}};function ue(n,t){return t&&(dt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Se(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function GP(n,t){const{element:e,datasetIndex:i,index:s}=t,r=n.getDatasetMeta(i).controller,{label:o,value:a}=r.getLabelAndValue(s);return{chart:n,label:o,parsed:r.getParsed(s),raw:n.data.datasets[i].data[s],formattedValue:a,dataset:r.getDataset(),dataIndex:s,datasetIndex:i,element:e}}function Sf(n,t){const e=n.chart.ctx,{body:i,footer:s,title:r}=n,{boxWidth:o,boxHeight:a}=t,c=xt(t.bodyFont),h=xt(t.titleFont),u=xt(t.footerFont),d=r.length,g=s.length,m=i.length,y=Wt(t.padding);let v=y.height,w=0,S=i.reduce((V,M)=>V+M.before.length+M.lines.length+M.after.length,0);if(S+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*h.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),S){const V=t.displayColors?Math.max(a,c.lineHeight):c.lineHeight;v+=m*V+(S-m)*c.lineHeight+(S-1)*t.bodySpacing}g&&(v+=t.footerMarginTop+g*u.lineHeight+(g-1)*t.footerSpacing);let R=0;const D=function(V){w=Math.max(w,e.measureText(V).width+R)};return e.save(),e.font=h.string,it(n.title,D),e.font=c.string,it(n.beforeBody.concat(n.afterBody),D),R=t.displayColors?o+2+t.boxPadding:0,it(i,V=>{it(V.before,D),it(V.lines,D),it(V.after,D)}),R=0,e.font=u.string,it(n.footer,D),e.restore(),w+=y.width,{width:w,height:v}}function KP(n,t){const{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}function YP(n,t,e,i){const{x:s,width:r}=i,o=e.caretSize+e.caretPadding;if(n==="left"&&s+r+o>t.width||n==="right"&&s-r-o<0)return!0}function XP(n,t,e,i){const{x:s,width:r}=e,{width:o,chartArea:{left:a,right:c}}=n;let h="center";return i==="center"?h=s<=(a+c)/2?"left":"right":s<=r/2?h="left":s>=o-r/2&&(h="right"),YP(h,n,t,e)&&(h="center"),h}function Pf(n,t,e){const i=e.yAlign||t.yAlign||KP(n,e);return{xAlign:e.xAlign||t.xAlign||XP(n,t,e,i),yAlign:i}}function QP(n,t){let{x:e,width:i}=n;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function JP(n,t,e){let{y:i,height:s}=n;return t==="top"?i+=e:t==="bottom"?i-=s+e:i-=s/2,i}function Rf(n,t,e,i){const{caretSize:s,caretPadding:r,cornerRadius:o}=n,{xAlign:a,yAlign:c}=e,h=s+r,{topLeft:u,topRight:d,bottomLeft:g,bottomRight:m}=jn(o);let y=QP(t,a);const v=JP(t,c,h);return c==="center"?a==="left"?y+=h:a==="right"&&(y-=h):a==="left"?y-=Math.max(u,g)+s:a==="right"&&(y+=Math.max(d,m)+s),{x:Ct(y,0,i.width-t.width),y:Ct(v,0,i.height-t.height)}}function kr(n,t,e){const i=Wt(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-i.right:n.x+i.left}function Cf(n){return ue([],Se(n))}function ZP(n,t,e){return In(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function kf(n,t){const e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}const d_={beforeTitle:Ae,title(n){if(n.length>0){const t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:Ae,beforeBody:Ae,beforeLabel:Ae,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");const e=n.formattedValue;return K(e)||(t+=e),t},labelColor(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:Ae,afterBody:Ae,beforeFooter:Ae,footer:Ae,afterFooter:Ae};function Gt(n,t,e,i){const s=n[t].call(e,i);return typeof s>"u"?d_[t].call(e,i):s}class Df extends ze{static positioners=ms;constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const e=this.chart,i=this.options.setContext(this.getContext()),s=i.enabled&&e.options.animation&&i.animations,r=new Wm(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(r)),r}getContext(){return this.$context||(this.$context=ZP(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,e){const{callbacks:i}=e,s=Gt(i,"beforeTitle",this,t),r=Gt(i,"title",this,t),o=Gt(i,"afterTitle",this,t);let a=[];return a=ue(a,Se(s)),a=ue(a,Se(r)),a=ue(a,Se(o)),a}getBeforeBody(t,e){return Cf(Gt(e.callbacks,"beforeBody",this,t))}getBody(t,e){const{callbacks:i}=e,s=[];return it(t,r=>{const o={before:[],lines:[],after:[]},a=kf(i,r);ue(o.before,Se(Gt(a,"beforeLabel",this,r))),ue(o.lines,Gt(a,"label",this,r)),ue(o.after,Se(Gt(a,"afterLabel",this,r))),s.push(o)}),s}getAfterBody(t,e){return Cf(Gt(e.callbacks,"afterBody",this,t))}getFooter(t,e){const{callbacks:i}=e,s=Gt(i,"beforeFooter",this,t),r=Gt(i,"footer",this,t),o=Gt(i,"afterFooter",this,t);let a=[];return a=ue(a,Se(s)),a=ue(a,Se(r)),a=ue(a,Se(o)),a}_createItems(t){const e=this._active,i=this.chart.data,s=[],r=[],o=[];let a=[],c,h;for(c=0,h=e.length;c<h;++c)a.push(GP(this.chart,e[c]));return t.filter&&(a=a.filter((u,d,g)=>t.filter(u,d,g,i))),t.itemSort&&(a=a.sort((u,d)=>t.itemSort(u,d,i))),it(a,u=>{const d=kf(t.callbacks,u);s.push(Gt(d,"labelColor",this,u)),r.push(Gt(d,"labelPointStyle",this,u)),o.push(Gt(d,"labelTextColor",this,u))}),this.labelColors=s,this.labelPointStyles=r,this.labelTextColors=o,this.dataPoints=a,a}update(t,e){const i=this.options.setContext(this.getContext()),s=this._active;let r,o=[];if(!s.length)this.opacity!==0&&(r={opacity:0});else{const a=ms[i.position].call(this,s,this._eventPosition);o=this._createItems(i),this.title=this.getTitle(o,i),this.beforeBody=this.getBeforeBody(o,i),this.body=this.getBody(o,i),this.afterBody=this.getAfterBody(o,i),this.footer=this.getFooter(o,i);const c=this._size=Sf(this,i),h=Object.assign({},a,c),u=Pf(this.chart,i,h),d=Rf(i,h,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,r={opacity:1,x:d.x,y:d.y,width:c.width,height:c.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,r&&this._resolveAnimations().update(this,r),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:e})}drawCaret(t,e,i,s){const r=this.getCaretPosition(t,i,s);e.lineTo(r.x1,r.y1),e.lineTo(r.x2,r.y2),e.lineTo(r.x3,r.y3)}getCaretPosition(t,e,i){const{xAlign:s,yAlign:r}=this,{caretSize:o,cornerRadius:a}=i,{topLeft:c,topRight:h,bottomLeft:u,bottomRight:d}=jn(a),{x:g,y:m}=t,{width:y,height:v}=e;let w,S,R,D,V,M;return r==="center"?(V=m+v/2,s==="left"?(w=g,S=w-o,D=V+o,M=V-o):(w=g+y,S=w+o,D=V-o,M=V+o),R=w):(s==="left"?S=g+Math.max(c,u)+o:s==="right"?S=g+y-Math.max(h,d)-o:S=this.caretX,r==="top"?(D=m,V=D-o,w=S-o,R=S+o):(D=m+v,V=D+o,w=S+o,R=S-o),M=D),{x1:w,x2:S,x3:R,y1:D,y2:V,y3:M}}drawTitle(t,e,i){const s=this.title,r=s.length;let o,a,c;if(r){const h=yi(i.rtl,this.x,this.width);for(t.x=kr(this,i.titleAlign,i),e.textAlign=h.textAlign(i.titleAlign),e.textBaseline="middle",o=xt(i.titleFont),a=i.titleSpacing,e.fillStyle=i.titleColor,e.font=o.string,c=0;c<r;++c)e.fillText(s[c],h.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+a,c+1===r&&(t.y+=i.titleMarginBottom-a)}}_drawColorBox(t,e,i,s,r){const o=this.labelColors[i],a=this.labelPointStyles[i],{boxHeight:c,boxWidth:h}=r,u=xt(r.bodyFont),d=kr(this,"left",r),g=s.x(d),m=c<u.lineHeight?(u.lineHeight-c)/2:0,y=e.y+m;if(r.usePointStyle){const v={radius:Math.min(h,c)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},w=s.leftForLtr(g,h)+h/2,S=y+c/2;t.strokeStyle=r.multiKeyBackground,t.fillStyle=r.multiKeyBackground,Tc(t,v,w,S),t.strokeStyle=o.borderColor,t.fillStyle=o.backgroundColor,Tc(t,v,w,S)}else{t.lineWidth=Z(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,t.strokeStyle=o.borderColor,t.setLineDash(o.borderDash||[]),t.lineDashOffset=o.borderDashOffset||0;const v=s.leftForLtr(g,h),w=s.leftForLtr(s.xPlus(g,1),h-2),S=jn(o.borderRadius);Object.values(S).some(R=>R!==0)?(t.beginPath(),t.fillStyle=r.multiKeyBackground,Fs(t,{x:v,y,w:h,h:c,radius:S}),t.fill(),t.stroke(),t.fillStyle=o.backgroundColor,t.beginPath(),Fs(t,{x:w,y:y+1,w:h-2,h:c-2,radius:S}),t.fill()):(t.fillStyle=r.multiKeyBackground,t.fillRect(v,y,h,c),t.strokeRect(v,y,h,c),t.fillStyle=o.backgroundColor,t.fillRect(w,y+1,h-2,c-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,e,i){const{body:s}=this,{bodySpacing:r,bodyAlign:o,displayColors:a,boxHeight:c,boxWidth:h,boxPadding:u}=i,d=xt(i.bodyFont);let g=d.lineHeight,m=0;const y=yi(i.rtl,this.x,this.width),v=function(b){e.fillText(b,y.x(t.x+m),t.y+g/2),t.y+=g+r},w=y.textAlign(o);let S,R,D,V,M,L,E;for(e.textAlign=o,e.textBaseline="middle",e.font=d.string,t.x=kr(this,w,i),e.fillStyle=i.bodyColor,it(this.beforeBody,v),m=a&&w!=="right"?o==="center"?h/2+u:h+2+u:0,V=0,L=s.length;V<L;++V){for(S=s[V],R=this.labelTextColors[V],e.fillStyle=R,it(S.before,v),D=S.lines,a&&D.length&&(this._drawColorBox(e,t,V,y,i),g=Math.max(d.lineHeight,c)),M=0,E=D.length;M<E;++M)v(D[M]),g=d.lineHeight;it(S.after,v)}m=0,g=d.lineHeight,it(this.afterBody,v),t.y-=r}drawFooter(t,e,i){const s=this.footer,r=s.length;let o,a;if(r){const c=yi(i.rtl,this.x,this.width);for(t.x=kr(this,i.footerAlign,i),t.y+=i.footerMarginTop,e.textAlign=c.textAlign(i.footerAlign),e.textBaseline="middle",o=xt(i.footerFont),e.fillStyle=i.footerColor,e.font=o.string,a=0;a<r;++a)e.fillText(s[a],c.x(t.x),t.y+o.lineHeight/2),t.y+=o.lineHeight+i.footerSpacing}}drawBackground(t,e,i,s){const{xAlign:r,yAlign:o}=this,{x:a,y:c}=t,{width:h,height:u}=i,{topLeft:d,topRight:g,bottomLeft:m,bottomRight:y}=jn(s.cornerRadius);e.fillStyle=s.backgroundColor,e.strokeStyle=s.borderColor,e.lineWidth=s.borderWidth,e.beginPath(),e.moveTo(a+d,c),o==="top"&&this.drawCaret(t,e,i,s),e.lineTo(a+h-g,c),e.quadraticCurveTo(a+h,c,a+h,c+g),o==="center"&&r==="right"&&this.drawCaret(t,e,i,s),e.lineTo(a+h,c+u-y),e.quadraticCurveTo(a+h,c+u,a+h-y,c+u),o==="bottom"&&this.drawCaret(t,e,i,s),e.lineTo(a+m,c+u),e.quadraticCurveTo(a,c+u,a,c+u-m),o==="center"&&r==="left"&&this.drawCaret(t,e,i,s),e.lineTo(a,c+d),e.quadraticCurveTo(a,c,a+d,c),e.closePath(),e.fill(),s.borderWidth>0&&e.stroke()}_updateAnimationTarget(t){const e=this.chart,i=this.$animations,s=i&&i.x,r=i&&i.y;if(s||r){const o=ms[t.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=Sf(this,t),c=Object.assign({},o,this._size),h=Pf(e,t,c),u=Rf(t,c,h,e);(s._to!==u.x||r._to!==u.y)&&(this.xAlign=h.xAlign,this.yAlign=h.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const e=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(e);const s={width:this.width,height:this.height},r={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const o=Wt(e.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;e.enabled&&a&&(t.save(),t.globalAlpha=i,this.drawBackground(r,t,s,e),Fm(t,e.textDirection),r.y+=o.top,this.drawTitle(r,t,e),this.drawBody(r,t,e),this.drawFooter(r,t,e),Bm(t,e.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,e){const i=this._active,s=t.map(({datasetIndex:a,index:c})=>{const h=this.chart.getDatasetMeta(a);if(!h)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:h.data[c],index:c}}),r=!uo(i,s),o=this._positionChanged(s,e);(r||o)&&(this._active=s,this._eventPosition=e,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,e,i=!0){if(e&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,r=this._active||[],o=this._getActiveElements(t,r,e,i),a=this._positionChanged(o,t),c=e||!uo(o,r)||a;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,e))),c}_getActiveElements(t,e,i,s){const r=this.options;if(t.type==="mouseout")return[];if(!s)return e.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(t,r.mode,r,i);return r.reverse&&o.reverse(),o}_positionChanged(t,e){const{caretX:i,caretY:s,options:r}=this,o=ms[r.position].call(this,t,e);return o!==!1&&(i!==o.x||s!==o.y)}}var tR={id:"tooltip",_element:Df,positioners:ms,afterInit(n,t,e){e&&(n.tooltip=new Df({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){const t=n.tooltip;if(t&&t._willRender()){const e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",{...e,cancelable:!0})===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){const e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:d_},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},eR=Object.freeze({__proto__:null,Colors:fP,Decimation:_P,Filler:LP,Legend:HP,SubTitle:qP,Title:$P,Tooltip:tR});const nR=(n,t,e,i)=>(typeof t=="string"?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function iR(n,t,e,i){const s=n.indexOf(t);if(s===-1)return nR(n,t,e,i);const r=n.lastIndexOf(t);return s!==r?e:s}const sR=(n,t)=>n===null?null:Ct(Math.round(n),0,t);function Mf(n){const t=this.getLabels();return n>=0&&n<t.length?t[n]:n}class rR extends ei{static id="category";static defaults={ticks:{callback:Mf}};constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const e=this._addedLabels;if(e.length){const i=this.getLabels();for(const{index:s,label:r}of e)i[s]===r&&i.splice(s,1);this._addedLabels=[]}super.init(t)}parse(t,e){if(K(t))return null;const i=this.getLabels();return e=isFinite(e)&&i[e]===t?e:iR(i,t,$(e,t),this._addedLabels),sR(e,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let{min:i,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),e||(s=this.getLabels().length-1)),this.min=i,this.max=s}buildTicks(){const t=this.min,e=this.max,i=this.options.offset,s=[];let r=this.getLabels();r=t===0&&e===r.length-1?r:r.slice(t,e+1),this._valueRange=Math.max(r.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let o=t;o<=e;o++)s.push({value:o});return s}getLabelForValue(t){return Mf.call(this,t)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}function oR(n,t){const e=[],{bounds:s,step:r,min:o,max:a,precision:c,count:h,maxTicks:u,maxDigits:d,includeBounds:g}=n,m=r||1,y=u-1,{min:v,max:w}=t,S=!K(o),R=!K(a),D=!K(h),V=(w-v)/(d+1);let M=xd((w-v)/y/m)*m,L,E,b,T;if(M<1e-14&&!S&&!R)return[{value:v},{value:w}];T=Math.ceil(w/M)-Math.floor(v/M),T>y&&(M=xd(T*M/y/m)*m),K(c)||(L=Math.pow(10,c),M=Math.ceil(M*L)/L),s==="ticks"?(E=Math.floor(v/M)*M,b=Math.ceil(w/M)*M):(E=v,b=w),S&&R&&r&&jI((a-o)/r,M/1e3)?(T=Math.round(Math.min((a-o)/M,u)),M=(a-o)/T,E=o,b=a):D?(E=S?o:E,b=R?a:b,T=h-1,M=(b-E)/T):(T=(b-E)/M,Is(T,Math.round(T),M/1e3)?T=Math.round(T):T=Math.ceil(T));const x=Math.max(Sd(M),Sd(E));L=Math.pow(10,K(c)?x:c),E=Math.round(E*L)/L,b=Math.round(b*L)/L;let A=0;for(S&&(g&&E!==o?(e.push({value:o}),E<o&&A++,Is(Math.round((E+A*M)*L)/L,o,Of(o,V,n))&&A++):E<o&&A++);A<T;++A){const P=Math.round((E+A*M)*L)/L;if(R&&P>a)break;e.push({value:P})}return R&&g&&b!==a?e.length&&Is(e[e.length-1].value,a,Of(a,V,n))?e[e.length-1].value=a:e.push({value:a}):(!R||b===a)&&e.push({value:b}),e}function Of(n,t,{horizontal:e,minRotation:i}){const s=oe(i),r=(e?Math.sin(s):Math.cos(s))||.001,o=.75*t*(""+n).length;return Math.min(t/r,o)}class bo extends ei{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return K(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds();let{min:s,max:r}=this;const o=c=>s=e?s:c,a=c=>r=i?r:c;if(t){const c=ve(s),h=ve(r);c<0&&h<0?a(0):c>0&&h>0&&o(0)}if(s===r){let c=r===0?1:Math.abs(r*.05);a(r+c),t||o(s-c)}this.min=s,this.max=r}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:e,stepSize:i}=t,s;return i?(s=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),e=e||11),e&&(s=Math.min(e,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,e=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const s={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},r=this._range||this,o=oR(s,r);return t.bounds==="ticks"&&wm(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const t=this.ticks;let e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const s=(i-e)/Math.max(t.length-1,1)/2;e-=s,i+=s}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Zs(t,this.chart.options.locale,this.options.ticks.format)}}class aR extends bo{static id="linear";static defaults={ticks:{callback:jo.formatters.numeric}};determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=_t(t)?t:0,this.max=_t(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),e=t?this.width:this.height,i=oe(this.options.ticks.minRotation),s=(t?Math.sin(i):Math.cos(i))||.001,r=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,r.lineHeight/s))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}const Us=n=>Math.floor(sn(n)),Vn=(n,t)=>Math.pow(10,Us(n)+t);function Vf(n){return n/Math.pow(10,Us(n))===1}function Nf(n,t,e){const i=Math.pow(10,e),s=Math.floor(n/i);return Math.ceil(t/i)-s}function cR(n,t){const e=t-n;let i=Us(e);for(;Nf(n,t,i)>10;)i++;for(;Nf(n,t,i)<10;)i--;return Math.min(i,Us(n))}function lR(n,{min:t,max:e}){t=Jt(n.min,t);const i=[],s=Us(t);let r=cR(t,e),o=r<0?Math.pow(10,Math.abs(r)):1;const a=Math.pow(10,r),c=s>r?Math.pow(10,s):0,h=Math.round((t-c)*o)/o,u=Math.floor((t-c)/a/10)*a*10;let d=Math.floor((h-u)/Math.pow(10,r)),g=Jt(n.min,Math.round((c+u+d*Math.pow(10,r))*o)/o);for(;g<e;)i.push({value:g,major:Vf(g),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(r++,d=2,o=r>=0?1:o),g=Math.round((c+u+d*Math.pow(10,r))*o)/o;const m=Jt(n.max,g);return i.push({value:m,major:Vf(m),significand:d}),i}class hR extends ei{static id="logarithmic";static defaults={ticks:{callback:jo.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){const i=bo.prototype.parse.apply(this,[t,e]);if(i===0){this._zero=!0;return}return _t(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!0);this.min=_t(t)?Math.max(0,t):null,this.max=_t(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!_t(this._userMin)&&(this.min=t===Vn(this.min,0)?Vn(this.min,-1):Vn(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:e}=this.getUserBounds();let i=this.min,s=this.max;const r=a=>i=t?i:a,o=a=>s=e?s:a;i===s&&(i<=0?(r(1),o(10)):(r(Vn(i,-1)),o(Vn(s,1)))),i<=0&&r(Vn(s,-1)),s<=0&&o(Vn(i,1)),this.min=i,this.max=s}buildTicks(){const t=this.options,e={min:this._userMin,max:this._userMax},i=lR(e,this);return t.bounds==="ticks"&&wm(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Zs(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=sn(t),this._valueRange=sn(this.max)-sn(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(sn(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}}function Pc(n){const t=n.ticks;if(t.display&&n.display){const e=Wt(t.backdropPadding);return $(t.font&&t.font.size,ft.font.size)+e.height}return 0}function uR(n,t,e){return e=dt(e)?e:[e],{w:rA(n,t.string,e),h:e.length*t.lineHeight}}function Lf(n,t,e,i,s){return n===i||n===s?{start:t-e/2,end:t+e/2}:n<i||n>s?{start:t-e,end:t}:{start:t,end:t+e}}function dR(n){const t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],s=[],r=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?et/r:0;for(let c=0;c<r;c++){const h=o.setContext(n.getPointLabelContext(c));s[c]=h.padding;const u=n.getPointPosition(c,n.drawingArea+s[c],a),d=xt(h.font),g=uR(n.ctx,d,n._pointLabels[c]);i[c]=g;const m=Ut(n.getIndexAngle(c)+a),y=Math.round(Dl(m)),v=Lf(y,u.x,g.w,0,180),w=Lf(y,u.y,g.h,90,270);fR(e,t,m,v,w)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=mR(n,i,s)}function fR(n,t,e,i,s){const r=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e));let a=0,c=0;i.start<t.l?(a=(t.l-i.start)/r,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/r,n.r=Math.max(n.r,t.r+a)),s.start<t.t?(c=(t.t-s.start)/o,n.t=Math.min(n.t,t.t-c)):s.end>t.b&&(c=(s.end-t.b)/o,n.b=Math.max(n.b,t.b+c))}function gR(n,t,e){const i=n.drawingArea,{extra:s,additionalAngle:r,padding:o,size:a}=e,c=n.getPointPosition(t,i+s+o,r),h=Math.round(Dl(Ut(c.angle+vt))),u=bR(c.y,a.h,h),d=_R(h),g=yR(c.x,a.w,d);return{visible:!0,x:c.x,y:u,textAlign:d,left:g,top:u,right:g+a.w,bottom:u+a.h}}function pR(n,t){if(!t)return!0;const{left:e,top:i,right:s,bottom:r}=n;return!(Oe({x:e,y:i},t)||Oe({x:e,y:r},t)||Oe({x:s,y:i},t)||Oe({x:s,y:r},t))}function mR(n,t,e){const i=[],s=n._pointLabels.length,r=n.options,{centerPointLabels:o,display:a}=r.pointLabels,c={extra:Pc(r)/2,additionalAngle:o?et/s:0};let h;for(let u=0;u<s;u++){c.padding=e[u],c.size=t[u];const d=gR(n,u,c);i.push(d),a==="auto"&&(d.visible=pR(d,h),d.visible&&(h=d))}return i}function _R(n){return n===0||n===180?"center":n<180?"left":"right"}function yR(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function bR(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function vR(n,t,e){const{left:i,top:s,right:r,bottom:o}=e,{backdropColor:a}=t;if(!K(a)){const c=jn(t.borderRadius),h=Wt(t.backdropPadding);n.fillStyle=a;const u=i-h.left,d=s-h.top,g=r-i+h.width,m=o-s+h.height;Object.values(c).some(y=>y!==0)?(n.beginPath(),Fs(n,{x:u,y:d,w:g,h:m,radius:c}),n.fill()):n.fillRect(u,d,g,m)}}function wR(n,t){const{ctx:e,options:{pointLabels:i}}=n;for(let s=t-1;s>=0;s--){const r=n._pointLabelItems[s];if(!r.visible)continue;const o=i.setContext(n.getPointLabelContext(s));vR(e,o,r);const a=xt(o.font),{x:c,y:h,textAlign:u}=r;Xn(e,n._pointLabels[s],c,h+a.lineHeight/2,a,{color:o.color,textAlign:u,textBaseline:"middle"})}}function f_(n,t,e,i){const{ctx:s}=n;if(e)s.arc(n.xCenter,n.yCenter,t,0,ut);else{let r=n.getPointPosition(0,t);s.moveTo(r.x,r.y);for(let o=1;o<i;o++)r=n.getPointPosition(o,t),s.lineTo(r.x,r.y)}}function TR(n,t,e,i,s){const r=n.ctx,o=t.circular,{color:a,lineWidth:c}=t;!o&&!i||!a||!c||e<0||(r.save(),r.strokeStyle=a,r.lineWidth=c,r.setLineDash(s.dash||[]),r.lineDashOffset=s.dashOffset,r.beginPath(),f_(n,e,o,i),r.closePath(),r.stroke(),r.restore())}function ER(n,t,e){return In(n,{label:e,index:t,type:"pointLabel"})}class IR extends bo{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:jo.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=Wt(Pc(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){const{min:t,max:e}=this.getMinMax(!1);this.min=_t(t)&&!isNaN(t)?t:0,this.max=_t(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Pc(this.options))}generateTickLabels(t){bo.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{const s=at(this.options.pointLabels.callback,[e,i],this);return s||s===0?s:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?dR(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,s){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-s)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,s))}getIndexAngle(t){const e=ut/(this._pointLabels.length||1),i=this.options.startAngle||0;return Ut(t*e+oe(i))}getDistanceFromCenterForValue(t){if(K(t))return NaN;const e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(K(t))return NaN;const e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){const e=this._pointLabels||[];if(t>=0&&t<e.length){const i=e[t];return ER(this.getContext(),t,i)}}getPointPosition(t,e,i=0){const s=this.getIndexAngle(t)-vt+i;return{x:Math.cos(s)*e+this.xCenter,y:Math.sin(s)*e+this.yCenter,angle:s}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:e,top:i,right:s,bottom:r}=this._pointLabelItems[t];return{left:e,top:i,right:s,bottom:r}}drawBackground(){const{backgroundColor:t,grid:{circular:e}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),f_(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,e=this.options,{angleLines:i,grid:s,border:r}=e,o=this._pointLabels.length;let a,c,h;if(e.pointLabels.display&&wR(this,o),s.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(u.value);const g=this.getContext(d),m=s.setContext(g),y=r.setContext(g);TR(this,m,c,o,y)}}),i.display){for(t.save(),a=o-1;a>=0;a--){const u=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:g}=u;!g||!d||(t.lineWidth=g,t.strokeStyle=d,t.setLineDash(u.borderDash),t.lineDashOffset=u.borderDashOffset,c=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),h=this.getPointPosition(a,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(h.x,h.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;const s=this.getIndexAngle(0);let r,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(s),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!e.reverse)return;const h=i.setContext(this.getContext(c)),u=xt(h.font);if(r=this.getDistanceFromCenterForValue(this.ticks[c].value),h.showLabelBackdrop){t.font=u.string,o=t.measureText(a.label).width,t.fillStyle=h.backdropColor;const d=Wt(h.backdropPadding);t.fillRect(-o/2-d.left,-r-u.size/2-d.top,o+d.width,u.size+d.height)}Xn(t,a.label,0,-r,u,{color:h.color,strokeColor:h.textStrokeColor,strokeWidth:h.textStrokeWidth})}),t.restore()}drawTitle(){}}const Yo={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Xt=Object.keys(Yo);function Ff(n,t){return n-t}function Bf(n,t){if(K(t))return null;const e=n._adapter,{parser:i,round:s,isoWeekday:r}=n._parseOpts;let o=t;return typeof i=="function"&&(o=i(o)),_t(o)||(o=typeof i=="string"?e.parse(o,i):e.parse(o)),o===null?null:(s&&(o=s==="week"&&(Ri(r)||r===!0)?e.startOf(o,"isoWeek",r):e.startOf(o,s)),+o)}function Uf(n,t,e,i){const s=Xt.length;for(let r=Xt.indexOf(n);r<s-1;++r){const o=Yo[Xt[r]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=i)return Xt[r]}return Xt[s-1]}function AR(n,t,e,i,s){for(let r=Xt.length-1;r>=Xt.indexOf(e);r--){const o=Xt[r];if(Yo[o].common&&n._adapter.diff(s,i,o)>=t-1)return o}return Xt[e?Xt.indexOf(e):0]}function xR(n){for(let t=Xt.indexOf(n)+1,e=Xt.length;t<e;++t)if(Yo[Xt[t]].common)return Xt[t]}function zf(n,t,e){if(!e)n[t]=!0;else if(e.length){const{lo:i,hi:s}=Ml(e,t),r=e[i]>=t?e[i]:e[s];n[r]=!0}}function SR(n,t,e,i){const s=n._adapter,r=+s.startOf(t[0].value,i),o=t[t.length-1].value;let a,c;for(a=r;a<=o;a=+s.add(a,1,i))c=e[a],c>=0&&(t[c].major=!0);return t}function jf(n,t,e){const i=[],s={},r=t.length;let o,a;for(o=0;o<r;++o)a=t[o],s[a]=o,i.push({value:a,major:!1});return r===0||!e?i:SR(n,i,s,e)}class Rc extends ei{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,e={}){const i=t.time||(t.time={}),s=this._adapter=new Px._date(t.adapters.date);s.init(e),Es(i.displayFormats,s.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=e.normalized}parse(t,e){return t===void 0?null:Bf(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,e=this._adapter,i=t.time.unit||"day";let{min:s,max:r,minDefined:o,maxDefined:a}=this.getUserBounds();function c(h){!o&&!isNaN(h.min)&&(s=Math.min(s,h.min)),!a&&!isNaN(h.max)&&(r=Math.max(r,h.max))}(!o||!a)&&(c(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=_t(s)&&!isNaN(s)?s:+e.startOf(Date.now(),i),r=_t(r)&&!isNaN(r)?r:+e.endOf(Date.now(),i)+1,this.min=Math.min(s,r-1),this.max=Math.max(s+1,r)}_getLabelBounds(){const t=this.getLabelTimestamps();let e=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(e=t[0],i=t[t.length-1]),{min:e,max:i}}buildTicks(){const t=this.options,e=t.time,i=t.ticks,s=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const r=this.min,o=this.max,a=qI(s,r,o);return this._unit=e.unit||(i.autoSkip?Uf(e.minUnit,this.min,this.max,this._getLabelCapacity(r)):AR(this,a.length,e.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:xR(this._unit),this.initOffsets(s),t.reverse&&a.reverse(),jf(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t=[]){let e=0,i=0,s,r;this.options.offset&&t.length&&(s=this.getDecimalForValue(t[0]),t.length===1?e=1-s:e=(this.getDecimalForValue(t[1])-s)/2,r=this.getDecimalForValue(t[t.length-1]),t.length===1?i=r:i=(r-this.getDecimalForValue(t[t.length-2]))/2);const o=t.length<3?.5:.25;e=Ct(e,0,o),i=Ct(i,0,o),this._offsets={start:e,end:i,factor:1/(e+1+i)}}_generate(){const t=this._adapter,e=this.min,i=this.max,s=this.options,r=s.time,o=r.unit||Uf(r.minUnit,e,i,this._getLabelCapacity(e)),a=$(s.ticks.stepSize,1),c=o==="week"?r.isoWeekday:!1,h=Ri(c)||c===!0,u={};let d=e,g,m;if(h&&(d=+t.startOf(d,"isoWeek",c)),d=+t.startOf(d,h?"day":o),t.diff(i,e,o)>1e5*a)throw new Error(e+" and "+i+" are too far apart with stepSize of "+a+" "+o);const y=s.ticks.source==="data"&&this.getDataTimestamps();for(g=d,m=0;g<i;g=+t.add(g,a,o),m++)zf(u,g,y);return(g===i||s.bounds==="ticks"||m===1)&&zf(u,g,y),Object.keys(u).sort(Ff).map(v=>+v)}getLabelForValue(t){const e=this._adapter,i=this.options.time;return i.tooltipFormat?e.format(t,i.tooltipFormat):e.format(t,i.displayFormats.datetime)}format(t,e){const s=this.options.time.displayFormats,r=this._unit,o=e||s[r];return this._adapter.format(t,o)}_tickFormatFunction(t,e,i,s){const r=this.options,o=r.ticks.callback;if(o)return at(o,[t,e,i],this);const a=r.time.displayFormats,c=this._unit,h=this._majorUnit,u=c&&a[c],d=h&&a[h],g=i[e],m=h&&d&&g&&g.major;return this._adapter.format(t,s||(m?d:u))}generateTickLabels(t){let e,i,s;for(e=0,i=t.length;e<i;++e)s=t[e],s.label=this._tickFormatFunction(s.value,e,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const e=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((e.start+i)*e.factor)}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const e=this.options.ticks,i=this.ctx.measureText(t).width,s=oe(this.isHorizontal()?e.maxRotation:e.minRotation),r=Math.cos(s),o=Math.sin(s),a=this._resolveTickFontOptions(0).size;return{w:i*r+a*o,h:i*o+a*r}}_getLabelCapacity(t){const e=this.options.time,i=e.displayFormats,s=i[e.unit]||i.millisecond,r=this._tickFormatFunction(t,0,jf(this,[t],this._majorUnit),s),o=this._getLabelSize(r),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let t=this._cache.data||[],e,i;if(t.length)return t;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(e=0,i=s.length;e<i;++e)t=t.concat(s[e].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let e,i;if(t.length)return t;const s=this.getLabels();for(e=0,i=s.length;e<i;++e)t.push(Bf(this,s[e]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Im(t.sort(Ff))}}function Dr(n,t,e){let i=0,s=n.length-1,r,o,a,c;e?(t>=n[i].pos&&t<=n[s].pos&&({lo:i,hi:s}=Me(n,"pos",t)),{pos:r,time:a}=n[i],{pos:o,time:c}=n[s]):(t>=n[i].time&&t<=n[s].time&&({lo:i,hi:s}=Me(n,"time",t)),{time:r,pos:a}=n[i],{time:o,pos:c}=n[s]);const h=o-r;return h?a+(c-a)*(t-r)/h:a}class PR extends Rc{static id="timeseries";static defaults=Rc.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=Dr(e,this.min),this._tableRange=Dr(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:e,max:i}=this,s=[],r=[];let o,a,c,h,u;for(o=0,a=t.length;o<a;++o)h=t[o],h>=e&&h<=i&&s.push(h);if(s.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=s.length;o<a;++o)u=s[o+1],c=s[o-1],h=s[o],Math.round((u+c)/2)!==h&&r.push({time:h,pos:o/(a-1)});return r}_generate(){const t=this.min,e=this.max;let i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((s,r)=>s-r)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Dr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return Dr(this._table,i*this._tableRange+this._minPos,!0)}}var RR=Object.freeze({__proto__:null,CategoryScale:rR,LinearScale:aR,LogarithmicScale:hR,RadialLinearScale:IR,TimeScale:Rc,TimeSeriesScale:PR});const CR=[Sx,oP,eR,RR];Wl.register(...CR);const Hf=document.getElementById("login-screen"),Wf=document.getElementById("app"),as=document.getElementById("login-btn"),kR=document.getElementById("logout-btn"),DR=document.getElementById("user-name"),MR=document.getElementById("user-email"),ql=document.getElementById("entry-date"),$f=document.getElementById("weight-input"),cs=document.getElementById("save-weight-btn"),qf=document.getElementById("food-input"),OR=document.getElementById("meal-type"),ls=document.getElementById("save-food-btn"),Gf=document.getElementById("current-weight-display"),Wa=document.getElementById("history-list"),VR=document.getElementById("weight-chart").getContext("2d");let $a;iI(async n=>{n?(DR.textContent=n.displayName||"",MR.textContent=n.email,Hf.style.display="none",Wf.style.display="block",await NR()):(Hf.style.display="block",Wf.style.display="none")});as.addEventListener("click",async()=>{try{as.disabled=!0,as.textContent="...",await eI()}catch{alert(""),as.disabled=!1,as.textContent=" Google "}});kR.addEventListener("click",async()=>{confirm("")&&await nI()});const NR=async()=>{ql.value=aI(),await tr()},tr=async()=>{const n=await Sl(),t=[...n].reverse().find(e=>e.weight);t?Gf.textContent=`${t.weight} kg`:Gf.textContent="-- kg",LR(n),Cc(n)},LR=n=>{const t=n.map(i=>i.date),e=n.map(i=>i.weight);$a&&$a.destroy(),$a=new Wl(VR,{type:"line",data:{labels:t,datasets:[{label:" (kg)",data:e,borderColor:"#6366f1",backgroundColor:"rgba(99, 102, 241, 0.1)",tension:.3,fill:!0}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!1}}}})};let Qe=1;const qa=5,Cc=n=>{Wa.innerHTML="";const t=[...n].sort((o,a)=>new Date(a.date)-new Date(o.date)),e=Math.ceil(t.length/qa),i=(Qe-1)*qa,s=i+qa;if(t.slice(i,s).forEach(o=>{const a=document.createElement("div");a.className="history-card";let c="";o.food&&o.food.length>0?(c='<ul class="food-list">',o.food.forEach((h,u)=>{c+=`
                <li>
                    <span>${h}</span>
                    <button class="delete-btn" data-date="${o.date}" data-item="${h}"></button>
                </li>`}),c+="</ul>"):c='<p class="no-food"></p>',a.innerHTML=`
      <div class="history-header">
        <h3>${o.date}</h3>
        <span class="history-weight">${o.weight?o.weight+" kg":"-"}</span>
      </div>
      <div class="history-body">
        ${c}
      </div>
    `,Wa.appendChild(a)}),e>1){const o=document.createElement("div");o.className="pagination-controls",o.style.display="flex",o.style.justifyContent="center",o.style.gap="10px",o.style.marginTop="20px";const a=document.createElement("button");a.textContent="",a.disabled=Qe===1,a.onclick=()=>{Qe>1&&(Qe--,Cc(n))};const c=document.createElement("button");c.textContent="",c.disabled=Qe===e,c.onclick=()=>{Qe<e&&(Qe++,Cc(n))};const h=document.createElement("span");h.textContent=` ${Qe}  /  ${e} `,h.style.alignSelf="center",o.appendChild(a),o.appendChild(h),o.appendChild(c),Wa.appendChild(o)}document.querySelectorAll(".delete-btn").forEach(o=>{o.addEventListener("click",async a=>{const c=a.target.dataset.date,h=a.target.dataset.item;confirm("")&&(await cI(c,h),await tr())})})};cs.addEventListener("click",async()=>{const n=ql.value,t=$f.value;n&&t?(cs.disabled=!0,cs.textContent="...",await ho(n,"weight",t),$f.value="",cs.disabled=!1,cs.textContent="",await tr()):alert("")});ls.addEventListener("click",async()=>{const n=ql.value,t=qf.value,e=OR.value;if(n&&t){ls.disabled=!0,ls.textContent="...";const i=`${e}: ${t}`;await ho(n,"food",i),qf.value="",ls.disabled=!1,ls.textContent="",await tr()}else alert("")});const ai=document.getElementById("batch-import-btn");ai&&ai.addEventListener("click",async()=>{if(!confirm(` 11/9  11/18 

`))return;const n=[{date:"2025-11-09",weight:56.2,food:["","","","","","",""]},{date:"2025-11-10",weight:55.8,food:[""," ","  "]},{date:"2025-11-11",weight:55.65,food:[]},{date:"2025-11-12",weight:54.8,food:[]},{date:"2025-11-13",weight:55.65,food:["",""]},{date:"2025-11-14",weight:56.4,food:["","   "]},{date:"2025-11-15",weight:55,food:["  "]},{date:"2025-11-16",weight:54.4,food:[]},{date:"2025-11-17",weight:54.95,food:["      "]},{date:"2025-11-18",weight:54.05,food:[]}];ai.disabled=!0,ai.textContent="...";try{for(const t of n)if(t.weight&&await ho(t.date,"weight",t.weight),t.food&&t.food.length>0)for(const e of t.food)await ho(t.date,"food",`: ${e}`);alert("  10 "),await tr()}catch(t){alert(" "+t.message)}finally{ai.disabled=!1,ai.textContent=" (11/9-11/18)"}});
